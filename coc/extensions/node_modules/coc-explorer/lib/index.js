var hb=Object.create;var fi=Object.defineProperty,gb=Object.defineProperties,wb=Object.getOwnPropertyDescriptor,xb=Object.getOwnPropertyDescriptors,bb=Object.getOwnPropertyNames,_u=Object.getOwnPropertySymbols,yb=Object.getPrototypeOf,ku=Object.prototype.hasOwnProperty,vb=Object.prototype.propertyIsEnumerable;var Mu=(t,e,r)=>e in t?fi(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,N=(t,e)=>{for(var r in e||(e={}))ku.call(e,r)&&Mu(t,r,e[r]);if(_u)for(var r of _u(e))vb.call(e,r)&&Mu(t,r,e[r]);return t},G=(t,e)=>gb(t,xb(e));var L=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),Eb=(t,e)=>{for(var r in e)fi(t,r,{get:e[r],enumerable:!0})},Ru=(t,e,r,o)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of bb(e))!ku.call(t,i)&&i!==r&&fi(t,i,{get:()=>e[i],enumerable:!(o=wb(e,i))||o.enumerable});return t};var _=(t,e,r)=>(r=t!=null?hb(yb(t)):{},Ru(e||!t||!t.__esModule?fi(r,"default",{value:t,enumerable:!0}):r,t)),Sb=t=>Ru(fi({},"__esModule",{value:!0}),t);var Lu=(t,e,r)=>{if(!e.has(t))throw TypeError("Cannot "+r)};var Du=(t,e,r)=>(Lu(t,e,"read from private field"),r?r.call(t):e.get(t)),Bu=(t,e,r)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,r)},Wu=(t,e,r,o)=>(Lu(t,e,"write to private field"),o?o.call(t,r):e.set(t,r),r);var qp=L((A,Up)=>{A=Up.exports=M;var H;typeof process=="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?H=function(){var t=Array.prototype.slice.call(arguments,0);t.unshift("SEMVER"),console.log.apply(console,t)}:H=function(){};A.SEMVER_SPEC_VERSION="2.0.0";var tl=256,Xn=Number.MAX_SAFE_INTEGER||9007199254740991,el=16,F=A.re=[],y=A.src=[],w=A.tokens={},$p=0;function k(t){w[t]=$p++}k("NUMERICIDENTIFIER");y[w.NUMERICIDENTIFIER]="0|[1-9]\\d*";k("NUMERICIDENTIFIERLOOSE");y[w.NUMERICIDENTIFIERLOOSE]="[0-9]+";k("NONNUMERICIDENTIFIER");y[w.NONNUMERICIDENTIFIER]="\\d*[a-zA-Z-][a-zA-Z0-9-]*";k("MAINVERSION");y[w.MAINVERSION]="("+y[w.NUMERICIDENTIFIER]+")\\.("+y[w.NUMERICIDENTIFIER]+")\\.("+y[w.NUMERICIDENTIFIER]+")";k("MAINVERSIONLOOSE");y[w.MAINVERSIONLOOSE]="("+y[w.NUMERICIDENTIFIERLOOSE]+")\\.("+y[w.NUMERICIDENTIFIERLOOSE]+")\\.("+y[w.NUMERICIDENTIFIERLOOSE]+")";k("PRERELEASEIDENTIFIER");y[w.PRERELEASEIDENTIFIER]="(?:"+y[w.NUMERICIDENTIFIER]+"|"+y[w.NONNUMERICIDENTIFIER]+")";k("PRERELEASEIDENTIFIERLOOSE");y[w.PRERELEASEIDENTIFIERLOOSE]="(?:"+y[w.NUMERICIDENTIFIERLOOSE]+"|"+y[w.NONNUMERICIDENTIFIER]+")";k("PRERELEASE");y[w.PRERELEASE]="(?:-("+y[w.PRERELEASEIDENTIFIER]+"(?:\\."+y[w.PRERELEASEIDENTIFIER]+")*))";k("PRERELEASELOOSE");y[w.PRERELEASELOOSE]="(?:-?("+y[w.PRERELEASEIDENTIFIERLOOSE]+"(?:\\."+y[w.PRERELEASEIDENTIFIERLOOSE]+")*))";k("BUILDIDENTIFIER");y[w.BUILDIDENTIFIER]="[0-9A-Za-z-]+";k("BUILD");y[w.BUILD]="(?:\\+("+y[w.BUILDIDENTIFIER]+"(?:\\."+y[w.BUILDIDENTIFIER]+")*))";k("FULL");k("FULLPLAIN");y[w.FULLPLAIN]="v?"+y[w.MAINVERSION]+y[w.PRERELEASE]+"?"+y[w.BUILD]+"?";y[w.FULL]="^"+y[w.FULLPLAIN]+"$";k("LOOSEPLAIN");y[w.LOOSEPLAIN]="[v=\\s]*"+y[w.MAINVERSIONLOOSE]+y[w.PRERELEASELOOSE]+"?"+y[w.BUILD]+"?";k("LOOSE");y[w.LOOSE]="^"+y[w.LOOSEPLAIN]+"$";k("GTLT");y[w.GTLT]="((?:<|>)?=?)";k("XRANGEIDENTIFIERLOOSE");y[w.XRANGEIDENTIFIERLOOSE]=y[w.NUMERICIDENTIFIERLOOSE]+"|x|X|\\*";k("XRANGEIDENTIFIER");y[w.XRANGEIDENTIFIER]=y[w.NUMERICIDENTIFIER]+"|x|X|\\*";k("XRANGEPLAIN");y[w.XRANGEPLAIN]="[v=\\s]*("+y[w.XRANGEIDENTIFIER]+")(?:\\.("+y[w.XRANGEIDENTIFIER]+")(?:\\.("+y[w.XRANGEIDENTIFIER]+")(?:"+y[w.PRERELEASE]+")?"+y[w.BUILD]+"?)?)?";k("XRANGEPLAINLOOSE");y[w.XRANGEPLAINLOOSE]="[v=\\s]*("+y[w.XRANGEIDENTIFIERLOOSE]+")(?:\\.("+y[w.XRANGEIDENTIFIERLOOSE]+")(?:\\.("+y[w.XRANGEIDENTIFIERLOOSE]+")(?:"+y[w.PRERELEASELOOSE]+")?"+y[w.BUILD]+"?)?)?";k("XRANGE");y[w.XRANGE]="^"+y[w.GTLT]+"\\s*"+y[w.XRANGEPLAIN]+"$";k("XRANGELOOSE");y[w.XRANGELOOSE]="^"+y[w.GTLT]+"\\s*"+y[w.XRANGEPLAINLOOSE]+"$";k("COERCE");y[w.COERCE]="(^|[^\\d])(\\d{1,"+el+"})(?:\\.(\\d{1,"+el+"}))?(?:\\.(\\d{1,"+el+"}))?(?:$|[^\\d])";k("COERCERTL");F[w.COERCERTL]=new RegExp(y[w.COERCE],"g");k("LONETILDE");y[w.LONETILDE]="(?:~>?)";k("TILDETRIM");y[w.TILDETRIM]="(\\s*)"+y[w.LONETILDE]+"\\s+";F[w.TILDETRIM]=new RegExp(y[w.TILDETRIM],"g");var IN="$1~";k("TILDE");y[w.TILDE]="^"+y[w.LONETILDE]+y[w.XRANGEPLAIN]+"$";k("TILDELOOSE");y[w.TILDELOOSE]="^"+y[w.LONETILDE]+y[w.XRANGEPLAINLOOSE]+"$";k("LONECARET");y[w.LONECARET]="(?:\\^)";k("CARETTRIM");y[w.CARETTRIM]="(\\s*)"+y[w.LONECARET]+"\\s+";F[w.CARETTRIM]=new RegExp(y[w.CARETTRIM],"g");var ON="$1^";k("CARET");y[w.CARET]="^"+y[w.LONECARET]+y[w.XRANGEPLAIN]+"$";k("CARETLOOSE");y[w.CARETLOOSE]="^"+y[w.LONECARET]+y[w.XRANGEPLAINLOOSE]+"$";k("COMPARATORLOOSE");y[w.COMPARATORLOOSE]="^"+y[w.GTLT]+"\\s*("+y[w.LOOSEPLAIN]+")$|^$";k("COMPARATOR");y[w.COMPARATOR]="^"+y[w.GTLT]+"\\s*("+y[w.FULLPLAIN]+")$|^$";k("COMPARATORTRIM");y[w.COMPARATORTRIM]="(\\s*)"+y[w.GTLT]+"\\s*("+y[w.LOOSEPLAIN]+"|"+y[w.XRANGEPLAIN]+")";F[w.COMPARATORTRIM]=new RegExp(y[w.COMPARATORTRIM],"g");var PN="$1$2$3";k("HYPHENRANGE");y[w.HYPHENRANGE]="^\\s*("+y[w.XRANGEPLAIN]+")\\s+-\\s+("+y[w.XRANGEPLAIN]+")\\s*$";k("HYPHENRANGELOOSE");y[w.HYPHENRANGELOOSE]="^\\s*("+y[w.XRANGEPLAINLOOSE]+")\\s+-\\s+("+y[w.XRANGEPLAINLOOSE]+")\\s*$";k("STAR");y[w.STAR]="(<|>)?=?\\s*\\*";for(Ut=0;Ut<$p;Ut++)H(Ut,y[Ut]),F[Ut]||(F[Ut]=new RegExp(y[Ut]));var Ut;A.parse=Ar;function Ar(t,e){if((!e||typeof e!="object")&&(e={loose:!!e,includePrerelease:!1}),t instanceof M)return t;if(typeof t!="string"||t.length>tl)return null;var r=e.loose?F[w.LOOSE]:F[w.FULL];if(!r.test(t))return null;try{return new M(t,e)}catch{return null}}A.valid=AN;function AN(t,e){var r=Ar(t,e);return r?r.version:null}A.clean=_N;function _N(t,e){var r=Ar(t.trim().replace(/^[=v]+/,""),e);return r?r.version:null}A.SemVer=M;function M(t,e){if((!e||typeof e!="object")&&(e={loose:!!e,includePrerelease:!1}),t instanceof M){if(t.loose===e.loose)return t;t=t.version}else if(typeof t!="string")throw new TypeError("Invalid Version: "+t);if(t.length>tl)throw new TypeError("version is longer than "+tl+" characters");if(!(this instanceof M))return new M(t,e);H("SemVer",t,e),this.options=e,this.loose=!!e.loose;var r=t.trim().match(e.loose?F[w.LOOSE]:F[w.FULL]);if(!r)throw new TypeError("Invalid Version: "+t);if(this.raw=t,this.major=+r[1],this.minor=+r[2],this.patch=+r[3],this.major>Xn||this.major<0)throw new TypeError("Invalid major version");if(this.minor>Xn||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>Xn||this.patch<0)throw new TypeError("Invalid patch version");r[4]?this.prerelease=r[4].split(".").map(function(o){if(/^[0-9]+$/.test(o)){var i=+o;if(i>=0&&i<Xn)return i}return o}):this.prerelease=[],this.build=r[5]?r[5].split("."):[],this.format()}M.prototype.format=function(){return this.version=this.major+"."+this.minor+"."+this.patch,this.prerelease.length&&(this.version+="-"+this.prerelease.join(".")),this.version};M.prototype.toString=function(){return this.version};M.prototype.compare=function(t){return H("SemVer.compare",this.version,this.options,t),t instanceof M||(t=new M(t,this.options)),this.compareMain(t)||this.comparePre(t)};M.prototype.compareMain=function(t){return t instanceof M||(t=new M(t,this.options)),Pr(this.major,t.major)||Pr(this.minor,t.minor)||Pr(this.patch,t.patch)};M.prototype.comparePre=function(t){if(t instanceof M||(t=new M(t,this.options)),this.prerelease.length&&!t.prerelease.length)return-1;if(!this.prerelease.length&&t.prerelease.length)return 1;if(!this.prerelease.length&&!t.prerelease.length)return 0;var e=0;do{var r=this.prerelease[e],o=t.prerelease[e];if(H("prerelease compare",e,r,o),r===void 0&&o===void 0)return 0;if(o===void 0)return 1;if(r===void 0)return-1;if(r===o)continue;return Pr(r,o)}while(++e)};M.prototype.compareBuild=function(t){t instanceof M||(t=new M(t,this.options));var e=0;do{var r=this.build[e],o=t.build[e];if(H("prerelease compare",e,r,o),r===void 0&&o===void 0)return 0;if(o===void 0)return 1;if(r===void 0)return-1;if(r===o)continue;return Pr(r,o)}while(++e)};M.prototype.inc=function(t,e){switch(t){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",e);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",e);break;case"prepatch":this.prerelease.length=0,this.inc("patch",e),this.inc("pre",e);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",e),this.inc("pre",e);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":if(this.prerelease.length===0)this.prerelease=[0];else{for(var r=this.prerelease.length;--r>=0;)typeof this.prerelease[r]=="number"&&(this.prerelease[r]++,r=-2);r===-1&&this.prerelease.push(0)}e&&(this.prerelease[0]===e?isNaN(this.prerelease[1])&&(this.prerelease=[e,0]):this.prerelease=[e,0]);break;default:throw new Error("invalid increment argument: "+t)}return this.format(),this.raw=this.version,this};A.inc=MN;function MN(t,e,r,o){typeof r=="string"&&(o=r,r=void 0);try{return new M(t,r).inc(e,o).version}catch{return null}}A.diff=kN;function kN(t,e){if(rl(t,e))return null;var r=Ar(t),o=Ar(e),i="";if(r.prerelease.length||o.prerelease.length){i="pre";var n="prerelease"}for(var a in r)if((a==="major"||a==="minor"||a==="patch")&&r[a]!==o[a])return i+a;return n}A.compareIdentifiers=Pr;var jp=/^[0-9]+$/;function Pr(t,e){var r=jp.test(t),o=jp.test(e);return r&&o&&(t=+t,e=+e),t===e?0:r&&!o?-1:o&&!r?1:t<e?-1:1}A.rcompareIdentifiers=RN;function RN(t,e){return Pr(e,t)}A.major=LN;function LN(t,e){return new M(t,e).major}A.minor=DN;function DN(t,e){return new M(t,e).minor}A.patch=BN;function BN(t,e){return new M(t,e).patch}A.compare=yt;function yt(t,e,r){return new M(t,r).compare(new M(e,r))}A.compareLoose=WN;function WN(t,e){return yt(t,e,!0)}A.compareBuild=FN;function FN(t,e,r){var o=new M(t,r),i=new M(e,r);return o.compare(i)||o.compareBuild(i)}A.rcompare=jN;function jN(t,e,r){return yt(e,t,r)}A.sort=HN;function HN(t,e){return t.sort(function(r,o){return A.compareBuild(r,o,e)})}A.rsort=$N;function $N(t,e){return t.sort(function(r,o){return A.compareBuild(o,r,e)})}A.gt=Pi;function Pi(t,e,r){return yt(t,e,r)>0}A.lt=Qn;function Qn(t,e,r){return yt(t,e,r)<0}A.eq=rl;function rl(t,e,r){return yt(t,e,r)===0}A.neq=Gp;function Gp(t,e,r){return yt(t,e,r)!==0}A.gte=ol;function ol(t,e,r){return yt(t,e,r)>=0}A.lte=il;function il(t,e,r){return yt(t,e,r)<=0}A.cmp=Jn;function Jn(t,e,r,o){switch(e){case"===":return typeof t=="object"&&(t=t.version),typeof r=="object"&&(r=r.version),t===r;case"!==":return typeof t=="object"&&(t=t.version),typeof r=="object"&&(r=r.version),t!==r;case"":case"=":case"==":return rl(t,r,o);case"!=":return Gp(t,r,o);case">":return Pi(t,r,o);case">=":return ol(t,r,o);case"<":return Qn(t,r,o);case"<=":return il(t,r,o);default:throw new TypeError("Invalid operator: "+e)}}A.Comparator=je;function je(t,e){if((!e||typeof e!="object")&&(e={loose:!!e,includePrerelease:!1}),t instanceof je){if(t.loose===!!e.loose)return t;t=t.value}if(!(this instanceof je))return new je(t,e);H("comparator",t,e),this.options=e,this.loose=!!e.loose,this.parse(t),this.semver===_o?this.value="":this.value=this.operator+this.semver.version,H("comp",this)}var _o={};je.prototype.parse=function(t){var e=this.options.loose?F[w.COMPARATORLOOSE]:F[w.COMPARATOR],r=t.match(e);if(!r)throw new TypeError("Invalid comparator: "+t);this.operator=r[1]!==void 0?r[1]:"",this.operator==="="&&(this.operator=""),r[2]?this.semver=new M(r[2],this.options.loose):this.semver=_o};je.prototype.toString=function(){return this.value};je.prototype.test=function(t){if(H("Comparator.test",t,this.options.loose),this.semver===_o||t===_o)return!0;if(typeof t=="string")try{t=new M(t,this.options)}catch{return!1}return Jn(t,this.operator,this.semver,this.options)};je.prototype.intersects=function(t,e){if(!(t instanceof je))throw new TypeError("a Comparator is required");(!e||typeof e!="object")&&(e={loose:!!e,includePrerelease:!1});var r;if(this.operator==="")return this.value===""?!0:(r=new re(t.value,e),Zn(this.value,r,e));if(t.operator==="")return t.value===""?!0:(r=new re(this.value,e),Zn(t.semver,r,e));var o=(this.operator===">="||this.operator===">")&&(t.operator===">="||t.operator===">"),i=(this.operator==="<="||this.operator==="<")&&(t.operator==="<="||t.operator==="<"),n=this.semver.version===t.semver.version,a=(this.operator===">="||this.operator==="<=")&&(t.operator===">="||t.operator==="<="),s=Jn(this.semver,"<",t.semver,e)&&(this.operator===">="||this.operator===">")&&(t.operator==="<="||t.operator==="<"),l=Jn(this.semver,">",t.semver,e)&&(this.operator==="<="||this.operator==="<")&&(t.operator===">="||t.operator===">");return o||i||n&&a||s||l};A.Range=re;function re(t,e){if((!e||typeof e!="object")&&(e={loose:!!e,includePrerelease:!1}),t instanceof re)return t.loose===!!e.loose&&t.includePrerelease===!!e.includePrerelease?t:new re(t.raw,e);if(t instanceof je)return new re(t.value,e);if(!(this instanceof re))return new re(t,e);if(this.options=e,this.loose=!!e.loose,this.includePrerelease=!!e.includePrerelease,this.raw=t,this.set=t.split(/\s*\|\|\s*/).map(function(r){return this.parseRange(r.trim())},this).filter(function(r){return r.length}),!this.set.length)throw new TypeError("Invalid SemVer Range: "+t);this.format()}re.prototype.format=function(){return this.range=this.set.map(function(t){return t.join(" ").trim()}).join("||").trim(),this.range};re.prototype.toString=function(){return this.range};re.prototype.parseRange=function(t){var e=this.options.loose;t=t.trim();var r=e?F[w.HYPHENRANGELOOSE]:F[w.HYPHENRANGE];t=t.replace(r,JN),H("hyphen replace",t),t=t.replace(F[w.COMPARATORTRIM],PN),H("comparator trim",t,F[w.COMPARATORTRIM]),t=t.replace(F[w.TILDETRIM],IN),t=t.replace(F[w.CARETTRIM],ON),t=t.split(/\s+/).join(" ");var o=e?F[w.COMPARATORLOOSE]:F[w.COMPARATOR],i=t.split(" ").map(function(n){return UN(n,this.options)},this).join(" ").split(/\s+/);return this.options.loose&&(i=i.filter(function(n){return!!n.match(o)})),i=i.map(function(n){return new je(n,this.options)},this),i};re.prototype.intersects=function(t,e){if(!(t instanceof re))throw new TypeError("a Range is required");return this.set.some(function(r){return Hp(r,e)&&t.set.some(function(o){return Hp(o,e)&&r.every(function(i){return o.every(function(n){return i.intersects(n,e)})})})})};function Hp(t,e){for(var r=!0,o=t.slice(),i=o.pop();r&&o.length;)r=o.every(function(n){return i.intersects(n,e)}),i=o.pop();return r}A.toComparators=GN;function GN(t,e){return new re(t,e).set.map(function(r){return r.map(function(o){return o.value}).join(" ").trim().split(" ")})}function UN(t,e){return H("comp",t,e),t=zN(t,e),H("caret",t),t=qN(t,e),H("tildes",t),t=KN(t,e),H("xrange",t),t=QN(t,e),H("stars",t),t}function Ie(t){return!t||t.toLowerCase()==="x"||t==="*"}function qN(t,e){return t.trim().split(/\s+/).map(function(r){return VN(r,e)}).join(" ")}function VN(t,e){var r=e.loose?F[w.TILDELOOSE]:F[w.TILDE];return t.replace(r,function(o,i,n,a,s){H("tilde",t,o,i,n,a,s);var l;return Ie(i)?l="":Ie(n)?l=">="+i+".0.0 <"+(+i+1)+".0.0":Ie(a)?l=">="+i+"."+n+".0 <"+i+"."+(+n+1)+".0":s?(H("replaceTilde pr",s),l=">="+i+"."+n+"."+a+"-"+s+" <"+i+"."+(+n+1)+".0"):l=">="+i+"."+n+"."+a+" <"+i+"."+(+n+1)+".0",H("tilde return",l),l})}function zN(t,e){return t.trim().split(/\s+/).map(function(r){return YN(r,e)}).join(" ")}function YN(t,e){H("caret",t,e);var r=e.loose?F[w.CARETLOOSE]:F[w.CARET];return t.replace(r,function(o,i,n,a,s){H("caret",t,o,i,n,a,s);var l;return Ie(i)?l="":Ie(n)?l=">="+i+".0.0 <"+(+i+1)+".0.0":Ie(a)?i==="0"?l=">="+i+"."+n+".0 <"+i+"."+(+n+1)+".0":l=">="+i+"."+n+".0 <"+(+i+1)+".0.0":s?(H("replaceCaret pr",s),i==="0"?n==="0"?l=">="+i+"."+n+"."+a+"-"+s+" <"+i+"."+n+"."+(+a+1):l=">="+i+"."+n+"."+a+"-"+s+" <"+i+"."+(+n+1)+".0":l=">="+i+"."+n+"."+a+"-"+s+" <"+(+i+1)+".0.0"):(H("no pr"),i==="0"?n==="0"?l=">="+i+"."+n+"."+a+" <"+i+"."+n+"."+(+a+1):l=">="+i+"."+n+"."+a+" <"+i+"."+(+n+1)+".0":l=">="+i+"."+n+"."+a+" <"+(+i+1)+".0.0"),H("caret return",l),l})}function KN(t,e){return H("replaceXRanges",t,e),t.split(/\s+/).map(function(r){return XN(r,e)}).join(" ")}function XN(t,e){t=t.trim();var r=e.loose?F[w.XRANGELOOSE]:F[w.XRANGE];return t.replace(r,function(o,i,n,a,s,l){H("xRange",t,o,i,n,a,s,l);var c=Ie(n),u=c||Ie(a),f=u||Ie(s),d=f;return i==="="&&d&&(i=""),l=e.includePrerelease?"-0":"",c?i===">"||i==="<"?o="<0.0.0-0":o="*":i&&d?(u&&(a=0),s=0,i===">"?(i=">=",u?(n=+n+1,a=0,s=0):(a=+a+1,s=0)):i==="<="&&(i="<",u?n=+n+1:a=+a+1),o=i+n+"."+a+"."+s+l):u?o=">="+n+".0.0"+l+" <"+(+n+1)+".0.0"+l:f&&(o=">="+n+"."+a+".0"+l+" <"+n+"."+(+a+1)+".0"+l),H("xRange return",o),o})}function QN(t,e){return H("replaceStars",t,e),t.trim().replace(F[w.STAR],"")}function JN(t,e,r,o,i,n,a,s,l,c,u,f,d){return Ie(r)?e="":Ie(o)?e=">="+r+".0.0":Ie(i)?e=">="+r+"."+o+".0":e=">="+e,Ie(l)?s="":Ie(c)?s="<"+(+l+1)+".0.0":Ie(u)?s="<"+l+"."+(+c+1)+".0":f?s="<="+l+"."+c+"."+u+"-"+f:s="<="+s,(e+" "+s).trim()}re.prototype.test=function(t){if(!t)return!1;if(typeof t=="string")try{t=new M(t,this.options)}catch{return!1}for(var e=0;e<this.set.length;e++)if(ZN(this.set[e],t,this.options))return!0;return!1};function ZN(t,e,r){for(var o=0;o<t.length;o++)if(!t[o].test(e))return!1;if(e.prerelease.length&&!r.includePrerelease){for(o=0;o<t.length;o++)if(H(t[o].semver),t[o].semver!==_o&&t[o].semver.prerelease.length>0){var i=t[o].semver;if(i.major===e.major&&i.minor===e.minor&&i.patch===e.patch)return!0}return!1}return!0}A.satisfies=Zn;function Zn(t,e,r){try{e=new re(e,r)}catch{return!1}return e.test(t)}A.maxSatisfying=eC;function eC(t,e,r){var o=null,i=null;try{var n=new re(e,r)}catch{return null}return t.forEach(function(a){n.test(a)&&(!o||i.compare(a)===-1)&&(o=a,i=new M(o,r))}),o}A.minSatisfying=tC;function tC(t,e,r){var o=null,i=null;try{var n=new re(e,r)}catch{return null}return t.forEach(function(a){n.test(a)&&(!o||i.compare(a)===1)&&(o=a,i=new M(o,r))}),o}A.minVersion=rC;function rC(t,e){t=new re(t,e);var r=new M("0.0.0");if(t.test(r)||(r=new M("0.0.0-0"),t.test(r)))return r;r=null;for(var o=0;o<t.set.length;++o){var i=t.set[o];i.forEach(function(n){var a=new M(n.semver.version);switch(n.operator){case">":a.prerelease.length===0?a.patch++:a.prerelease.push(0),a.raw=a.format();case"":case">=":(!r||Pi(r,a))&&(r=a);break;case"<":case"<=":break;default:throw new Error("Unexpected operation: "+n.operator)}})}return r&&t.test(r)?r:null}A.validRange=oC;function oC(t,e){try{return new re(t,e).range||"*"}catch{return null}}A.ltr=iC;function iC(t,e,r){return nl(t,e,"<",r)}A.gtr=nC;function nC(t,e,r){return nl(t,e,">",r)}A.outside=nl;function nl(t,e,r,o){t=new M(t,o),e=new re(e,o);var i,n,a,s,l;switch(r){case">":i=Pi,n=il,a=Qn,s=">",l=">=";break;case"<":i=Qn,n=ol,a=Pi,s="<",l="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(Zn(t,e,o))return!1;for(var c=0;c<e.set.length;++c){var u=e.set[c],f=null,d=null;if(u.forEach(function(p){p.semver===_o&&(p=new je(">=0.0.0")),f=f||p,d=d||p,i(p.semver,f.semver,o)?f=p:a(p.semver,d.semver,o)&&(d=p)}),f.operator===s||f.operator===l||(!d.operator||d.operator===s)&&n(t,d.semver))return!1;if(d.operator===l&&a(t,d.semver))return!1}return!0}A.prerelease=aC;function aC(t,e){var r=Ar(t,e);return r&&r.prerelease.length?r.prerelease:null}A.intersects=sC;function sC(t,e,r){return t=new re(t,r),e=new re(e,r),t.intersects(e)}A.coerce=lC;function lC(t,e){if(t instanceof M)return t;if(typeof t=="number"&&(t=String(t)),typeof t!="string")return null;e=e||{};var r=null;if(!e.rtl)r=t.match(F[w.COERCE]);else{for(var o;(o=F[w.COERCERTL].exec(t))&&(!r||r.index+r[0].length!==t.length);)(!r||o.index+o[0].length!==r.index+r[0].length)&&(r=o),F[w.COERCERTL].lastIndex=o.index+o[1].length+o[2].length;F[w.COERCERTL].lastIndex=-1}return r===null?null:Ar(r[2]+"."+(r[3]||"0")+"."+(r[4]||"0"),e)}});var Qp=L((cF,al)=>{"use strict";var ea=require("fs"),vt=require("path"),{promisify:Vp}=require("util"),cC=qp(),zp=cC.satisfies(process.version,">=10.12.0"),Yp=t=>{if(process.platform==="win32"&&/[<>:"|?*]/.test(t.replace(vt.parse(t).root,""))){let r=new Error(`Path contains invalid characters: ${t}`);throw r.code="EINVAL",r}},Kp=t=>N(N({},{mode:511,fs:ea}),t),Xp=t=>{let e=new Error(`operation not permitted, mkdir '${t}'`);return e.code="EPERM",e.errno=-4048,e.path=t,e.syscall="mkdir",e},uC=async(t,e)=>{Yp(t),e=Kp(e);let r=Vp(e.fs.mkdir),o=Vp(e.fs.stat);if(zp&&e.fs.mkdir===ea.mkdir){let n=vt.resolve(t);return await r(n,{mode:e.mode,recursive:!0}),n}let i=async n=>{try{return await r(n,e.mode),n}catch(a){if(a.code==="EPERM")throw a;if(a.code==="ENOENT"){if(vt.dirname(n)===n)throw Xp(n);if(a.message.includes("null bytes"))throw a;return await i(vt.dirname(n)),i(n)}try{if(!(await o(n)).isDirectory())throw new Error("The path is not a directory")}catch{throw a}return n}};return i(vt.resolve(t))};al.exports=uC;al.exports.sync=(t,e)=>{if(Yp(t),e=Kp(e),zp&&e.fs.mkdirSync===ea.mkdirSync){let o=vt.resolve(t);return ea.mkdirSync(o,{mode:e.mode,recursive:!0}),o}let r=o=>{try{e.fs.mkdirSync(o,e.mode)}catch(i){if(i.code==="EPERM")throw i;if(i.code==="ENOENT"){if(vt.dirname(o)===o)throw Xp(o);if(i.message.includes("null bytes"))throw i;return r(vt.dirname(o)),r(o)}try{if(!e.fs.statSync(o).isDirectory())throw new Error("The path is not a directory")}catch{throw i}}return o};return r(vt.resolve(t))}});var Jp=L(sl=>{var _r=require("path"),Vt=process.platform==="win32",qt=require("fs"),fC=process.env.NODE_DEBUG&&/fs/.test(process.env.NODE_DEBUG);function dC(){var t;if(fC){var e=new Error;t=r}else t=o;return t;function r(i){i&&(e.message=i.message,i=e,o(i))}function o(i){if(i){if(process.throwDeprecation)throw i;if(!process.noDeprecation){var n="fs: missing callback "+(i.stack||i.message);process.traceDeprecation?console.trace(n):console.error(n)}}}}function pC(t){return typeof t=="function"?t:dC()}var uF=_r.normalize;Vt?Et=/(.*?)(?:[\/\\]+|$)/g:Et=/(.*?)(?:[\/]+|$)/g;var Et;Vt?Ai=/^(?:[a-zA-Z]:|[\\\/]{2}[^\\\/]+[\\\/][^\\\/]+)?[\\\/]*/:Ai=/^[\/]*/;var Ai;sl.realpathSync=function(e,r){if(e=_r.resolve(e),r&&Object.prototype.hasOwnProperty.call(r,e))return r[e];var o=e,i={},n={},a,s,l,c;u();function u(){var g=Ai.exec(e);a=g[0].length,s=g[0],l=g[0],c="",Vt&&!n[l]&&(qt.lstatSync(l),n[l]=!0)}for(;a<e.length;){Et.lastIndex=a;var f=Et.exec(e);if(c=s,s+=f[0],l=c+f[1],a=Et.lastIndex,!(n[l]||r&&r[l]===l)){var d;if(r&&Object.prototype.hasOwnProperty.call(r,l))d=r[l];else{var p=qt.lstatSync(l);if(!p.isSymbolicLink()){n[l]=!0,r&&(r[l]=l);continue}var m=null;if(!Vt){var h=p.dev.toString(32)+":"+p.ino.toString(32);i.hasOwnProperty(h)&&(m=i[h])}m===null&&(qt.statSync(l),m=qt.readlinkSync(l)),d=_r.resolve(c,m),r&&(r[l]=d),Vt||(i[h]=m)}e=_r.resolve(d,e.slice(a)),u()}}return r&&(r[o]=e),e};sl.realpath=function(e,r,o){if(typeof o!="function"&&(o=pC(r),r=null),e=_r.resolve(e),r&&Object.prototype.hasOwnProperty.call(r,e))return process.nextTick(o.bind(null,null,r[e]));var i=e,n={},a={},s,l,c,u;f();function f(){var g=Ai.exec(e);s=g[0].length,l=g[0],c=g[0],u="",Vt&&!a[c]?qt.lstat(c,function(x){if(x)return o(x);a[c]=!0,d()}):process.nextTick(d)}function d(){if(s>=e.length)return r&&(r[i]=e),o(null,e);Et.lastIndex=s;var g=Et.exec(e);return u=l,l+=g[0],c=u+g[1],s=Et.lastIndex,a[c]||r&&r[c]===c?process.nextTick(d):r&&Object.prototype.hasOwnProperty.call(r,c)?h(r[c]):qt.lstat(c,p)}function p(g,x){if(g)return o(g);if(!x.isSymbolicLink())return a[c]=!0,r&&(r[c]=c),process.nextTick(d);if(!Vt){var b=x.dev.toString(32)+":"+x.ino.toString(32);if(n.hasOwnProperty(b))return m(null,n[b],c)}qt.stat(c,function(S){if(S)return o(S);qt.readlink(c,function(I,V){Vt||(n[b]=V),m(I,V)})})}function m(g,x,b){if(g)return o(g);var S=_r.resolve(u,x);r&&(r[b]=S),h(S)}function h(g){e=_r.resolve(g,e.slice(s)),f()}}});var fl=L((dF,rm)=>{rm.exports=zt;zt.realpath=zt;zt.sync=ul;zt.realpathSync=ul;zt.monkeypatch=hC;zt.unmonkeypatch=gC;var Mo=require("fs"),ll=Mo.realpath,cl=Mo.realpathSync,mC=process.version,Zp=/^v[0-5]\./.test(mC),em=Jp();function tm(t){return t&&t.syscall==="realpath"&&(t.code==="ELOOP"||t.code==="ENOMEM"||t.code==="ENAMETOOLONG")}function zt(t,e,r){if(Zp)return ll(t,e,r);typeof e=="function"&&(r=e,e=null),ll(t,e,function(o,i){tm(o)?em.realpath(t,e,r):r(o,i)})}function ul(t,e){if(Zp)return cl(t,e);try{return cl(t,e)}catch(r){if(tm(r))return em.realpathSync(t,e);throw r}}function hC(){Mo.realpath=zt,Mo.realpathSync=ul}function gC(){Mo.realpath=ll,Mo.realpathSync=cl}});var im=L((pF,om)=>{om.exports=function(t,e){for(var r=[],o=0;o<t.length;o++){var i=e(t[o],o);wC(i)?r.push.apply(r,i):r.push(i)}return r};var wC=Array.isArray||function(t){return Object.prototype.toString.call(t)==="[object Array]"}});var cm=L((mF,lm)=>{"use strict";lm.exports=am;function am(t,e,r){t instanceof RegExp&&(t=nm(t,r)),e instanceof RegExp&&(e=nm(e,r));var o=sm(t,e,r);return o&&{start:o[0],end:o[1],pre:r.slice(0,o[0]),body:r.slice(o[0]+t.length,o[1]),post:r.slice(o[1]+e.length)}}function nm(t,e){var r=e.match(t);return r?r[0]:null}am.range=sm;function sm(t,e,r){var o,i,n,a,s,l=r.indexOf(t),c=r.indexOf(e,l+1),u=l;if(l>=0&&c>0){if(t===e)return[l,c];for(o=[],n=r.length;u>=0&&!s;)u==l?(o.push(u),l=r.indexOf(t,u+1)):o.length==1?s=[o.pop(),c]:(i=o.pop(),i<n&&(n=i,a=c),c=r.indexOf(e,u+1)),u=l<c&&l>=0?l:c;o.length&&(s=[n,a])}return s}});var wm=L((hF,gm)=>{var xC=im(),um=cm();gm.exports=vC;var fm="\0SLASH"+Math.random()+"\0",dm="\0OPEN"+Math.random()+"\0",pl="\0CLOSE"+Math.random()+"\0",pm="\0COMMA"+Math.random()+"\0",mm="\0PERIOD"+Math.random()+"\0";function dl(t){return parseInt(t,10)==t?parseInt(t,10):t.charCodeAt(0)}function bC(t){return t.split("\\\\").join(fm).split("\\{").join(dm).split("\\}").join(pl).split("\\,").join(pm).split("\\.").join(mm)}function yC(t){return t.split(fm).join("\\").split(dm).join("{").split(pl).join("}").split(pm).join(",").split(mm).join(".")}function hm(t){if(!t)return[""];var e=[],r=um("{","}",t);if(!r)return t.split(",");var o=r.pre,i=r.body,n=r.post,a=o.split(",");a[a.length-1]+="{"+i+"}";var s=hm(n);return n.length&&(a[a.length-1]+=s.shift(),a.push.apply(a,s)),e.push.apply(e,a),e}function vC(t){return t?(t.substr(0,2)==="{}"&&(t="\\{\\}"+t.substr(2)),ko(bC(t),!0).map(yC)):[]}function EC(t){return"{"+t+"}"}function SC(t){return/^-?0\d/.test(t)}function TC(t,e){return t<=e}function NC(t,e){return t>=e}function ko(t,e){var r=[],o=um("{","}",t);if(!o||/\$$/.test(o.pre))return[t];var i=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(o.body),n=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(o.body),a=i||n,s=o.body.indexOf(",")>=0;if(!a&&!s)return o.post.match(/,.*\}/)?(t=o.pre+"{"+o.body+pl+o.post,ko(t)):[t];var l;if(a)l=o.body.split(/\.\./);else if(l=hm(o.body),l.length===1&&(l=ko(l[0],!1).map(EC),l.length===1)){var u=o.post.length?ko(o.post,!1):[""];return u.map(function(oo){return o.pre+l[0]+oo})}var c=o.pre,u=o.post.length?ko(o.post,!1):[""],f;if(a){var d=dl(l[0]),p=dl(l[1]),m=Math.max(l[0].length,l[1].length),h=l.length==3?Math.abs(dl(l[2])):1,g=TC,x=p<d;x&&(h*=-1,g=NC);var b=l.some(SC);f=[];for(var S=d;g(S,p);S+=h){var I;if(n)I=String.fromCharCode(S),I==="\\"&&(I="");else if(I=String(S),b){var V=m-I.length;if(V>0){var pt=new Array(V+1).join("0");S<0?I="-"+pt+I.slice(1):I=pt+I}}f.push(I)}}else f=xC(l,function(mt){return ko(mt,!1)});for(var qe=0;qe<f.length;qe++)for(var Ae=0;Ae<u.length;Ae++){var Te=c+f[qe]+u[Ae];(!e||a||Te)&&r.push(Te)}return r}});var Ro=L((gF,Em)=>{Em.exports=De;De.Minimatch=ve;var _i=function(){try{return require("path")}catch{}}()||{sep:"/"};De.sep=_i.sep;var gl=De.GLOBSTAR=ve.GLOBSTAR={},CC=wm(),xm={"!":{open:"(?:(?!(?:",close:"))[^/]*?)"},"?":{open:"(?:",close:")?"},"+":{open:"(?:",close:")+"},"*":{open:"(?:",close:")*"},"@":{open:"(?:",close:")"}},ml="[^/]",hl=ml+"*?",IC="(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?",OC="(?:(?!(?:\\/|^)\\.).)*?",bm=PC("().*{}+?[]^$\\!");function PC(t){return t.split("").reduce(function(e,r){return e[r]=!0,e},{})}var ym=/\/+/;De.filter=AC;function AC(t,e){return e=e||{},function(r,o,i){return De(r,t,e)}}function Yt(t,e){e=e||{};var r={};return Object.keys(t).forEach(function(o){r[o]=t[o]}),Object.keys(e).forEach(function(o){r[o]=e[o]}),r}De.defaults=function(t){if(!t||typeof t!="object"||!Object.keys(t).length)return De;var e=De,r=function(i,n,a){return e(i,n,Yt(t,a))};return r.Minimatch=function(i,n){return new e.Minimatch(i,Yt(t,n))},r.Minimatch.defaults=function(i){return e.defaults(Yt(t,i)).Minimatch},r.filter=function(i,n){return e.filter(i,Yt(t,n))},r.defaults=function(i){return e.defaults(Yt(t,i))},r.makeRe=function(i,n){return e.makeRe(i,Yt(t,n))},r.braceExpand=function(i,n){return e.braceExpand(i,Yt(t,n))},r.match=function(o,i,n){return e.match(o,i,Yt(t,n))},r};ve.defaults=function(t){return De.defaults(t).Minimatch};function De(t,e,r){return ra(e),r||(r={}),!r.nocomment&&e.charAt(0)==="#"?!1:new ve(e,r).match(t)}function ve(t,e){if(!(this instanceof ve))return new ve(t,e);ra(t),e||(e={}),t=t.trim(),!e.allowWindowsEscape&&_i.sep!=="/"&&(t=t.split(_i.sep).join("/")),this.options=e,this.set=[],this.pattern=t,this.regexp=null,this.negate=!1,this.comment=!1,this.empty=!1,this.partial=!!e.partial,this.make()}ve.prototype.debug=function(){};ve.prototype.make=_C;function _C(){var t=this.pattern,e=this.options;if(!e.nocomment&&t.charAt(0)==="#"){this.comment=!0;return}if(!t){this.empty=!0;return}this.parseNegate();var r=this.globSet=this.braceExpand();e.debug&&(this.debug=function(){console.error.apply(console,arguments)}),this.debug(this.pattern,r),r=this.globParts=r.map(function(o){return o.split(ym)}),this.debug(this.pattern,r),r=r.map(function(o,i,n){return o.map(this.parse,this)},this),this.debug(this.pattern,r),r=r.filter(function(o){return o.indexOf(!1)===-1}),this.debug(this.pattern,r),this.set=r}ve.prototype.parseNegate=MC;function MC(){var t=this.pattern,e=!1,r=this.options,o=0;if(!r.nonegate){for(var i=0,n=t.length;i<n&&t.charAt(i)==="!";i++)e=!e,o++;o&&(this.pattern=t.substr(o)),this.negate=e}}De.braceExpand=function(t,e){return vm(t,e)};ve.prototype.braceExpand=vm;function vm(t,e){return e||(this instanceof ve?e=this.options:e={}),t=typeof t>"u"?this.pattern:t,ra(t),e.nobrace||!/\{(?:(?!\{).)*\}/.test(t)?[t]:CC(t)}var kC=1024*64,ra=function(t){if(typeof t!="string")throw new TypeError("invalid pattern");if(t.length>kC)throw new TypeError("pattern is too long")};ve.prototype.parse=RC;var ta={};function RC(t,e){ra(t);var r=this.options;if(t==="**")if(r.noglobstar)t="*";else return gl;if(t==="")return"";var o="",i=!!r.nocase,n=!1,a=[],s=[],l,c=!1,u=-1,f=-1,d=t.charAt(0)==="."?"":r.dot?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)",p=this;function m(){if(l){switch(l){case"*":o+=hl,i=!0;break;case"?":o+=ml,i=!0;break;default:o+="\\"+l;break}p.debug("clearStateChar %j %j",l,o),l=!1}}for(var h=0,g=t.length,x;h<g&&(x=t.charAt(h));h++){if(this.debug("%s	%s %s %j",t,h,o,x),n&&bm[x]){o+="\\"+x,n=!1;continue}switch(x){case"/":return!1;case"\\":m(),n=!0;continue;case"?":case"*":case"+":case"@":case"!":if(this.debug("%s	%s %s %j <-- stateChar",t,h,o,x),c){this.debug("  in class"),x==="!"&&h===f+1&&(x="^"),o+=x;continue}p.debug("call clearStateChar %j",l),m(),l=x,r.noext&&m();continue;case"(":if(c){o+="(";continue}if(!l){o+="\\(";continue}a.push({type:l,start:h-1,reStart:o.length,open:xm[l].open,close:xm[l].close}),o+=l==="!"?"(?:(?!(?:":"(?:",this.debug("plType %j %j",l,o),l=!1;continue;case")":if(c||!a.length){o+="\\)";continue}m(),i=!0;var b=a.pop();o+=b.close,b.type==="!"&&s.push(b),b.reEnd=o.length;continue;case"|":if(c||!a.length||n){o+="\\|",n=!1;continue}m(),o+="|";continue;case"[":if(m(),c){o+="\\"+x;continue}c=!0,f=h,u=o.length,o+=x;continue;case"]":if(h===f+1||!c){o+="\\"+x,n=!1;continue}var S=t.substring(f+1,h);try{RegExp("["+S+"]")}catch{var I=this.parse(S,ta);o=o.substr(0,u)+"\\["+I[0]+"\\]",i=i||I[1],c=!1;continue}i=!0,c=!1,o+=x;continue;default:m(),n?n=!1:bm[x]&&!(x==="^"&&c)&&(o+="\\"),o+=x}}for(c&&(S=t.substr(f+1),I=this.parse(S,ta),o=o.substr(0,u)+"\\["+I[0],i=i||I[1]),b=a.pop();b;b=a.pop()){var V=o.slice(b.reStart+b.open.length);this.debug("setting tail",o,b),V=V.replace(/((?:\\{2}){0,64})(\\?)\|/g,function(Pu,Au,js){return js||(js="\\"),Au+Au+js+"|"}),this.debug(`tail=%j
   %s`,V,V,b,o);var pt=b.type==="*"?hl:b.type==="?"?ml:"\\"+b.type;i=!0,o=o.slice(0,b.reStart)+pt+"\\("+V}m(),n&&(o+="\\\\");var qe=!1;switch(o.charAt(0)){case"[":case".":case"(":qe=!0}for(var Ae=s.length-1;Ae>-1;Ae--){var Te=s[Ae],mt=o.slice(0,Te.reStart),oo=o.slice(Te.reStart,Te.reEnd-8),Sr=o.slice(Te.reEnd-8,Te.reEnd),Ve=o.slice(Te.reEnd);Sr+=Ve;var Tr=mt.split("(").length-1,At=Ve;for(h=0;h<Tr;h++)At=At.replace(/\)[+*?]?/,"");Ve=At;var mn="";Ve===""&&e!==ta&&(mn="$");var pb=mt+oo+Ve+mn+Sr;o=pb}if(o!==""&&i&&(o="(?=.)"+o),qe&&(o=d+o),e===ta)return[o,i];if(!i)return DC(t);var mb=r.nocase?"i":"";try{var Fs=new RegExp("^"+o+"$",mb)}catch{return new RegExp("$.")}return Fs._glob=t,Fs._src=o,Fs}De.makeRe=function(t,e){return new ve(t,e||{}).makeRe()};ve.prototype.makeRe=LC;function LC(){if(this.regexp||this.regexp===!1)return this.regexp;var t=this.set;if(!t.length)return this.regexp=!1,this.regexp;var e=this.options,r=e.noglobstar?hl:e.dot?IC:OC,o=e.nocase?"i":"",i=t.map(function(n){return n.map(function(a){return a===gl?r:typeof a=="string"?BC(a):a._src}).join("\\/")}).join("|");i="^(?:"+i+")$",this.negate&&(i="^(?!"+i+").*$");try{this.regexp=new RegExp(i,o)}catch{this.regexp=!1}return this.regexp}De.match=function(t,e,r){r=r||{};var o=new ve(e,r);return t=t.filter(function(i){return o.match(i)}),o.options.nonull&&!t.length&&t.push(e),t};ve.prototype.match=function(e,r){if(typeof r>"u"&&(r=this.partial),this.debug("match",e,this.pattern),this.comment)return!1;if(this.empty)return e==="";if(e==="/"&&r)return!0;var o=this.options;_i.sep!=="/"&&(e=e.split(_i.sep).join("/")),e=e.split(ym),this.debug(this.pattern,"split",e);var i=this.set;this.debug(this.pattern,"set",i);var n,a;for(a=e.length-1;a>=0&&(n=e[a],!n);a--);for(a=0;a<i.length;a++){var s=i[a],l=e;o.matchBase&&s.length===1&&(l=[n]);var c=this.matchOne(l,s,r);if(c)return o.flipNegate?!0:!this.negate}return o.flipNegate?!1:this.negate};ve.prototype.matchOne=function(t,e,r){var o=this.options;this.debug("matchOne",{this:this,file:t,pattern:e}),this.debug("matchOne",t.length,e.length);for(var i=0,n=0,a=t.length,s=e.length;i<a&&n<s;i++,n++){this.debug("matchOne loop");var l=e[n],c=t[i];if(this.debug(e,l,c),l===!1)return!1;if(l===gl){this.debug("GLOBSTAR",[e,l,c]);var u=i,f=n+1;if(f===s){for(this.debug("** at the end");i<a;i++)if(t[i]==="."||t[i]===".."||!o.dot&&t[i].charAt(0)===".")return!1;return!0}for(;u<a;){var d=t[u];if(this.debug(`
globstar while`,t,u,e,f,d),this.matchOne(t.slice(u),e.slice(f),r))return this.debug("globstar found match!",u,a,d),!0;if(d==="."||d===".."||!o.dot&&d.charAt(0)==="."){this.debug("dot detected!",t,u,e,f);break}this.debug("globstar swallow a segment, and continue"),u++}return!!(r&&(this.debug(`
>>> no match, partial?`,t,u,e,f),u===a))}var p;if(typeof l=="string"?(p=c===l,this.debug("string match",l,c,p)):(p=c.match(l),this.debug("pattern match",l,c,p)),!p)return!1}if(i===a&&n===s)return!0;if(i===a)return r;if(n===s)return i===a-1&&t[i]==="";throw new Error("wtf?")};function DC(t){return t.replace(/\\(.)/g,"$1")}function BC(t){return t.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}});var Sm=L((wF,wl)=>{typeof Object.create=="function"?wl.exports=function(e,r){r&&(e.super_=r,e.prototype=Object.create(r.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:wl.exports=function(e,r){if(r){e.super_=r;var o=function(){};o.prototype=r.prototype,e.prototype=new o,e.prototype.constructor=e}}});var Tm=L((xF,bl)=>{try{if(xl=require("util"),typeof xl.inherits!="function")throw"";bl.exports=xl.inherits}catch{bl.exports=Sm()}var xl});var ia=L((bF,oa)=>{"use strict";function Nm(t){return t.charAt(0)==="/"}function Cm(t){var e=/^([a-zA-Z]:|[\\\/]{2}[^\\\/]+[\\\/]+[^\\\/]+)?([\\\/])?([\s\S]*?)$/,r=e.exec(t),o=r[1]||"",i=Boolean(o&&o.charAt(1)!==":");return Boolean(r[2]||i)}oa.exports=process.platform==="win32"?Cm:Nm;oa.exports.posix=Nm;oa.exports.win32=Cm});var vl=L(Kt=>{Kt.setopts=GC;Kt.ownProp=Im;Kt.makeAbs=Mi;Kt.finish=UC;Kt.mark=qC;Kt.isIgnored=Pm;Kt.childrenIgnored=VC;function Im(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var WC=require("fs"),Lo=require("path"),FC=Ro(),Om=ia(),yl=FC.Minimatch;function jC(t,e){return t.localeCompare(e,"en")}function HC(t,e){t.ignore=e.ignore||[],Array.isArray(t.ignore)||(t.ignore=[t.ignore]),t.ignore.length&&(t.ignore=t.ignore.map($C))}function $C(t){var e=null;if(t.slice(-3)==="/**"){var r=t.replace(/(\/\*\*)+$/,"");e=new yl(r,{dot:!0})}return{matcher:new yl(t,{dot:!0}),gmatcher:e}}function GC(t,e,r){if(r||(r={}),r.matchBase&&e.indexOf("/")===-1){if(r.noglobstar)throw new Error("base matching requires globstar");e="**/"+e}t.silent=!!r.silent,t.pattern=e,t.strict=r.strict!==!1,t.realpath=!!r.realpath,t.realpathCache=r.realpathCache||Object.create(null),t.follow=!!r.follow,t.dot=!!r.dot,t.mark=!!r.mark,t.nodir=!!r.nodir,t.nodir&&(t.mark=!0),t.sync=!!r.sync,t.nounique=!!r.nounique,t.nonull=!!r.nonull,t.nosort=!!r.nosort,t.nocase=!!r.nocase,t.stat=!!r.stat,t.noprocess=!!r.noprocess,t.absolute=!!r.absolute,t.fs=r.fs||WC,t.maxLength=r.maxLength||1/0,t.cache=r.cache||Object.create(null),t.statCache=r.statCache||Object.create(null),t.symlinks=r.symlinks||Object.create(null),HC(t,r),t.changedCwd=!1;var o=process.cwd();Im(r,"cwd")?(t.cwd=Lo.resolve(r.cwd),t.changedCwd=t.cwd!==o):t.cwd=o,t.root=r.root||Lo.resolve(t.cwd,"/"),t.root=Lo.resolve(t.root),process.platform==="win32"&&(t.root=t.root.replace(/\\/g,"/")),t.cwdAbs=Om(t.cwd)?t.cwd:Mi(t,t.cwd),process.platform==="win32"&&(t.cwdAbs=t.cwdAbs.replace(/\\/g,"/")),t.nomount=!!r.nomount,r.nonegate=!0,r.nocomment=!0,t.minimatch=new yl(e,r),t.options=t.minimatch.options}function UC(t){for(var e=t.nounique,r=e?[]:Object.create(null),o=0,i=t.matches.length;o<i;o++){var n=t.matches[o];if(!n||Object.keys(n).length===0){if(t.nonull){var a=t.minimatch.globSet[o];e?r.push(a):r[a]=!0}}else{var s=Object.keys(n);e?r.push.apply(r,s):s.forEach(function(l){r[l]=!0})}}if(e||(r=Object.keys(r)),t.nosort||(r=r.sort(jC)),t.mark){for(var o=0;o<r.length;o++)r[o]=t._mark(r[o]);t.nodir&&(r=r.filter(function(l){var c=!/\/$/.test(l),u=t.cache[l]||t.cache[Mi(t,l)];return c&&u&&(c=u!=="DIR"&&!Array.isArray(u)),c}))}t.ignore.length&&(r=r.filter(function(l){return!Pm(t,l)})),t.found=r}function qC(t,e){var r=Mi(t,e),o=t.cache[r],i=e;if(o){var n=o==="DIR"||Array.isArray(o),a=e.slice(-1)==="/";if(n&&!a?i+="/":!n&&a&&(i=i.slice(0,-1)),i!==e){var s=Mi(t,i);t.statCache[s]=t.statCache[r],t.cache[s]=t.cache[r]}}return i}function Mi(t,e){var r=e;return e.charAt(0)==="/"?r=Lo.join(t.root,e):Om(e)||e===""?r=e:t.changedCwd?r=Lo.resolve(t.cwd,e):r=Lo.resolve(e),process.platform==="win32"&&(r=r.replace(/\\/g,"/")),r}function Pm(t,e){return t.ignore.length?t.ignore.some(function(r){return r.matcher.match(e)||!!(r.gmatcher&&r.gmatcher.match(e))}):!1}function VC(t,e){return t.ignore.length?t.ignore.some(function(r){return!!(r.gmatcher&&r.gmatcher.match(e))}):!1}});var Rm=L((TF,km)=>{km.exports=Mm;Mm.GlobSync=de;var zC=fl(),Am=Ro(),vF=Am.Minimatch,EF=Tl().Glob,SF=require("util"),El=require("path"),_m=require("assert"),na=ia(),Mr=vl(),YC=Mr.setopts,Sl=Mr.ownProp,KC=Mr.childrenIgnored,XC=Mr.isIgnored;function Mm(t,e){if(typeof e=="function"||arguments.length===3)throw new TypeError(`callback provided to sync glob
See: https://github.com/isaacs/node-glob/issues/167`);return new de(t,e).found}function de(t,e){if(!t)throw new Error("must provide pattern");if(typeof e=="function"||arguments.length===3)throw new TypeError(`callback provided to sync glob
See: https://github.com/isaacs/node-glob/issues/167`);if(!(this instanceof de))return new de(t,e);if(YC(this,t,e),this.noprocess)return this;var r=this.minimatch.set.length;this.matches=new Array(r);for(var o=0;o<r;o++)this._process(this.minimatch.set[o],o,!1);this._finish()}de.prototype._finish=function(){if(_m(this instanceof de),this.realpath){var t=this;this.matches.forEach(function(e,r){var o=t.matches[r]=Object.create(null);for(var i in e)try{i=t._makeAbs(i);var n=zC.realpathSync(i,t.realpathCache);o[n]=!0}catch(a){if(a.syscall==="stat")o[t._makeAbs(i)]=!0;else throw a}})}Mr.finish(this)};de.prototype._process=function(t,e,r){_m(this instanceof de);for(var o=0;typeof t[o]=="string";)o++;var i;switch(o){case t.length:this._processSimple(t.join("/"),e);return;case 0:i=null;break;default:i=t.slice(0,o).join("/");break}var n=t.slice(o),a;i===null?a=".":((na(i)||na(t.join("/")))&&(!i||!na(i))&&(i="/"+i),a=i);var s=this._makeAbs(a);if(!KC(this,a)){var l=n[0]===Am.GLOBSTAR;l?this._processGlobStar(i,a,s,n,e,r):this._processReaddir(i,a,s,n,e,r)}};de.prototype._processReaddir=function(t,e,r,o,i,n){var a=this._readdir(r,n);if(!!a){for(var s=o[0],l=!!this.minimatch.negate,c=s._glob,u=this.dot||c.charAt(0)===".",f=[],d=0;d<a.length;d++){var p=a[d];if(p.charAt(0)!=="."||u){var m;l&&!t?m=!p.match(s):m=p.match(s),m&&f.push(p)}}var h=f.length;if(h!==0){if(o.length===1&&!this.mark&&!this.stat){this.matches[i]||(this.matches[i]=Object.create(null));for(var d=0;d<h;d++){var p=f[d];t&&(t.slice(-1)!=="/"?p=t+"/"+p:p=t+p),p.charAt(0)==="/"&&!this.nomount&&(p=El.join(this.root,p)),this._emitMatch(i,p)}return}o.shift();for(var d=0;d<h;d++){var p=f[d],g;t?g=[t,p]:g=[p],this._process(g.concat(o),i,n)}}}};de.prototype._emitMatch=function(t,e){if(!XC(this,e)){var r=this._makeAbs(e);if(this.mark&&(e=this._mark(e)),this.absolute&&(e=r),!this.matches[t][e]){if(this.nodir){var o=this.cache[r];if(o==="DIR"||Array.isArray(o))return}this.matches[t][e]=!0,this.stat&&this._stat(e)}}};de.prototype._readdirInGlobStar=function(t){if(this.follow)return this._readdir(t,!1);var e,r,o;try{r=this.fs.lstatSync(t)}catch(n){if(n.code==="ENOENT")return null}var i=r&&r.isSymbolicLink();return this.symlinks[t]=i,!i&&r&&!r.isDirectory()?this.cache[t]="FILE":e=this._readdir(t,!1),e};de.prototype._readdir=function(t,e){var r;if(e&&!Sl(this.symlinks,t))return this._readdirInGlobStar(t);if(Sl(this.cache,t)){var o=this.cache[t];if(!o||o==="FILE")return null;if(Array.isArray(o))return o}try{return this._readdirEntries(t,this.fs.readdirSync(t))}catch(i){return this._readdirError(t,i),null}};de.prototype._readdirEntries=function(t,e){if(!this.mark&&!this.stat)for(var r=0;r<e.length;r++){var o=e[r];t==="/"?o=t+o:o=t+"/"+o,this.cache[o]=!0}return this.cache[t]=e,e};de.prototype._readdirError=function(t,e){switch(e.code){case"ENOTSUP":case"ENOTDIR":var r=this._makeAbs(t);if(this.cache[r]="FILE",r===this.cwdAbs){var o=new Error(e.code+" invalid cwd "+this.cwd);throw o.path=this.cwd,o.code=e.code,o}break;case"ENOENT":case"ELOOP":case"ENAMETOOLONG":case"UNKNOWN":this.cache[this._makeAbs(t)]=!1;break;default:if(this.cache[this._makeAbs(t)]=!1,this.strict)throw e;this.silent||console.error("glob error",e);break}};de.prototype._processGlobStar=function(t,e,r,o,i,n){var a=this._readdir(r,n);if(!!a){var s=o.slice(1),l=t?[t]:[],c=l.concat(s);this._process(c,i,!1);var u=a.length,f=this.symlinks[r];if(!(f&&n))for(var d=0;d<u;d++){var p=a[d];if(!(p.charAt(0)==="."&&!this.dot)){var m=l.concat(a[d],s);this._process(m,i,!0);var h=l.concat(a[d],o);this._process(h,i,!0)}}}};de.prototype._processSimple=function(t,e){var r=this._stat(t);if(this.matches[e]||(this.matches[e]=Object.create(null)),!!r){if(t&&na(t)&&!this.nomount){var o=/[\/\\]$/.test(t);t.charAt(0)==="/"?t=El.join(this.root,t):(t=El.resolve(this.root,t),o&&(t+="/"))}process.platform==="win32"&&(t=t.replace(/\\/g,"/")),this._emitMatch(e,t)}};de.prototype._stat=function(t){var e=this._makeAbs(t),r=t.slice(-1)==="/";if(t.length>this.maxLength)return!1;if(!this.stat&&Sl(this.cache,e)){var a=this.cache[e];if(Array.isArray(a)&&(a="DIR"),!r||a==="DIR")return a;if(r&&a==="FILE")return!1}var o,i=this.statCache[e];if(!i){var n;try{n=this.fs.lstatSync(e)}catch(s){if(s&&(s.code==="ENOENT"||s.code==="ENOTDIR"))return this.statCache[e]=!1,!1}if(n&&n.isSymbolicLink())try{i=this.fs.statSync(e)}catch{i=n}else i=n}this.statCache[e]=i;var a=!0;return i&&(a=i.isDirectory()?"DIR":"FILE"),this.cache[e]=this.cache[e]||a,r&&a==="FILE"?!1:a};de.prototype._mark=function(t){return Mr.mark(this,t)};de.prototype._makeAbs=function(t){return Mr.makeAbs(this,t)}});var Nl=L((NF,Dm)=>{Dm.exports=Lm;function Lm(t,e){if(t&&e)return Lm(t)(e);if(typeof t!="function")throw new TypeError("need wrapper function");return Object.keys(t).forEach(function(o){r[o]=t[o]}),r;function r(){for(var o=new Array(arguments.length),i=0;i<o.length;i++)o[i]=arguments[i];var n=t.apply(this,o),a=o[o.length-1];return typeof n=="function"&&n!==a&&Object.keys(a).forEach(function(s){n[s]=a[s]}),n}}});var Il=L((CF,Cl)=>{var Bm=Nl();Cl.exports=Bm(aa);Cl.exports.strict=Bm(Wm);aa.proto=aa(function(){Object.defineProperty(Function.prototype,"once",{value:function(){return aa(this)},configurable:!0}),Object.defineProperty(Function.prototype,"onceStrict",{value:function(){return Wm(this)},configurable:!0})});function aa(t){var e=function(){return e.called?e.value:(e.called=!0,e.value=t.apply(this,arguments))};return e.called=!1,e}function Wm(t){var e=function(){if(e.called)throw new Error(e.onceError);return e.called=!0,e.value=t.apply(this,arguments)},r=t.name||"Function wrapped with `once`";return e.onceError=r+" shouldn't be called more than once",e.called=!1,e}});var jm=L((IF,Fm)=>{var QC=Nl(),ki=Object.create(null),JC=Il();Fm.exports=QC(ZC);function ZC(t,e){return ki[t]?(ki[t].push(e),null):(ki[t]=[e],eI(t))}function eI(t){return JC(function e(){var r=ki[t],o=r.length,i=tI(arguments);try{for(var n=0;n<o;n++)r[n].apply(null,i)}finally{r.length>o?(r.splice(0,o),process.nextTick(function(){e.apply(null,i)})):delete ki[t]}})}function tI(t){for(var e=t.length,r=[],o=0;o<e;o++)r[o]=t[o];return r}});var Tl=L((AF,$m)=>{$m.exports=kr;var rI=fl(),Hm=Ro(),OF=Hm.Minimatch,oI=Tm(),iI=require("events").EventEmitter,Ol=require("path"),Pl=require("assert"),Ri=ia(),_l=Rm(),Rr=vl(),nI=Rr.setopts,Al=Rr.ownProp,Ml=jm(),PF=require("util"),aI=Rr.childrenIgnored,sI=Rr.isIgnored,lI=Il();function kr(t,e,r){if(typeof e=="function"&&(r=e,e={}),e||(e={}),e.sync){if(r)throw new TypeError("callback provided to sync glob");return _l(t,e)}return new $(t,e,r)}kr.sync=_l;var cI=kr.GlobSync=_l.GlobSync;kr.glob=kr;function uI(t,e){if(e===null||typeof e!="object")return t;for(var r=Object.keys(e),o=r.length;o--;)t[r[o]]=e[r[o]];return t}kr.hasMagic=function(t,e){var r=uI({},e);r.noprocess=!0;var o=new $(t,r),i=o.minimatch.set;if(!t)return!1;if(i.length>1)return!0;for(var n=0;n<i[0].length;n++)if(typeof i[0][n]!="string")return!0;return!1};kr.Glob=$;oI($,iI);function $(t,e,r){if(typeof e=="function"&&(r=e,e=null),e&&e.sync){if(r)throw new TypeError("callback provided to sync glob");return new cI(t,e)}if(!(this instanceof $))return new $(t,e,r);nI(this,t,e),this._didRealPath=!1;var o=this.minimatch.set.length;this.matches=new Array(o),typeof r=="function"&&(r=lI(r),this.on("error",r),this.on("end",function(l){r(null,l)}));var i=this;if(this._processing=0,this._emitQueue=[],this._processQueue=[],this.paused=!1,this.noprocess)return this;if(o===0)return s();for(var n=!0,a=0;a<o;a++)this._process(this.minimatch.set[a],a,!1,s);n=!1;function s(){--i._processing,i._processing<=0&&(n?process.nextTick(function(){i._finish()}):i._finish())}}$.prototype._finish=function(){if(Pl(this instanceof $),!this.aborted){if(this.realpath&&!this._didRealpath)return this._realpath();Rr.finish(this),this.emit("end",this.found)}};$.prototype._realpath=function(){if(this._didRealpath)return;this._didRealpath=!0;var t=this.matches.length;if(t===0)return this._finish();for(var e=this,r=0;r<this.matches.length;r++)this._realpathSet(r,o);function o(){--t===0&&e._finish()}};$.prototype._realpathSet=function(t,e){var r=this.matches[t];if(!r)return e();var o=Object.keys(r),i=this,n=o.length;if(n===0)return e();var a=this.matches[t]=Object.create(null);o.forEach(function(s,l){s=i._makeAbs(s),rI.realpath(s,i.realpathCache,function(c,u){c?c.syscall==="stat"?a[s]=!0:i.emit("error",c):a[u]=!0,--n===0&&(i.matches[t]=a,e())})})};$.prototype._mark=function(t){return Rr.mark(this,t)};$.prototype._makeAbs=function(t){return Rr.makeAbs(this,t)};$.prototype.abort=function(){this.aborted=!0,this.emit("abort")};$.prototype.pause=function(){this.paused||(this.paused=!0,this.emit("pause"))};$.prototype.resume=function(){if(this.paused){if(this.emit("resume"),this.paused=!1,this._emitQueue.length){var t=this._emitQueue.slice(0);this._emitQueue.length=0;for(var e=0;e<t.length;e++){var r=t[e];this._emitMatch(r[0],r[1])}}if(this._processQueue.length){var o=this._processQueue.slice(0);this._processQueue.length=0;for(var e=0;e<o.length;e++){var i=o[e];this._processing--,this._process(i[0],i[1],i[2],i[3])}}}};$.prototype._process=function(t,e,r,o){if(Pl(this instanceof $),Pl(typeof o=="function"),!this.aborted){if(this._processing++,this.paused){this._processQueue.push([t,e,r,o]);return}for(var i=0;typeof t[i]=="string";)i++;var n;switch(i){case t.length:this._processSimple(t.join("/"),e,o);return;case 0:n=null;break;default:n=t.slice(0,i).join("/");break}var a=t.slice(i),s;n===null?s=".":((Ri(n)||Ri(t.join("/")))&&(!n||!Ri(n))&&(n="/"+n),s=n);var l=this._makeAbs(s);if(aI(this,s))return o();var c=a[0]===Hm.GLOBSTAR;c?this._processGlobStar(n,s,l,a,e,r,o):this._processReaddir(n,s,l,a,e,r,o)}};$.prototype._processReaddir=function(t,e,r,o,i,n,a){var s=this;this._readdir(r,n,function(l,c){return s._processReaddir2(t,e,r,o,i,n,c,a)})};$.prototype._processReaddir2=function(t,e,r,o,i,n,a,s){if(!a)return s();for(var l=o[0],c=!!this.minimatch.negate,u=l._glob,f=this.dot||u.charAt(0)===".",d=[],p=0;p<a.length;p++){var m=a[p];if(m.charAt(0)!=="."||f){var h;c&&!t?h=!m.match(l):h=m.match(l),h&&d.push(m)}}var g=d.length;if(g===0)return s();if(o.length===1&&!this.mark&&!this.stat){this.matches[i]||(this.matches[i]=Object.create(null));for(var p=0;p<g;p++){var m=d[p];t&&(t!=="/"?m=t+"/"+m:m=t+m),m.charAt(0)==="/"&&!this.nomount&&(m=Ol.join(this.root,m)),this._emitMatch(i,m)}return s()}o.shift();for(var p=0;p<g;p++){var m=d[p],x;t&&(t!=="/"?m=t+"/"+m:m=t+m),this._process([m].concat(o),i,n,s)}s()};$.prototype._emitMatch=function(t,e){if(!this.aborted&&!sI(this,e)){if(this.paused){this._emitQueue.push([t,e]);return}var r=Ri(e)?e:this._makeAbs(e);if(this.mark&&(e=this._mark(e)),this.absolute&&(e=r),!this.matches[t][e]){if(this.nodir){var o=this.cache[r];if(o==="DIR"||Array.isArray(o))return}this.matches[t][e]=!0;var i=this.statCache[r];i&&this.emit("stat",e,i),this.emit("match",e)}}};$.prototype._readdirInGlobStar=function(t,e){if(this.aborted)return;if(this.follow)return this._readdir(t,!1,e);var r="lstat\0"+t,o=this,i=Ml(r,n);i&&o.fs.lstat(t,i);function n(a,s){if(a&&a.code==="ENOENT")return e();var l=s&&s.isSymbolicLink();o.symlinks[t]=l,!l&&s&&!s.isDirectory()?(o.cache[t]="FILE",e()):o._readdir(t,!1,e)}};$.prototype._readdir=function(t,e,r){if(!this.aborted&&(r=Ml("readdir\0"+t+"\0"+e,r),!!r)){if(e&&!Al(this.symlinks,t))return this._readdirInGlobStar(t,r);if(Al(this.cache,t)){var o=this.cache[t];if(!o||o==="FILE")return r();if(Array.isArray(o))return r(null,o)}var i=this;i.fs.readdir(t,fI(this,t,r))}};function fI(t,e,r){return function(o,i){o?t._readdirError(e,o,r):t._readdirEntries(e,i,r)}}$.prototype._readdirEntries=function(t,e,r){if(!this.aborted){if(!this.mark&&!this.stat)for(var o=0;o<e.length;o++){var i=e[o];t==="/"?i=t+i:i=t+"/"+i,this.cache[i]=!0}return this.cache[t]=e,r(null,e)}};$.prototype._readdirError=function(t,e,r){if(!this.aborted){switch(e.code){case"ENOTSUP":case"ENOTDIR":var o=this._makeAbs(t);if(this.cache[o]="FILE",o===this.cwdAbs){var i=new Error(e.code+" invalid cwd "+this.cwd);i.path=this.cwd,i.code=e.code,this.emit("error",i),this.abort()}break;case"ENOENT":case"ELOOP":case"ENAMETOOLONG":case"UNKNOWN":this.cache[this._makeAbs(t)]=!1;break;default:this.cache[this._makeAbs(t)]=!1,this.strict&&(this.emit("error",e),this.abort()),this.silent||console.error("glob error",e);break}return r()}};$.prototype._processGlobStar=function(t,e,r,o,i,n,a){var s=this;this._readdir(r,n,function(l,c){s._processGlobStar2(t,e,r,o,i,n,c,a)})};$.prototype._processGlobStar2=function(t,e,r,o,i,n,a,s){if(!a)return s();var l=o.slice(1),c=t?[t]:[],u=c.concat(l);this._process(u,i,!1,s);var f=this.symlinks[r],d=a.length;if(f&&n)return s();for(var p=0;p<d;p++){var m=a[p];if(!(m.charAt(0)==="."&&!this.dot)){var h=c.concat(a[p],l);this._process(h,i,!0,s);var g=c.concat(a[p],o);this._process(g,i,!0,s)}}s()};$.prototype._processSimple=function(t,e,r){var o=this;this._stat(t,function(i,n){o._processSimple2(t,e,i,n,r)})};$.prototype._processSimple2=function(t,e,r,o,i){if(this.matches[e]||(this.matches[e]=Object.create(null)),!o)return i();if(t&&Ri(t)&&!this.nomount){var n=/[\/\\]$/.test(t);t.charAt(0)==="/"?t=Ol.join(this.root,t):(t=Ol.resolve(this.root,t),n&&(t+="/"))}process.platform==="win32"&&(t=t.replace(/\\/g,"/")),this._emitMatch(e,t),i()};$.prototype._stat=function(t,e){var r=this._makeAbs(t),o=t.slice(-1)==="/";if(t.length>this.maxLength)return e();if(!this.stat&&Al(this.cache,r)){var i=this.cache[r];if(Array.isArray(i)&&(i="DIR"),!o||i==="DIR")return e(null,i);if(o&&i==="FILE")return e()}var n,a=this.statCache[r];if(a!==void 0){if(a===!1)return e(null,a);var s=a.isDirectory()?"DIR":"FILE";return o&&s==="FILE"?e():e(null,s,a)}var l=this,c=Ml("stat\0"+r,u);c&&l.fs.lstat(r,c);function u(f,d){if(d&&d.isSymbolicLink())return l.fs.stat(r,function(p,m){p?l._stat2(t,r,null,d,e):l._stat2(t,r,p,m,e)});l._stat2(t,r,f,d,e)}};$.prototype._stat2=function(t,e,r,o,i){if(r&&(r.code==="ENOENT"||r.code==="ENOTDIR"))return this.statCache[e]=!1,i();var n=t.slice(-1)==="/";if(this.statCache[e]=o,e.slice(-1)==="/"&&o&&!o.isDirectory())return i(null,!1,o);var a=!0;return o&&(a=o.isDirectory()?"DIR":"FILE"),this.cache[e]=this.cache[e]||a,n&&a==="FILE"?i():i(null,a,o)}});var Xm=L((_F,Km)=>{var Y=require("assert"),Vm=require("path"),Gm=require("fs"),Do;try{Do=Tl()}catch{}var dI={nosort:!0,silent:!0},kl=0,Li=process.platform==="win32",zm=t=>{if(["unlink","chmod","stat","lstat","rmdir","readdir"].forEach(r=>{t[r]=t[r]||Gm[r],r=r+"Sync",t[r]=t[r]||Gm[r]}),t.maxBusyTries=t.maxBusyTries||3,t.emfileWait=t.emfileWait||1e3,t.glob===!1&&(t.disableGlob=!0),t.disableGlob!==!0&&Do===void 0)throw Error("glob dependency not found, set `options.disableGlob = true` if intentional");t.disableGlob=t.disableGlob||!1,t.glob=t.glob||dI},Ll=(t,e,r)=>{typeof e=="function"&&(r=e,e={}),Y(t,"rimraf: missing path"),Y.equal(typeof t,"string","rimraf: path should be a string"),Y.equal(typeof r,"function","rimraf: callback function required"),Y(e,"rimraf: invalid options argument provided"),Y.equal(typeof e,"object","rimraf: options should be object"),zm(e);let o=0,i=null,n=0,a=l=>{i=i||l,--n===0&&r(i)},s=(l,c)=>{if(l)return r(l);if(n=c.length,n===0)return r();c.forEach(u=>{let f=d=>{if(d){if((d.code==="EBUSY"||d.code==="ENOTEMPTY"||d.code==="EPERM")&&o<e.maxBusyTries)return o++,setTimeout(()=>Rl(u,e,f),o*100);if(d.code==="EMFILE"&&kl<e.emfileWait)return setTimeout(()=>Rl(u,e,f),kl++);d.code==="ENOENT"&&(d=null)}kl=0,a(d)};Rl(u,e,f)})};if(e.disableGlob||!Do.hasMagic(t))return s(null,[t]);e.lstat(t,(l,c)=>{if(!l)return s(null,[t]);Do(t,e.glob,s)})},Rl=(t,e,r)=>{Y(t),Y(e),Y(typeof r=="function"),e.lstat(t,(o,i)=>{if(o&&o.code==="ENOENT")return r(null);if(o&&o.code==="EPERM"&&Li&&Um(t,e,o,r),i&&i.isDirectory())return sa(t,e,o,r);e.unlink(t,n=>{if(n){if(n.code==="ENOENT")return r(null);if(n.code==="EPERM")return Li?Um(t,e,n,r):sa(t,e,n,r);if(n.code==="EISDIR")return sa(t,e,n,r)}return r(n)})})},Um=(t,e,r,o)=>{Y(t),Y(e),Y(typeof o=="function"),e.chmod(t,438,i=>{i?o(i.code==="ENOENT"?null:r):e.stat(t,(n,a)=>{n?o(n.code==="ENOENT"?null:r):a.isDirectory()?sa(t,e,r,o):e.unlink(t,o)})})},qm=(t,e,r)=>{Y(t),Y(e);try{e.chmodSync(t,438)}catch(i){if(i.code==="ENOENT")return;throw r}let o;try{o=e.statSync(t)}catch(i){if(i.code==="ENOENT")return;throw r}o.isDirectory()?la(t,e,r):e.unlinkSync(t)},sa=(t,e,r,o)=>{Y(t),Y(e),Y(typeof o=="function"),e.rmdir(t,i=>{i&&(i.code==="ENOTEMPTY"||i.code==="EEXIST"||i.code==="EPERM")?pI(t,e,o):i&&i.code==="ENOTDIR"?o(r):o(i)})},pI=(t,e,r)=>{Y(t),Y(e),Y(typeof r=="function"),e.readdir(t,(o,i)=>{if(o)return r(o);let n=i.length;if(n===0)return e.rmdir(t,r);let a;i.forEach(s=>{Ll(Vm.join(t,s),e,l=>{if(!a){if(l)return r(a=l);--n===0&&e.rmdir(t,r)}})})})},Ym=(t,e)=>{e=e||{},zm(e),Y(t,"rimraf: missing path"),Y.equal(typeof t,"string","rimraf: path should be a string"),Y(e,"rimraf: missing options"),Y.equal(typeof e,"object","rimraf: options should be object");let r;if(e.disableGlob||!Do.hasMagic(t))r=[t];else try{e.lstatSync(t),r=[t]}catch{r=Do.sync(t,e.glob)}if(!!r.length)for(let o=0;o<r.length;o++){let i=r[o],n;try{n=e.lstatSync(i)}catch(a){if(a.code==="ENOENT")return;a.code==="EPERM"&&Li&&qm(i,e,a)}try{n&&n.isDirectory()?la(i,e,null):e.unlinkSync(i)}catch(a){if(a.code==="ENOENT")return;if(a.code==="EPERM")return Li?qm(i,e,a):la(i,e,a);if(a.code!=="EISDIR")throw a;la(i,e,a)}}},la=(t,e,r)=>{Y(t),Y(e);try{e.rmdirSync(t)}catch(o){if(o.code==="ENOENT")return;if(o.code==="ENOTDIR")throw r;(o.code==="ENOTEMPTY"||o.code==="EEXIST"||o.code==="EPERM")&&mI(t,e)}},mI=(t,e)=>{Y(t),Y(e),e.readdirSync(t).forEach(i=>Ym(Vm.join(t,i),e));let r=Li?100:1,o=0;do{let i=!0;try{let n=e.rmdirSync(t,e);return i=!1,n}finally{if(++o<r&&i)continue}}while(!0)};Km.exports=Ll;Ll.sync=Ym});var th=L((MF,eh)=>{eh.exports=Zm;Zm.sync=gI;var Qm=require("fs");function hI(t,e){var r=e.pathExt!==void 0?e.pathExt:process.env.PATHEXT;if(!r||(r=r.split(";"),r.indexOf("")!==-1))return!0;for(var o=0;o<r.length;o++){var i=r[o].toLowerCase();if(i&&t.substr(-i.length).toLowerCase()===i)return!0}return!1}function Jm(t,e,r){return!t.isSymbolicLink()&&!t.isFile()?!1:hI(e,r)}function Zm(t,e,r){Qm.stat(t,function(o,i){r(o,o?!1:Jm(i,t,e))})}function gI(t,e){return Jm(Qm.statSync(t),t,e)}});var ah=L((kF,nh)=>{nh.exports=oh;oh.sync=wI;var rh=require("fs");function oh(t,e,r){rh.stat(t,function(o,i){r(o,o?!1:ih(i,e))})}function wI(t,e){return ih(rh.statSync(t),e)}function ih(t,e){return t.isFile()&&xI(t,e)}function xI(t,e){var r=t.mode,o=t.uid,i=t.gid,n=e.uid!==void 0?e.uid:process.getuid&&process.getuid(),a=e.gid!==void 0?e.gid:process.getgid&&process.getgid(),s=parseInt("100",8),l=parseInt("010",8),c=parseInt("001",8),u=s|l,f=r&c||r&l&&i===a||r&s&&o===n||r&u&&n===0;return f}});var lh=L((LF,sh)=>{var RF=require("fs"),ca;process.platform==="win32"||global.TESTING_WINDOWS?ca=th():ca=ah();sh.exports=Dl;Dl.sync=bI;function Dl(t,e,r){if(typeof e=="function"&&(r=e,e={}),!r){if(typeof Promise!="function")throw new TypeError("callback not provided");return new Promise(function(o,i){Dl(t,e||{},function(n,a){n?i(n):o(a)})})}ca(t,e||{},function(o,i){o&&(o.code==="EACCES"||e&&e.ignoreErrors)&&(o=null,i=!1),r(o,i)})}function bI(t,e){try{return ca.sync(t,e||{})}catch(r){if(e&&e.ignoreErrors||r.code==="EACCES")return!1;throw r}}});var hh=L((DF,mh)=>{var Bo=process.platform==="win32"||process.env.OSTYPE==="cygwin"||process.env.OSTYPE==="msys",ch=require("path"),yI=Bo?";":":",uh=lh(),fh=t=>Object.assign(new Error(`not found: ${t}`),{code:"ENOENT"}),dh=(t,e)=>{let r=e.colon||yI,o=t.match(/\//)||Bo&&t.match(/\\/)?[""]:[...Bo?[process.cwd()]:[],...(e.path||process.env.PATH||"").split(r)],i=Bo?e.pathExt||process.env.PATHEXT||".EXE;.CMD;.BAT;.COM":"",n=Bo?i.split(r):[""];return Bo&&t.indexOf(".")!==-1&&n[0]!==""&&n.unshift(""),{pathEnv:o,pathExt:n,pathExtExe:i}},ph=(t,e,r)=>{typeof e=="function"&&(r=e,e={}),e||(e={});let{pathEnv:o,pathExt:i,pathExtExe:n}=dh(t,e),a=[],s=c=>new Promise((u,f)=>{if(c===o.length)return e.all&&a.length?u(a):f(fh(t));let d=o[c],p=/^".*"$/.test(d)?d.slice(1,-1):d,m=ch.join(p,t),h=!p&&/^\.[\\\/]/.test(t)?t.slice(0,2)+m:m;u(l(h,c,0))}),l=(c,u,f)=>new Promise((d,p)=>{if(f===i.length)return d(s(u+1));let m=i[f];uh(c+m,{pathExt:n},(h,g)=>{if(!h&&g)if(e.all)a.push(c+m);else return d(c+m);return d(l(c,u,f+1))})});return r?s(0).then(c=>r(null,c),r):s(0)},vI=(t,e)=>{e=e||{};let{pathEnv:r,pathExt:o,pathExtExe:i}=dh(t,e),n=[];for(let a=0;a<r.length;a++){let s=r[a],l=/^".*"$/.test(s)?s.slice(1,-1):s,c=ch.join(l,t),u=!l&&/^\.[\\\/]/.test(t)?t.slice(0,2)+c:c;for(let f=0;f<o.length;f++){let d=u+o[f];try{if(uh.sync(d,{pathExt:i}))if(e.all)n.push(d);else return d}catch{}}}if(e.all&&n.length)return n;if(e.nothrow)return null;throw fh(t)};mh.exports=ph;ph.sync=vI});var Mh=L((rj,_h)=>{"use strict";_h.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}});var Ul=L((oj,Rh)=>{var Wi=Mh(),kh={};for(let t of Object.keys(Wi))kh[Wi[t]]=t;var T={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};Rh.exports=T;for(let t of Object.keys(T)){if(!("channels"in T[t]))throw new Error("missing channels property: "+t);if(!("labels"in T[t]))throw new Error("missing channel labels property: "+t);if(T[t].labels.length!==T[t].channels)throw new Error("channel and label counts mismatch: "+t);let{channels:e,labels:r}=T[t];delete T[t].channels,delete T[t].labels,Object.defineProperty(T[t],"channels",{value:e}),Object.defineProperty(T[t],"labels",{value:r})}T.rgb.hsl=function(t){let e=t[0]/255,r=t[1]/255,o=t[2]/255,i=Math.min(e,r,o),n=Math.max(e,r,o),a=n-i,s,l;n===i?s=0:e===n?s=(r-o)/a:r===n?s=2+(o-e)/a:o===n&&(s=4+(e-r)/a),s=Math.min(s*60,360),s<0&&(s+=360);let c=(i+n)/2;return n===i?l=0:c<=.5?l=a/(n+i):l=a/(2-n-i),[s,l*100,c*100]};T.rgb.hsv=function(t){let e,r,o,i,n,a=t[0]/255,s=t[1]/255,l=t[2]/255,c=Math.max(a,s,l),u=c-Math.min(a,s,l),f=function(d){return(c-d)/6/u+1/2};return u===0?(i=0,n=0):(n=u/c,e=f(a),r=f(s),o=f(l),a===c?i=o-r:s===c?i=1/3+e-o:l===c&&(i=2/3+r-e),i<0?i+=1:i>1&&(i-=1)),[i*360,n*100,c*100]};T.rgb.hwb=function(t){let e=t[0],r=t[1],o=t[2],i=T.rgb.hsl(t)[0],n=1/255*Math.min(e,Math.min(r,o));return o=1-1/255*Math.max(e,Math.max(r,o)),[i,n*100,o*100]};T.rgb.cmyk=function(t){let e=t[0]/255,r=t[1]/255,o=t[2]/255,i=Math.min(1-e,1-r,1-o),n=(1-e-i)/(1-i)||0,a=(1-r-i)/(1-i)||0,s=(1-o-i)/(1-i)||0;return[n*100,a*100,s*100,i*100]};function CI(t,e){return(t[0]-e[0])**2+(t[1]-e[1])**2+(t[2]-e[2])**2}T.rgb.keyword=function(t){let e=kh[t];if(e)return e;let r=1/0,o;for(let i of Object.keys(Wi)){let n=Wi[i],a=CI(t,n);a<r&&(r=a,o=i)}return o};T.keyword.rgb=function(t){return Wi[t]};T.rgb.xyz=function(t){let e=t[0]/255,r=t[1]/255,o=t[2]/255;e=e>.04045?((e+.055)/1.055)**2.4:e/12.92,r=r>.04045?((r+.055)/1.055)**2.4:r/12.92,o=o>.04045?((o+.055)/1.055)**2.4:o/12.92;let i=e*.4124+r*.3576+o*.1805,n=e*.2126+r*.7152+o*.0722,a=e*.0193+r*.1192+o*.9505;return[i*100,n*100,a*100]};T.rgb.lab=function(t){let e=T.rgb.xyz(t),r=e[0],o=e[1],i=e[2];r/=95.047,o/=100,i/=108.883,r=r>.008856?r**(1/3):7.787*r+16/116,o=o>.008856?o**(1/3):7.787*o+16/116,i=i>.008856?i**(1/3):7.787*i+16/116;let n=116*o-16,a=500*(r-o),s=200*(o-i);return[n,a,s]};T.hsl.rgb=function(t){let e=t[0]/360,r=t[1]/100,o=t[2]/100,i,n,a;if(r===0)return a=o*255,[a,a,a];o<.5?i=o*(1+r):i=o+r-o*r;let s=2*o-i,l=[0,0,0];for(let c=0;c<3;c++)n=e+1/3*-(c-1),n<0&&n++,n>1&&n--,6*n<1?a=s+(i-s)*6*n:2*n<1?a=i:3*n<2?a=s+(i-s)*(2/3-n)*6:a=s,l[c]=a*255;return l};T.hsl.hsv=function(t){let e=t[0],r=t[1]/100,o=t[2]/100,i=r,n=Math.max(o,.01);o*=2,r*=o<=1?o:2-o,i*=n<=1?n:2-n;let a=(o+r)/2,s=o===0?2*i/(n+i):2*r/(o+r);return[e,s*100,a*100]};T.hsv.rgb=function(t){let e=t[0]/60,r=t[1]/100,o=t[2]/100,i=Math.floor(e)%6,n=e-Math.floor(e),a=255*o*(1-r),s=255*o*(1-r*n),l=255*o*(1-r*(1-n));switch(o*=255,i){case 0:return[o,l,a];case 1:return[s,o,a];case 2:return[a,o,l];case 3:return[a,s,o];case 4:return[l,a,o];case 5:return[o,a,s]}};T.hsv.hsl=function(t){let e=t[0],r=t[1]/100,o=t[2]/100,i=Math.max(o,.01),n,a;a=(2-r)*o;let s=(2-r)*i;return n=r*i,n/=s<=1?s:2-s,n=n||0,a/=2,[e,n*100,a*100]};T.hwb.rgb=function(t){let e=t[0]/360,r=t[1]/100,o=t[2]/100,i=r+o,n;i>1&&(r/=i,o/=i);let a=Math.floor(6*e),s=1-o;n=6*e-a,(a&1)!==0&&(n=1-n);let l=r+n*(s-r),c,u,f;switch(a){default:case 6:case 0:c=s,u=l,f=r;break;case 1:c=l,u=s,f=r;break;case 2:c=r,u=s,f=l;break;case 3:c=r,u=l,f=s;break;case 4:c=l,u=r,f=s;break;case 5:c=s,u=r,f=l;break}return[c*255,u*255,f*255]};T.cmyk.rgb=function(t){let e=t[0]/100,r=t[1]/100,o=t[2]/100,i=t[3]/100,n=1-Math.min(1,e*(1-i)+i),a=1-Math.min(1,r*(1-i)+i),s=1-Math.min(1,o*(1-i)+i);return[n*255,a*255,s*255]};T.xyz.rgb=function(t){let e=t[0]/100,r=t[1]/100,o=t[2]/100,i,n,a;return i=e*3.2406+r*-1.5372+o*-.4986,n=e*-.9689+r*1.8758+o*.0415,a=e*.0557+r*-.204+o*1.057,i=i>.0031308?1.055*i**(1/2.4)-.055:i*12.92,n=n>.0031308?1.055*n**(1/2.4)-.055:n*12.92,a=a>.0031308?1.055*a**(1/2.4)-.055:a*12.92,i=Math.min(Math.max(0,i),1),n=Math.min(Math.max(0,n),1),a=Math.min(Math.max(0,a),1),[i*255,n*255,a*255]};T.xyz.lab=function(t){let e=t[0],r=t[1],o=t[2];e/=95.047,r/=100,o/=108.883,e=e>.008856?e**(1/3):7.787*e+16/116,r=r>.008856?r**(1/3):7.787*r+16/116,o=o>.008856?o**(1/3):7.787*o+16/116;let i=116*r-16,n=500*(e-r),a=200*(r-o);return[i,n,a]};T.lab.xyz=function(t){let e=t[0],r=t[1],o=t[2],i,n,a;n=(e+16)/116,i=r/500+n,a=n-o/200;let s=n**3,l=i**3,c=a**3;return n=s>.008856?s:(n-16/116)/7.787,i=l>.008856?l:(i-16/116)/7.787,a=c>.008856?c:(a-16/116)/7.787,i*=95.047,n*=100,a*=108.883,[i,n,a]};T.lab.lch=function(t){let e=t[0],r=t[1],o=t[2],i;i=Math.atan2(o,r)*360/2/Math.PI,i<0&&(i+=360);let a=Math.sqrt(r*r+o*o);return[e,a,i]};T.lch.lab=function(t){let e=t[0],r=t[1],i=t[2]/360*2*Math.PI,n=r*Math.cos(i),a=r*Math.sin(i);return[e,n,a]};T.rgb.ansi16=function(t,e=null){let[r,o,i]=t,n=e===null?T.rgb.hsv(t)[2]:e;if(n=Math.round(n/50),n===0)return 30;let a=30+(Math.round(i/255)<<2|Math.round(o/255)<<1|Math.round(r/255));return n===2&&(a+=60),a};T.hsv.ansi16=function(t){return T.rgb.ansi16(T.hsv.rgb(t),t[2])};T.rgb.ansi256=function(t){let e=t[0],r=t[1],o=t[2];return e===r&&r===o?e<8?16:e>248?231:Math.round((e-8)/247*24)+232:16+36*Math.round(e/255*5)+6*Math.round(r/255*5)+Math.round(o/255*5)};T.ansi16.rgb=function(t){let e=t%10;if(e===0||e===7)return t>50&&(e+=3.5),e=e/10.5*255,[e,e,e];let r=(~~(t>50)+1)*.5,o=(e&1)*r*255,i=(e>>1&1)*r*255,n=(e>>2&1)*r*255;return[o,i,n]};T.ansi256.rgb=function(t){if(t>=232){let n=(t-232)*10+8;return[n,n,n]}t-=16;let e,r=Math.floor(t/36)/5*255,o=Math.floor((e=t%36)/6)/5*255,i=e%6/5*255;return[r,o,i]};T.rgb.hex=function(t){let r=(((Math.round(t[0])&255)<<16)+((Math.round(t[1])&255)<<8)+(Math.round(t[2])&255)).toString(16).toUpperCase();return"000000".substring(r.length)+r};T.hex.rgb=function(t){let e=t.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!e)return[0,0,0];let r=e[0];e[0].length===3&&(r=r.split("").map(s=>s+s).join(""));let o=parseInt(r,16),i=o>>16&255,n=o>>8&255,a=o&255;return[i,n,a]};T.rgb.hcg=function(t){let e=t[0]/255,r=t[1]/255,o=t[2]/255,i=Math.max(Math.max(e,r),o),n=Math.min(Math.min(e,r),o),a=i-n,s,l;return a<1?s=n/(1-a):s=0,a<=0?l=0:i===e?l=(r-o)/a%6:i===r?l=2+(o-e)/a:l=4+(e-r)/a,l/=6,l%=1,[l*360,a*100,s*100]};T.hsl.hcg=function(t){let e=t[1]/100,r=t[2]/100,o=r<.5?2*e*r:2*e*(1-r),i=0;return o<1&&(i=(r-.5*o)/(1-o)),[t[0],o*100,i*100]};T.hsv.hcg=function(t){let e=t[1]/100,r=t[2]/100,o=e*r,i=0;return o<1&&(i=(r-o)/(1-o)),[t[0],o*100,i*100]};T.hcg.rgb=function(t){let e=t[0]/360,r=t[1]/100,o=t[2]/100;if(r===0)return[o*255,o*255,o*255];let i=[0,0,0],n=e%1*6,a=n%1,s=1-a,l=0;switch(Math.floor(n)){case 0:i[0]=1,i[1]=a,i[2]=0;break;case 1:i[0]=s,i[1]=1,i[2]=0;break;case 2:i[0]=0,i[1]=1,i[2]=a;break;case 3:i[0]=0,i[1]=s,i[2]=1;break;case 4:i[0]=a,i[1]=0,i[2]=1;break;default:i[0]=1,i[1]=0,i[2]=s}return l=(1-r)*o,[(r*i[0]+l)*255,(r*i[1]+l)*255,(r*i[2]+l)*255]};T.hcg.hsv=function(t){let e=t[1]/100,r=t[2]/100,o=e+r*(1-e),i=0;return o>0&&(i=e/o),[t[0],i*100,o*100]};T.hcg.hsl=function(t){let e=t[1]/100,o=t[2]/100*(1-e)+.5*e,i=0;return o>0&&o<.5?i=e/(2*o):o>=.5&&o<1&&(i=e/(2*(1-o))),[t[0],i*100,o*100]};T.hcg.hwb=function(t){let e=t[1]/100,r=t[2]/100,o=e+r*(1-e);return[t[0],(o-e)*100,(1-o)*100]};T.hwb.hcg=function(t){let e=t[1]/100,r=t[2]/100,o=1-r,i=o-e,n=0;return i<1&&(n=(o-i)/(1-i)),[t[0],i*100,n*100]};T.apple.rgb=function(t){return[t[0]/65535*255,t[1]/65535*255,t[2]/65535*255]};T.rgb.apple=function(t){return[t[0]/255*65535,t[1]/255*65535,t[2]/255*65535]};T.gray.rgb=function(t){return[t[0]/100*255,t[0]/100*255,t[0]/100*255]};T.gray.hsl=function(t){return[0,0,t[0]]};T.gray.hsv=T.gray.hsl;T.gray.hwb=function(t){return[0,100,t[0]]};T.gray.cmyk=function(t){return[0,0,0,t[0]]};T.gray.lab=function(t){return[t[0],0,0]};T.gray.hex=function(t){let e=Math.round(t[0]/100*255)&255,o=((e<<16)+(e<<8)+e).toString(16).toUpperCase();return"000000".substring(o.length)+o};T.rgb.gray=function(t){return[(t[0]+t[1]+t[2])/3/255*100]}});var Dh=L((ij,Lh)=>{var Sa=Ul();function II(){let t={},e=Object.keys(Sa);for(let r=e.length,o=0;o<r;o++)t[e[o]]={distance:-1,parent:null};return t}function OI(t){let e=II(),r=[t];for(e[t].distance=0;r.length;){let o=r.pop(),i=Object.keys(Sa[o]);for(let n=i.length,a=0;a<n;a++){let s=i[a],l=e[s];l.distance===-1&&(l.distance=e[o].distance+1,l.parent=o,r.unshift(s))}}return e}function PI(t,e){return function(r){return e(t(r))}}function AI(t,e){let r=[e[t].parent,t],o=Sa[e[t].parent][t],i=e[t].parent;for(;e[i].parent;)r.unshift(e[i].parent),o=PI(Sa[e[i].parent][i],o),i=e[i].parent;return o.conversion=r,o}Lh.exports=function(t){let e=OI(t),r={},o=Object.keys(e);for(let i=o.length,n=0;n<i;n++){let a=o[n];e[a].parent!==null&&(r[a]=AI(a,e))}return r}});var Fi=L((nj,Bh)=>{var ql=Ul(),_I=Dh(),jo={},MI=Object.keys(ql);function kI(t){let e=function(...r){let o=r[0];return o==null?o:(o.length>1&&(r=o),t(r))};return"conversion"in t&&(e.conversion=t.conversion),e}function RI(t){let e=function(...r){let o=r[0];if(o==null)return o;o.length>1&&(r=o);let i=t(r);if(typeof i=="object")for(let n=i.length,a=0;a<n;a++)i[a]=Math.round(i[a]);return i};return"conversion"in t&&(e.conversion=t.conversion),e}MI.forEach(t=>{jo[t]={},Object.defineProperty(jo[t],"channels",{value:ql[t].channels}),Object.defineProperty(jo[t],"labels",{value:ql[t].labels});let e=_I(t);Object.keys(e).forEach(o=>{let i=e[o];jo[t][o]=RI(i),jo[t][o].raw=kI(i)})});Bh.exports=jo});var Tg=L((R5,Wa)=>{var og,ig,ng,ag,sg,lg,cg,ug,fg,Da,nc,dg,pg,mg,Vo,hg,gg,wg,xg,bg,yg,vg,Eg,Sg,Ba;(function(t){var e=typeof global=="object"?global:typeof self=="object"?self:typeof this=="object"?this:{};typeof define=="function"&&define.amd?define("tslib",["exports"],function(o){t(r(e,r(o)))}):typeof Wa=="object"&&typeof Wa.exports=="object"?t(r(e,r(Wa.exports))):t(r(e));function r(o,i){return o!==e&&(typeof Object.create=="function"?Object.defineProperty(o,"__esModule",{value:!0}):o.__esModule=!0),function(n,a){return o[n]=i?i(n,a):a}}})(function(t){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,i){o.__proto__=i}||function(o,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(o[n]=i[n])};og=function(o,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(o,i);function n(){this.constructor=o}o.prototype=i===null?Object.create(i):(n.prototype=i.prototype,new n)},ig=Object.assign||function(o){for(var i,n=1,a=arguments.length;n<a;n++){i=arguments[n];for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(o[s]=i[s])}return o},ng=function(o,i){var n={};for(var a in o)Object.prototype.hasOwnProperty.call(o,a)&&i.indexOf(a)<0&&(n[a]=o[a]);if(o!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,a=Object.getOwnPropertySymbols(o);s<a.length;s++)i.indexOf(a[s])<0&&Object.prototype.propertyIsEnumerable.call(o,a[s])&&(n[a[s]]=o[a[s]]);return n},ag=function(o,i,n,a){var s=arguments.length,l=s<3?i:a===null?a=Object.getOwnPropertyDescriptor(i,n):a,c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")l=Reflect.decorate(o,i,n,a);else for(var u=o.length-1;u>=0;u--)(c=o[u])&&(l=(s<3?c(l):s>3?c(i,n,l):c(i,n))||l);return s>3&&l&&Object.defineProperty(i,n,l),l},sg=function(o,i){return function(n,a){i(n,a,o)}},lg=function(o,i){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(o,i)},cg=function(o,i,n,a){function s(l){return l instanceof n?l:new n(function(c){c(l)})}return new(n||(n=Promise))(function(l,c){function u(p){try{d(a.next(p))}catch(m){c(m)}}function f(p){try{d(a.throw(p))}catch(m){c(m)}}function d(p){p.done?l(p.value):s(p.value).then(u,f)}d((a=a.apply(o,i||[])).next())})},ug=function(o,i){var n={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},a,s,l,c;return c={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(c[Symbol.iterator]=function(){return this}),c;function u(d){return function(p){return f([d,p])}}function f(d){if(a)throw new TypeError("Generator is already executing.");for(;n;)try{if(a=1,s&&(l=d[0]&2?s.return:d[0]?s.throw||((l=s.return)&&l.call(s),0):s.next)&&!(l=l.call(s,d[1])).done)return l;switch(s=0,l&&(d=[d[0]&2,l.value]),d[0]){case 0:case 1:l=d;break;case 4:return n.label++,{value:d[1],done:!1};case 5:n.label++,s=d[1],d=[0];continue;case 7:d=n.ops.pop(),n.trys.pop();continue;default:if(l=n.trys,!(l=l.length>0&&l[l.length-1])&&(d[0]===6||d[0]===2)){n=0;continue}if(d[0]===3&&(!l||d[1]>l[0]&&d[1]<l[3])){n.label=d[1];break}if(d[0]===6&&n.label<l[1]){n.label=l[1],l=d;break}if(l&&n.label<l[2]){n.label=l[2],n.ops.push(d);break}l[2]&&n.ops.pop(),n.trys.pop();continue}d=i.call(o,n)}catch(p){d=[6,p],s=0}finally{a=l=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}},fg=function(o,i){for(var n in o)n!=="default"&&!Object.prototype.hasOwnProperty.call(i,n)&&Ba(i,o,n)},Ba=Object.create?function(o,i,n,a){a===void 0&&(a=n);var s=Object.getOwnPropertyDescriptor(i,n);(!s||("get"in s?!i.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return i[n]}}),Object.defineProperty(o,a,s)}:function(o,i,n,a){a===void 0&&(a=n),o[a]=i[n]},Da=function(o){var i=typeof Symbol=="function"&&Symbol.iterator,n=i&&o[i],a=0;if(n)return n.call(o);if(o&&typeof o.length=="number")return{next:function(){return o&&a>=o.length&&(o=void 0),{value:o&&o[a++],done:!o}}};throw new TypeError(i?"Object is not iterable.":"Symbol.iterator is not defined.")},nc=function(o,i){var n=typeof Symbol=="function"&&o[Symbol.iterator];if(!n)return o;var a=n.call(o),s,l=[],c;try{for(;(i===void 0||i-- >0)&&!(s=a.next()).done;)l.push(s.value)}catch(u){c={error:u}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(c)throw c.error}}return l},dg=function(){for(var o=[],i=0;i<arguments.length;i++)o=o.concat(nc(arguments[i]));return o},pg=function(){for(var o=0,i=0,n=arguments.length;i<n;i++)o+=arguments[i].length;for(var a=Array(o),s=0,i=0;i<n;i++)for(var l=arguments[i],c=0,u=l.length;c<u;c++,s++)a[s]=l[c];return a},mg=function(o,i,n){if(n||arguments.length===2)for(var a=0,s=i.length,l;a<s;a++)(l||!(a in i))&&(l||(l=Array.prototype.slice.call(i,0,a)),l[a]=i[a]);return o.concat(l||Array.prototype.slice.call(i))},Vo=function(o){return this instanceof Vo?(this.v=o,this):new Vo(o)},hg=function(o,i,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var a=n.apply(o,i||[]),s,l=[];return s={},c("next"),c("throw"),c("return"),s[Symbol.asyncIterator]=function(){return this},s;function c(h){a[h]&&(s[h]=function(g){return new Promise(function(x,b){l.push([h,g,x,b])>1||u(h,g)})})}function u(h,g){try{f(a[h](g))}catch(x){m(l[0][3],x)}}function f(h){h.value instanceof Vo?Promise.resolve(h.value.v).then(d,p):m(l[0][2],h)}function d(h){u("next",h)}function p(h){u("throw",h)}function m(h,g){h(g),l.shift(),l.length&&u(l[0][0],l[0][1])}},gg=function(o){var i,n;return i={},a("next"),a("throw",function(s){throw s}),a("return"),i[Symbol.iterator]=function(){return this},i;function a(s,l){i[s]=o[s]?function(c){return(n=!n)?{value:Vo(o[s](c)),done:s==="return"}:l?l(c):c}:l}},wg=function(o){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=o[Symbol.asyncIterator],n;return i?i.call(o):(o=typeof Da=="function"?Da(o):o[Symbol.iterator](),n={},a("next"),a("throw"),a("return"),n[Symbol.asyncIterator]=function(){return this},n);function a(l){n[l]=o[l]&&function(c){return new Promise(function(u,f){c=o[l](c),s(u,f,c.done,c.value)})}}function s(l,c,u,f){Promise.resolve(f).then(function(d){l({value:d,done:u})},c)}},xg=function(o,i){return Object.defineProperty?Object.defineProperty(o,"raw",{value:i}):o.raw=i,o};var r=Object.create?function(o,i){Object.defineProperty(o,"default",{enumerable:!0,value:i})}:function(o,i){o.default=i};bg=function(o){if(o&&o.__esModule)return o;var i={};if(o!=null)for(var n in o)n!=="default"&&Object.prototype.hasOwnProperty.call(o,n)&&Ba(i,o,n);return r(i,o),i},yg=function(o){return o&&o.__esModule?o:{default:o}},vg=function(o,i,n,a){if(n==="a"&&!a)throw new TypeError("Private accessor was defined without a getter");if(typeof i=="function"?o!==i||!a:!i.has(o))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?a:n==="a"?a.call(o):a?a.value:i.get(o)},Eg=function(o,i,n,a,s){if(a==="m")throw new TypeError("Private method is not writable");if(a==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof i=="function"?o!==i||!s:!i.has(o))throw new TypeError("Cannot write private member to an object whose class did not declare it");return a==="a"?s.call(o,n):s?s.value=n:i.set(o,n),n},Sg=function(o,i){if(i===null||typeof i!="object"&&typeof i!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof o=="function"?i===o:o.has(i)},t("__extends",og),t("__assign",ig),t("__rest",ng),t("__decorate",ag),t("__param",sg),t("__metadata",lg),t("__awaiter",cg),t("__generator",ug),t("__exportStar",fg),t("__createBinding",Ba),t("__values",Da),t("__read",nc),t("__spread",dg),t("__spreadArrays",pg),t("__spreadArray",mg),t("__await",Vo),t("__asyncGenerator",hg),t("__asyncDelegator",gg),t("__asyncValues",wg),t("__makeTemplateObject",xg),t("__importStar",bg),t("__importDefault",yg),t("__classPrivateFieldGet",vg),t("__classPrivateFieldSet",Eg),t("__classPrivateFieldIn",Sg)})});var tw=L((GG,gc)=>{"use strict";var ew=(t,e,r)=>new Promise((o,i)=>{if(r=Object.assign({concurrency:1/0},r),typeof e!="function")throw new TypeError("Mapper function is required");let{concurrency:n}=r;if(!(typeof n=="number"&&n>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${n}\` (${typeof n})`);let a=[],s=t[Symbol.iterator](),l=!1,c=!1,u=0,f=0,d=()=>{if(l)return;let p=s.next(),m=f;if(f++,p.done){c=!0,u===0&&o(a);return}u++,Promise.resolve(p.value).then(h=>e(h,m)).then(h=>{a[m]=h,u--,d()},h=>{l=!0,i(h)})};for(let p=0;p<n&&(d(),!c);p++);});gc.exports=ew;gc.exports.default=ew});var xc=L((UG,wc)=>{"use strict";var tO=tw(),rw=async(t,e,r)=>(await tO(t,(i,n)=>Promise.all([e(i,n),i]),r)).filter(i=>Boolean(i[0])).map(i=>i[1]);wc.exports=rw;wc.exports.default=rw});var lw=L((nU,Ec)=>{"use strict";var iw=require("child_process").exec,nw=require("child_process").execSync,os=require("fs"),ow=require("path"),aw=os.access,sw=os.accessSync,Zo=os.constants||os,yc=process.platform=="win32",nO=function(t,e){aw(t,Zo.F_OK,function(r){e(!r)})},aO=function(t){try{return sw(t,Zo.F_OK),!1}catch{return!0}},sO=function(t,e){aw(t,Zo.F_OK|Zo.X_OK,function(r){e(null,!r)})},lO=function(t){try{return sw(t,Zo.F_OK|Zo.X_OK),!0}catch{return!1}},cO=function(t,e,r){nO(t,function(o){if(!o){var i=iw("command -v "+e+" 2>/dev/null && { echo >&1 "+e+"; exit 0; }",function(n,a,s){r(null,!!a)});return}sO(t,r)})},uO=function(t,e,r){if(!/^(?!(?:.*\s|.*\.|\W+)$)(?:[a-zA-Z]:)?(?:(?:[^<>:"\|\?\*\n])+(?:\/\/|\/|\\\\|\\)?)+$/m.test(t)){r(null,!1);return}var o=iw("where "+e,function(i){i!==null?r(null,!1):r(null,!0)})},fO=function(t,e){if(aO(t))try{var r=nw("command -v "+e+" 2>/dev/null && { echo >&1 "+e+"; exit 0; }");return!!r}catch{return!1}return lO(t)},dO=function(t,e,r){if(!/^(?!(?:.*\s|.*\.|\W+)$)(?:[a-zA-Z]:)?(?:(?:[^<>:"\|\?\*\n])+(?:\/\/|\/|\\\\|\\)?)+$/m.test(t))return!1;try{var o=nw("where "+e,{stdio:[]});return!!o}catch{return!1}},vc=function(t){return/[^A-Za-z0-9_\/:=-]/.test(t)&&(t="'"+t.replace(/'/g,"'\\''")+"'",t=t.replace(/^(?:'')+/g,"").replace(/\\'''/g,"\\'")),t};yc&&(vc=function(t){var e=/[\\]/.test(t);if(e){var r='"'+ow.dirname(t)+'"',o='"'+ow.basename(t)+'"';return r+":"+o}return'"'+t+'"'});Ec.exports=function t(e,r){var o=vc(e);if(!r&&typeof Promise<"u")return new Promise(function(i,n){t(e,function(a,s){s?i(e):n(a)})});yc?uO(e,o,r):cO(e,o,r)};Ec.exports.sync=function(t){var e=vc(t);return yc?dO(t,e):fO(t,e)}});var uw=L((aU,cw)=>{cw.exports=lw()});var Pw=L(sr=>{"use strict";var mO=sr&&sr.__awaiter||function(t,e,r,o){function i(n){return n instanceof r?n:new r(function(a){a(n)})}return new(r||(r=Promise))(function(n,a){function s(u){try{c(o.next(u))}catch(f){a(f)}}function l(u){try{c(o.throw(u))}catch(f){a(f)}}function c(u){u.done?n(u.value):i(u.value).then(s,l)}c((o=o.apply(t,e||[])).next())})};Object.defineProperty(sr,"__esModule",{value:!0});sr.isBinaryFileSync=sr.isBinaryFile=void 0;var ar=require("fs"),Ac=require("util"),hO=Ac.promisify(ar.stat),gO=Ac.promisify(ar.open),wO=Ac.promisify(ar.close),en=512,Pc=class{constructor(e,r){this.fileBuffer=e,this.size=r,this.offset=0,this.error=!1}hasError(){return this.error}nextByte(){return this.offset===this.size||this.hasError()?(this.error=!0,255):this.fileBuffer[this.offset++]}next(e){let r=new Array;for(let o=0;o<e;o++)r[o]=this.nextByte();return r}};function Oc(t){let e=0,r=0;for(;!t.hasError();){let o=t.nextByte();if(r=r|(o&127)<<7*e,(o&128)===0)break;e++}return r}function xO(t){switch(Oc(t)&7){case 0:return Oc(t),!0;case 1:return t.next(8),!0;case 2:let o=Oc(t);return t.next(o),!0;case 5:return t.next(4),!0}return!1}function bO(t,e){let r=new Pc(t,e),o=0;for(;;){if(!xO(r)&&!r.hasError())return!1;if(r.hasError())break;o++}return o>0}function yO(t,e){return mO(this,void 0,void 0,function*(){if(Iw(t)){let r=yield hO(t);Ow(r);let o=yield gO(t,"r"),i=Buffer.alloc(en);return new Promise((n,a)=>{ar.read(o,i,0,en,0,(s,l,c)=>{wO(o),s?a(s):n(ns(i,l))})})}else return e===void 0&&(e=t.length),ns(t,e)})}sr.isBinaryFile=yO;function vO(t,e){if(Iw(t)){let r=ar.statSync(t);Ow(r);let o=ar.openSync(t,"r"),i=Buffer.alloc(en),n=ar.readSync(o,i,0,en,0);return ar.closeSync(o),ns(i,n)}else return e===void 0&&(e=t.length),ns(t,e)}sr.isBinaryFileSync=vO;function ns(t,e){if(e===0)return!1;let r=0,o=Math.min(e,en);if(e>=3&&t[0]===239&&t[1]===187&&t[2]===191||e>=4&&t[0]===0&&t[1]===0&&t[2]===254&&t[3]===255||e>=4&&t[0]===255&&t[1]===254&&t[2]===0&&t[3]===0||e>=4&&t[0]===132&&t[1]===49&&t[2]===149&&t[3]===51)return!1;if(o>=5&&t.slice(0,5).toString()==="%PDF-")return!0;if(e>=2&&t[0]===254&&t[1]===255||e>=2&&t[0]===255&&t[1]===254)return!1;for(let i=0;i<o;i++){if(t[i]===0)return!0;if((t[i]<7||t[i]>14)&&(t[i]<32||t[i]>127)){if(t[i]>193&&t[i]<224&&i+1<o){if(i++,t[i]>127&&t[i]<192)continue}else if(t[i]>223&&t[i]<240&&i+2<o&&(i++,t[i]>127&&t[i]<192&&t[i+1]>127&&t[i+1]<192)){i++;continue}if(r++,i>=32&&r*100/o>10)return!0}}return!!(r*100/o>10||r>1&&bO(t,o))}function Iw(t){return typeof t=="string"}function Ow(t){if(!t.isFile())throw new Error("Path provided was not a file!")}});var zc=L((EV,dx)=>{"use strict";var fx=require("fs"),Vc;function kO(){try{return fx.statSync("/.dockerenv"),!0}catch{return!1}}function RO(){try{return fx.readFileSync("/proc/self/cgroup","utf8").includes("docker")}catch{return!1}}dx.exports=()=>(Vc===void 0&&(Vc=kO()||RO()),Vc)});var hx=L((SV,Yc)=>{"use strict";var LO=require("os"),DO=require("fs"),px=zc(),mx=()=>{if(process.platform!=="linux")return!1;if(LO.release().toLowerCase().includes("microsoft"))return!px();try{return DO.readFileSync("/proc/version","utf8").toLowerCase().includes("microsoft")?!px():!1}catch{return!1}};process.env.__IS_WSL_TEST__?Yc.exports=mx:Yc.exports=mx()});var wx=L((TV,gx)=>{"use strict";gx.exports=(t,e,r)=>{let o=i=>Object.defineProperty(t,e,{value:i,enumerable:!0,writable:!0});return Object.defineProperty(t,e,{configurable:!0,enumerable:!0,get(){let i=r();return o(i),i},set(i){o(i)}}),t}});var Tx=L((NV,Sx)=>{var BO=require("path"),WO=require("child_process"),{promises:Kc,constants:Ex}=require("fs"),Ns=hx(),FO=zc(),Xc=wx(),xx=BO.join(__dirname,"xdg-open"),{platform:li,arch:bx}=process,jO=(()=>{let t="/mnt/",e;return async function(){if(e)return e;let r="/etc/wsl.conf",o=!1;try{await Kc.access(r,Ex.F_OK),o=!0}catch{}if(!o)return t;let i=await Kc.readFile(r,{encoding:"utf8"}),n=/(?<!#.*)root\s*=\s*(?<mountPoint>.*)/g.exec(i);return n?(e=n.groups.mountPoint.trim(),e=e.endsWith("/")?e:`${e}/`,e):t}})(),yx=async(t,e)=>{let r;for(let o of t)try{return await e(o)}catch(i){r=i}throw r},Cs=async t=>{if(t=N({wait:!1,background:!1,newInstance:!1,allowNonzeroExitCode:!1},t),Array.isArray(t.app))return yx(t.app,s=>Cs(G(N({},t),{app:s})));let{name:e,arguments:r=[]}=t.app||{};if(r=[...r],Array.isArray(e))return yx(e,s=>Cs(G(N({},t),{app:{name:s,arguments:r}})));let o,i=[],n={};if(li==="darwin")o="open",t.wait&&i.push("--wait-apps"),t.background&&i.push("--background"),t.newInstance&&i.push("--new"),e&&i.push("-a",e);else if(li==="win32"||Ns&&!FO()){let s=await jO();o=Ns?`${s}c/Windows/System32/WindowsPowerShell/v1.0/powershell.exe`:`${process.env.SYSTEMROOT}\\System32\\WindowsPowerShell\\v1.0\\powershell`,i.push("-NoProfile","-NonInteractive","\u2013ExecutionPolicy","Bypass","-EncodedCommand"),Ns||(n.windowsVerbatimArguments=!0);let l=["Start"];t.wait&&l.push("-Wait"),e?(l.push(`"\`"${e}\`""`,"-ArgumentList"),t.target&&r.unshift(t.target)):t.target&&l.push(`"${t.target}"`),r.length>0&&(r=r.map(c=>`"\`"${c}\`""`),l.push(r.join(","))),t.target=Buffer.from(l.join(" "),"utf16le").toString("base64")}else{if(e)o=e;else{let s=!__dirname||__dirname==="/",l=!1;try{await Kc.access(xx,Ex.X_OK),l=!0}catch{}o=process.versions.electron||li==="android"||s||!l?"xdg-open":xx}r.length>0&&i.push(...r),t.wait||(n.stdio="ignore",n.detached=!0)}t.target&&i.push(t.target),li==="darwin"&&r.length>0&&i.push("--args",...r);let a=WO.spawn(o,i,n);return t.wait?new Promise((s,l)=>{a.once("error",l),a.once("close",c=>{if(t.allowNonzeroExitCode&&c>0){l(new Error(`Exited with code ${c}`));return}s(a)})}):(a.unref(),a)},Qc=(t,e)=>{if(typeof t!="string")throw new TypeError("Expected a `target`");return Cs(G(N({},e),{target:t}))},HO=(t,e)=>{if(typeof t!="string")throw new TypeError("Expected a `name`");let{arguments:r=[]}=e||{};if(r!=null&&!Array.isArray(r))throw new TypeError("Expected `appArguments` as Array type");return Cs(G(N({},e),{app:{name:t,arguments:r}}))};function vx(t){if(typeof t=="string"||Array.isArray(t))return t;let{[bx]:e}=t;if(!e)throw new Error(`${bx} is not supported`);return e}function Jc({[li]:t},{wsl:e}){if(e&&Ns)return vx(e);if(!t)throw new Error(`${li} is not supported`);return vx(t)}var Is={};Xc(Is,"chrome",()=>Jc({darwin:"google chrome",win32:"chrome",linux:["google-chrome","google-chrome-stable","chromium"]},{wsl:{ia32:"/mnt/c/Program Files (x86)/Google/Chrome/Application/chrome.exe",x64:["/mnt/c/Program Files/Google/Chrome/Application/chrome.exe","/mnt/c/Program Files (x86)/Google/Chrome/Application/chrome.exe"]}}));Xc(Is,"firefox",()=>Jc({darwin:"firefox",win32:"C:\\Program Files\\Mozilla Firefox\\firefox.exe",linux:"firefox"},{wsl:"/mnt/c/Program Files/Mozilla Firefox/firefox.exe"}));Xc(Is,"edge",()=>Jc({darwin:"microsoft edge",win32:"msedge",linux:["microsoft-edge","microsoft-edge-dev"]},{wsl:"/mnt/c/Program Files (x86)/Microsoft/Edge/Application/msedge.exe"}));Qc.apps=Is;Qc.openApp=HO;Sx.exports=Qc});var Hx=L((u6,jx)=>{"use strict";var QO=["B","kB","MB","GB","TB","PB","EB","ZB","YB"],JO=["B","kiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],ZO=["b","kbit","Mbit","Gbit","Tbit","Pbit","Ebit","Zbit","Ybit"],eP=["b","kibit","Mibit","Gibit","Tibit","Pibit","Eibit","Zibit","Yibit"],Fx=(t,e,r)=>{let o=t;return typeof e=="string"||Array.isArray(e)?o=t.toLocaleString(e,r):(e===!0||r!==void 0)&&(o=t.toLocaleString(void 0,r)),o};jx.exports=(t,e)=>{if(!Number.isFinite(t))throw new TypeError(`Expected a finite number, got ${typeof t}: ${t}`);e=Object.assign({bits:!1,binary:!1},e);let r=e.bits?e.binary?eP:ZO:e.binary?JO:QO;if(e.signed&&t===0)return` 0 ${r[0]}`;let o=t<0,i=o?"-":e.signed?"+":"";o&&(t=-t);let n;if(e.minimumFractionDigits!==void 0&&(n={minimumFractionDigits:e.minimumFractionDigits}),e.maximumFractionDigits!==void 0&&(n=Object.assign({maximumFractionDigits:e.maximumFractionDigits},n)),t<1){let c=Fx(t,e.locale,n);return i+c+" "+r[0]}let a=Math.min(Math.floor(e.binary?Math.log(t)/Math.log(1024):Math.log10(t)/3),r.length-1);t/=Math.pow(e.binary?1024:1e3,a),n||(t=t.toPrecision(3));let s=Fx(Number(t),e.locale,n),l=r[a];return i+s+" "+l}});var XP={};Eb(XP,{activate:()=>KP});module.exports=Sb(XP);var so=require("coc.nvim");var ao=require("coc.nvim");var xi=require("coc.nvim");var $s=require("coc.nvim");var di=t=>t.filter(e=>e!=null);var Nb=require("coc.nvim");var Fu=require("coc.nvim");var Tb=process.platform==="win32",ZP=process.platform==="darwin",e1=process.platform==="linux",Hs=process.env.NODE_ENV==="test";async function ju(t){return await Fu.workspace.nvim.call("strdisplaywidth",[t])}var pi=require("coc.nvim"),Gu=_(require("util"));var hn=["trace","debug","info","warn","error","fatal","off"],Cb=hn.indexOf("error");function Hu(t){return`${t.toLocaleString()} ${t.getMilliseconds().toString().padStart(3,"0")}`}var mi=class{constructor(e){this.channelName=e,this.timeMarkers=new Map,this.levelStatus="trace",this.levelNumber=hn.indexOf(this.levelStatus),this.appendLine=r=>{this.outputChannel.appendLine(r)},this.log=(r,o)=>{var i,n;let a=hn[r];if(a<this.levelNumber)return;let s=`[${Hu(new Date)}] [${r}]: `;if(o instanceof Error){this.appendLine(`${s}${(i=o.stack)!==null&&i!==void 0?i:o.toString()}`),pi.window.showMessage(o.message,"error"),Hs&&console.error((n=o.stack)!==null&&n!==void 0?n:o.toString());return}this.appendLine(`${s}${o}`),a>Cb&&(pi.window.showMessage(o,"error"),Hs&&console.error(o))},this.trace=r=>{this.log("trace",r)},this.debug=r=>{this.log("debug",r)},this.info=r=>{this.log("info",r)},this.warn=r=>{this.log("warn",r)},this.error=r=>{r instanceof Error||(r=new Error(r)),this.log("error",r)},this.fatal=r=>{this.log("fatal",r)}}set level(e){this.levelStatus=e,this.levelNumber=hn[e]}get level(){return this.levelStatus}dispose(){var e;(e=this.outputChannel_)===null||e===void 0||e.dispose()}get outputChannel(){return this.outputChannel_||(this.outputChannel_=pi.window.createOutputChannel(this.channelName)),this.outputChannel_}time(e="default"){this.timeMarkers.set(e,new Date().valueOf())}timeElapsed(e="default"){let r=this.timeMarkers.get(e);if(r!==void 0)return new Date().valueOf()-r}timeLog(e="default"){let r=this.timeElapsed(e);r!==void 0&&this.appendLine(`${e}: ${r} ms`)}measureTime(e){let r=new Date().valueOf(),o=e();return"then"in o?o.then(i=>[i,new Date().valueOf()-r]):[o,new Date().valueOf()-r]}measureTask(e,r="default",o="info"){let i=this.measureTime(e);if(!("then"in i)){let[n,a]=i;return this.log(o,`[measureTask] ${r}: ${a} ms`),n}return i.then(([n,a])=>(this.log(o,`${r}: ${a} ms`),n))}asyncCatch(e){return async(...r)=>{try{return await e(...r)}catch(o){this.error(o)}}}prettyPrint(...e){this.info($u(...e)),pi.window.showMessage(`[${Hu(new Date)}] ${$u(...e)}`)}},Re=new mi("coc-helper");function $u(...t){return t.map(e=>Gu.default.inspect(e)).join(" ")}var Ib="coc-helper",Ob="0.13.0",Pb="Helpers for coc.nvim",Ab="lib/esm/index.js",_b="lib/cjs/index.js",Mb="https://github.com/weirongxu/coc-helper",kb="git@github.com:weirongxu/coc-helper.git",Rb="Weirong Xu <weirongxu.raidou@gmail.com>",Lb="MIT",Db=["lib","tests","jest.config.js","JestHelper.js","JestHelper.d.ts"],Bb={clean:"rimraf lib","copy:pkg":"cpy --rename=_package.json package.json src/","build:esm":"tsc -p ./tsconfig.prod.json --module es2020 --outDir lib/esm","build:cjs":"tsc -p ./tsconfig.prod.json --module commonjs --outDir lib/cjs",build:"npm-run-all clean copy:pkg build:esm build:cjs",lint:"eslint src --ext ts","setup:test-env":"node ./tests/setup.js",prepare:"run-s clean setup:test-env build",unittest:"jest --runInBand --detectOpenHandles --forceExit",test:"npm-run-all copy:pkg lint unittest"},Wb={coc:"^0.0.77"},Fb=["*"],jb={singleQuote:!0,printWidth:80,semi:!0,trailingComma:"all"},Hb={"coc.nvim":"*"},$b={"@chemzqm/neovim":"^5.4.0","@raidou/eslint-config-base":"^1.5.0","@types/eslint":"^8.2.1","@types/jest":"^27.0.1","@types/node":"^17.0.6","@types/rimraf":"^3.0.2","@types/uuid":"^8.3.1","coc.nvim":"0.0.81-next.0","cpy-cli":"^3.1.1",eslint:"^8.6.0",jest:"^27.2.0",log4js:"^6.3.0","npm-run-all":"^4.1.5",prettier:"^2.5.1","ts-jest":"^27.0.5","type-fest":"^2.3.2",typescript:"^4.4.3"},Gb={rimraf:"^3.0.2",uuid:"^8.3.2"},Uu={name:Ib,version:Ob,description:Pb,module:Ab,main:_b,homepage:Mb,repository:kb,author:Rb,license:Lb,files:Db,scripts:Bb,engines:Wb,activationEvents:Fb,prettier:jb,peerDependencies:Hb,devDependencies:$b,dependencies:Gb};var Ub=Uu.version,io=Ub.replace(/[.-]/g,"_");var v=class{constructor(e){this.notifyFns=[],this.notifyFns.push(e)}static async run(e){if(!!e)if("then"in e){let r=await e;if(r)return r.run()}else return e.run()}static notifyAll(e){for(let r of e)r&&r.notify()}static async runAll(e){let r=await Promise.all(e);return $s.workspace.nvim.pauseNotification(),this.notifyAll(r),$s.workspace.nvim.resumeNotification()}static combine(e){let r=di(e);return r.length<1?v.noop():r.length===1?r[0]:r.reduce((o,i)=>o.concat(i),v.noop())}static noop(){return this.create(()=>{})}static create(e){return new v(e)}async run(){return v.runAll([this])}notify(){for(let e of this.notifyFns)e()}concat(e){return this.notifyFns.push(...e.notifyFns),this}};var qb="__coc_helper_module_max_id";function no(t){let e=`${qb}_${t}`;return e in global||(global[e]=0),global[e]+=1,global[e]}var Gs=no("VimModule"),Vb=`coc_helper_module_m${Gs}_v${io}`,rt=`g:${Vb}`,hi=`CocHelperCallFn_m${Gs}_v${io}`,gi=`CocHelperCallVar_m${Gs}_v${io}`;function wi(t){return t.replace(/\n\s*\\/g,"")}var ue=class{constructor(e){this.moduleKey=e}static async init(e){this.inited=!0,await xi.workspace.nvim.call("execute",`
        if !exists('${rt}')
          let ${rt} = {}
        endif

        function! ${hi}(module_key, method_name, args)
          try
            return call(${rt}[a:module_key][a:method_name], a:args)
          catch
            let ex = v:exception
            let msg = printf('error when call %s.%s.%s, args: [%s]', '${rt}', a:module_key, a:method_name, join(a:args, ','))
            echom msg
            echom ex
            throw msg . ' ' . ex
          endtry
        endfunction

        function! ${gi}(module_key, var_name, expression)
          try
            let ${rt}[a:module_key][a:var_name] = eval(a:expression)
          catch
            let ex = v:exception
            let msg = printf('error when declare %s.%s.%s, expression: %s', '${rt}', a:module_key, a:var_name, a:expression)
            echom msg
            echom ex
            throw msg . ' ' . ex
          endtry
        endfunction
      `);let r=[...this.initQueue];for(;r.length;){let o=r.shift();try{await o.fn(e)}catch(i){Re.error(i)}this.initAfterQueue.length&&(r.push(...this.initAfterQueue),this.initAfterQueue=[])}}static registerInit(e,r){this.inited?this.initAfterQueue.push({description:e,fn:r}):this.initQueue.push({description:e,fn:r})}static create(e,r){let i=`${no("VimModule.module")}_${e}`,n=new ue(i),a;function s(){return a||(a=r(n)),a}return ue.registerInit(`module ${i}`,async()=>{await xi.workspace.nvim.call("execute",`
          if !exists('${rt}.${i}')
            let ${rt}.${i} = {}
          endif
        `),s()}),new Proxy({},{get(l,c){return Reflect.get(s(),c)},has(l,c){return c in s()},ownKeys(){return Object.keys(s())}})}registerInit(e,r){return typeof e=="string"?ue.registerInit(e,r):this.registerInit("",e)}fn(e,r){let{nvim:o}=xi.workspace,i=`${rt}.${this.moduleKey}.${e}`,n=r({name:i});return this.registerInit(`fn ${i}`,async()=>{Re.debug(`declare fn ${i}`),await o.call("execute",[wi(n)])}),{name:i,inlineCall:(a="")=>`${hi}('${this.moduleKey}', '${e}', [${a}])`,call:(...a)=>(Re.debug(`call ${i}`),o.call(hi,[this.moduleKey,e,a])),callNotify:(...a)=>(Re.debug(`callNotify ${i}`),o.call(hi,[this.moduleKey,e,a],!0)),callNotifier:(...a)=>(Re.debug(`callNotifier ${i}`),v.create(()=>{o.call(hi,[this.moduleKey,e,a],!0)}))}}var(e,r){let{nvim:o}=xi.workspace,i=`${rt}.${this.moduleKey}.${e}`;return this.registerInit(`var ${i}`,async()=>{Re.debug(`declare var ${i}`),await o.call(gi,[this.moduleKey,e,wi(r)])}),{name:i,inline:i,get:()=>o.eval(i),set:async n=>{await o.call(gi,[this.moduleKey,e,wi(n)])},setNotify:n=>{o.call(gi,[this.moduleKey,e,wi(n)],!0)},setNotifier:n=>v.create(()=>{o.call(gi,[this.moduleKey,e,wi(n)],!0)})}}};ue.inited=!1;ue.initQueue=[];ue.initAfterQueue=[];var qu=require("coc.nvim"),Nr=ue.create("util",t=>{let e=qu.workspace.isNvim;return{globalCursorPosition:t.fn("global_cursor_position",({name:r})=>`
        function! ${r}()
          let nr = winnr()
          let [row, col] = win_screenpos(nr)
          return [row + winline() - 2, col + wincol() - 2]
        endfunction
      `),isFloat:t.fn("is_float",({name:r})=>e?`
          function! ${r}(winnr) abort
            if !exists('*nvim_win_get_config')
              return v:false
            endif
            let winid = win_getid(a:winnr)
            return nvim_win_get_config(winid)['relative'] != ''
          endfunction
        `:`
          function! ${r}(winnr) abort
            return v:false
          endfunction
        `),closeWinByBufnr:t.fn("close_win_by_bufnr",({name:r})=>`
        if exists('*nvim_win_close')
          function! ${r}(bufnrs) abort
            for bufnr in a:bufnrs
              try
                let winid = bufwinid(bufnr)
                if winid >= 0
                  call nvim_win_close(winid, v:true)
                endif
              catch
              endtry
            endfor
          endfunction
        else
          function! ${r}(bufnrs) abort
            for bufnr in a:bufnrs
              try
                let winnr = bufwinnr(bufnr)
                if winnr >= 0
                  execute winnr . 'wincmd c'
                endif
              catch
              endtry
            endfor
          endfunction
        endif
      `),runCocCmd:t.fn("run_coc_cmd",({name:r})=>`
      function! ${r}(name, ...) abort
        return call('CocAction', extend(['runCommand', a:name], a:000))
      endfunction
    `),runCocCmdAsync:t.fn("run_coc_cmd_async",({name:r})=>`
      function! ${r}(name, ...) abort
        return call('CocActionAsync', extend(['runCommand', a:name], a:000))
      endfunction
    `)}});var zb=no("events"),Vu=`m${zb}_v${io}`,ht=class{constructor(e,r=!1){this.helperLogger=e,this.concurrent=r,this.listenersMap=new Map}listeners(e){if(!this.listenersMap.has(e)){let r=[];return this.listenersMap.set(e,r),r}return this.listenersMap.get(e)}once(e,r,o){this.listeners(e).push(async(...n)=>{let a=await r(...n);return i.dispose(),a});let i=ao.Disposable.create(()=>this.off(e,r));return o&&o.push(i),i}on(e,r,o){this.listeners(e).push(r);let i=ao.Disposable.create(()=>this.off(e,r));return o&&o.push(i),i}off(e,r){typeof r.cancel=="function"&&r.cancel();let o=this.listeners(e),i=o.indexOf(r);i!==-1&&o.splice(i,1)}async fire(e,...r){if(this.concurrent)await Promise.all(this.listeners(e).map(async o=>{try{await o(...r)}catch(i){this.helperLogger.error(i)}}));else for(let o of this.listeners(e))try{await o(...r)}catch(i){this.helperLogger.error(i)}}},bi=class{constructor(e,r,o={}){var i;this.vimEvents=e,this.helperLogger=r,this.options=o,this.id=no("events.id"),this.augroupName=`CocHelperInternal_${Vu}_${o.name?`${o.name}_`:""}${this.id}`,this.commandName=`coc-helper.internal.didVimEvent_${Vu}_${o.name?`${o.name}_`:""}${this.id}`,this.events=new ht(this.helperLogger,(i=o.concurrent)!==null&&i!==void 0?i:!1)}async register(e){await zu.activate.call(this.augroupName,this.commandName,Object.entries(this.vimEvents).map(([r,o])=>Object.assign({event:r},o))),e.subscriptions.push(ao.Disposable.create(()=>{zu.deactivate.call(this.augroupName).catch(this.helperLogger.error)})),e.subscriptions.push(ao.commands.registerCommand(this.commandName,Re.asyncCatch((r,...o)=>this.events.fire(r,...o)),void 0,!0))}},Us=new bi({BufDelete:{eventExpr:"BufDelete *",argExprs:["+expand('<abuf>')"]},BufWipeout:{eventExpr:"BufWipeout *",argExprs:["+expand('<abuf>')"]}},Re,{name:"coc_helper"}),Yb=Us.events,zu=ue.create("events",t=>{let e=t.fn("activate",({name:o})=>`
      function! ${o}(augroup_name, autocmd_events) abort
        execute 'augroup ' . a:augroup_name
          autocmd!
          for autocmd_event in a:autocmd_events
            execute autocmd_event
          endfor
        augroup END
      endfunction
    `);function r(o,i){return i.map(n=>{var a;let s=`${[`'${o}'`,`'${n.event}'`,...(a=n.argExprs)!==null&&a!==void 0?a:[]].join(", ")}`;return`autocmd ${n.eventExpr} call ${n.async===!1?Nr.runCocCmd.inlineCall(s):Nr.runCocCmdAsync.inlineCall(s)}`})}return{activate:{call:(o,i,n)=>e.call(o,r(i,n)),callNotify:(o,i,n)=>e.callNotify(o,r(i,n)),callNotifier:(o,i,n)=>e.callNotifier(o,r(i,n))},deactivate:t.fn("deactivate",({name:o})=>`
        function! ${o}(augroup_name) abort
          execute 'augroup ' . a:augroup_name
            autocmd!
          augroup END
        endfunction
      `),doAutocmd:t.fn("do_autocmd",({name:o})=>`
        function! ${o}(name) abort
          if exists('#User#'.a:name)
            exe 'doautocmd <nomodeline> User '.a:name
          endif
        endfunction
      `)}});var Le=require("coc.nvim");var Ku=require("coc.nvim");var Yu=require("coc.nvim"),qs=ue.create("buf",t=>{let e=Yu.workspace.isNvim,r=t.fn("create_by_name",({name:o})=>`
      function! ${o}(name) abort
        return bufadd(a:name)
      endfunction
    `);return{createByName:r,create:t.fn("create",({name:o})=>e?`
          function! ${o}(...) abort
            let name = get(a:000, 0, '')
            if name is ''
              return nvim_create_buf(v:false, v:true)
            else
              return ${r.inlineCall("name")}
            endif
          endfunction
        `:`
          function! ${o}(...) abort
            let name = get(a:000, 0, '')
            return ${r.inlineCall("name")}
          endfunction
        `)}});var ot=ue.create("float",t=>{let e=Ku.workspace.isNvim,r=t.fn("init_execute",({name:i})=>`
      function! ${i}(ctx, inited_execute) abort
        execute a:inited_execute
      endfunction
    `),o=t.fn("open_win",({name:i})=>e?`
        function! ${i}(bufnr, focus, win_config, win_hl, inited_execute) abort
          noau let winid = nvim_open_win(a:bufnr, a:focus, a:win_config)
          if !empty(a:win_hl)
            call nvim_win_set_option(winid, 'winhl', a:win_hl)
          endif
          if !empty(a:inited_execute)
            call ${r.inlineCall("{'bufnr': a:bufnr, 'winid': winid}, a:inited_execute")}
          endif
          return winid
        endfunction
      `:`
        function! ${i}(bufnr, focus, win_config, win_hl, inited_execute) abort
          let winid = popup_create(a:bufnr, a:win_config)
          call ${r.inlineCall("{'bufnr': a:bufnr, 'winid': winid}, a:inited_execute")}

          return winid
        endfunction
      `);return{create:t.fn("create",({name:i})=>e?`
            function! ${i}(name, inited_execute, has_border_buf, border_inited_execute) abort
              let bufnr = ${qs.create.inlineCall("a:name")}
              call ${r.inlineCall("{'bufnr': bufnr}, a:inited_execute")}

              let border_bufnr = v:null
              if a:has_border_buf
                let border_bufnr = nvim_create_buf(v:false, v:true)
                call ${r.inlineCall("{'bufnr': border_bufnr}, a:border_inited_execute")}
              endif
              return [bufnr, border_bufnr]
            endfunction
          `:`
            function! ${i}(name, inited_execute, has_border_buf, border_inited_execute) abort
              let bufnr = ${qs.create.inlineCall("a:name")}
              call ${r.inlineCall("{'bufnr': bufnr}, a:inited_execute")}
              return [bufnr, v:null]
            endfunction
          `),open:t.fn("open",({name:i})=>`
        function! ${i}(bufnr, win_config, inited_execute, border_bufnr, border_win_config, border_inited_execute, focus, win_hl) abort
          let winid = ${o.inlineCall("a:bufnr, a:focus, a:win_config, a:win_hl, a:inited_execute")}
          call setbufvar(a:bufnr, 'coc_helper_winid', winid)

          if a:border_bufnr
            let border_winid = ${o.inlineCall("a:border_bufnr, v:false, a:border_win_config, a:win_hl, a:border_inited_execute")}
            call setbufvar(a:bufnr, 'coc_helper_border_winid', border_winid)
          endif
        endfunction
      `),resume:t.fn("resume",({name:i})=>`
        function! ${i}(bufnr, win_config, border_bufnr, border_win_config, focus, win_hl) abort
          let winid = ${o.inlineCall("a:bufnr, a:focus, a:win_config, a:win_hl, ''")}
          call setbufvar(a:bufnr, 'coc_helper_winid', winid)

          if a:border_bufnr
            let border_winid = ${o.inlineCall("border_bufnr, v:false, a:border_win_config, a:win_hl, ''")}
            call setbufvar(a:bufnr, 'coc_helper_border_winid', border_winid)
          endif
        endfunction
      `),update:t.fn("update",({name:i})=>e?`
          function! ${i}(bufnr, win_config, border_bufnr, border_win_config, win_hl) abort
            let winid = getbufvar(a:bufnr, 'coc_helper_winid', v:null)
            if !winid
              return
            endif
            call nvim_win_set_config(winid, a:win_config)
            if !empty(a:win_hl)
              call nvim_win_set_option(winid, 'winhl', a:win_hl)
            endif
            if has('nvim')
              redraw!
            endif

            if a:border_bufnr
              let border_winid = getbufvar(a:bufnr, 'coc_helper_border_winid', v:null)
              if border_winid
                call nvim_win_set_config(border_winid, a:border_win_config)
                if !empty(a:win_hl)
                  call nvim_win_set_option(border_winid, 'winhl', a:win_hl)
                endif
                if has('nvim')
                  redraw!
                endif
              endif
            endif
          endfunction
        `:`
          function! ${i}(bufnr, win_config, border_bufnr, border_win_config, win_hl) abort
            let winid = getbufvar(a:bufnr, 'coc_helper_winid', v:null)
            if !winid
              return
            endif
            call popup_setoptions(winid, a:win_config)
          endfunction
        `),winid:t.fn("winid",({name:i})=>`
        function! ${i}(bufnr) abort
          let id = getbufvar(a:bufnr, 'coc_helper_winid', v:null)
          let nr = win_id2win(id)
          return nr is 0 ? v:null : id
        endfunction
      `),borderWinid:t.fn("border_winid",({name:i})=>`
        function! ${i}(bufnr) abort
          return getbufvar(a:bufnr, 'coc_helper_border_winid', v:null)
        endfunction
      `),close:t.fn("close",({name:i})=>e?`
            function! ${i}(bufnr) abort
              let winid = getbufvar(a:bufnr, 'coc_helper_winid', v:null)
              let border_winid = getbufvar(a:bufnr, 'coc_helper_border_winid', v:null)
              try
                if winid
                  call nvim_win_close(winid, v:true)
                endif
                if border_winid
                  call nvim_win_close(border_winid, v:true)
                endif
              catch
              endtry
            endfunction
          `:`
            function! ${i}(bufnr) abort
              let winid = getbufvar(a:bufnr, 'coc_helper_winid', v:null)
              try
                if winid
                  call popup_close(winid)
                endif
              catch
              endtry
            endfunction
          `)}});var _t=require("coc.nvim");var Xu=["\u2500","\u2502","\u2500","\u2502","\u250C","\u2510","\u2518","\u2514"],Qu="CocHelperNormalFloat",Kb="CocHelperNormalFloatNC",Ju="CocHelperNormalFloatBorder",yi=class{constructor(e){this.srcId=e}async createContext(e){var r,o;return(r=e.context)!==null&&r!==void 0?r:{lines:_t.workspace.env.lines,columns:_t.workspace.env.columns-_t.workspace.env.cmdheight-1,globalCursorPosition:await Nr.globalCursorPosition.call(),title:e.title?{text:e.title,width:await ju(e.title)}:{text:"",width:0},borderEnabled:!!e.border,border:this.extendEdges((o=e.border)===null||o===void 0?void 0:o.map(i=>typeof i=="boolean"?1:i)),paddingEnabled:!!e.padding,padding:this.extendEdges(e.padding)}}getCenterPos(e,r){let[,,o,i]=r,n=Math.floor((e.lines-i)/2),a=Math.floor((e.columns-o)/2);return[n,a]}getPosForAround(e,r,o,i=!1){let n=e.columns,a=e.lines-1,[s,l]=r,[c,u]=o;return i?c-l<0?c+=1:c-=l:c+l>=a?c-=l:c+=1,u+s>=n&&(u-=s-1),[c,u]}extendEdges(e){var r,o,i,n;if(!e)return[0,0,0,0];let a=(r=e[0])!==null&&r!==void 0?r:1,s=(o=e[1])!==null&&o!==void 0?o:a,l=(i=e[2])!==null&&i!==void 0?i:a,c=(n=e[3])!==null&&n!==void 0?n:s;return[a,s,l,c]}changeBoxByEdgesList(e,r){let o=[...e];for(let i of r)o=this.changeBoxByEdges(o,i);return o}changeBoxByEdges(e,r){if(!r)return e;let[o,i,n,a]=r,[s,l,c,u]=e;return s-=o,l-=a,c+=a+i,u+=o+n,[s,l,c,u]}getBoxSizes(e,r,o){var i,n;let[a,s]=[(i=r.top)!==null&&i!==void 0?i:0,(n=r.left)!==null&&n!==void 0?n:0],l=Math.max(r.width,e.title.width),c=[0,0,l,r.height],u=this.changeBoxByEdges(c,e.padding),f=this.changeBoxByEdges(u,e.border),d;if(r.relative==="center")d=this.getCenterPos(e,f);else{let p=!o&&this.storeCursorPosition?this.storeCursorPosition:e.globalCursorPosition;r.relative==="cursor"?d=p:r.relative==="cursor-around"?d=this.getPosForAround(e,[f[2],f[3]],p):d=[a,s],this.storeCursorPosition=p}return[f[0],f[1]]=[d[0],d[1]],[u[0],u[1]]=[f[0]+e.border[0],f[1]+e.border[3]],[c[0],c[1]]=[u[0]+e.padding[0],u[1]+e.padding[3]],{contentBox:c,paddingBox:u,borderBox:f}}vimWinConfig(e,r,o){var i,n,a,s,l,c,u,f;let[d,p,m,h]=[(i=r.top)!==null&&i!==void 0?i:0,(n=r.left)!==null&&n!==void 0?n:0,r.width,r.height],g={line:0,col:0,zindex:(a=r.borderOnly)!==null&&a!==void 0&&a?1:100,minwidth:m,minheight:h,maxwidth:m,maxheight:h};if(r.relative==="center")g.pos="center";else{let S=!o&&this.storeCursorPosition?this.storeCursorPosition:e.globalCursorPosition;if(r.relative==="cursor")[g.line,g.col]=S;else if(r.relative==="cursor-around"){let I=this.changeBoxByEdgesList([d,p,m,h],[e.padding,e.border]);[g.line,g.col]=this.getPosForAround(e,[I[2],I[3]],S)}else[g.line,g.col]=[d,p];this.storeCursorPosition=S,g.line+=1,g.col+=1}let x=(s=r.topOffset)!==null&&s!==void 0?s:0,b=(l=r.leftOffset)!==null&&l!==void 0?l:0;return g.line+=x,g.col+=b,r.maxWidth&&(g.maxwidth=r.maxWidth),r.maxHeight&&(g.maxheight=r.maxHeight),g.highlight=(c=r.winHl)!==null&&c!==void 0?c:Qu,r.padding&&(g.padding=r.padding),e.borderEnabled&&(g.border=e.border,g.border[0]&&(e.title.width&&(g.title=e.title.text),g.close="button"),g.borderchars=(u=r.borderChars)!==null&&u!==void 0?u:Xu,g.borderhighlight=[(f=r.borderWinHl)!==null&&f!==void 0?f:Ju]),g}nvimWinConfig(e,r,o){var i,n,a;let{contentBox:s,borderBox:l}=this.getBoxSizes(e,r,o),c=(i=r.topOffset)!==null&&i!==void 0?i:0,u=(n=r.leftOffset)!==null&&n!==void 0?n:0,f={relative:"editor",row:s[0]+c,col:s[1]+u,width:s[2],height:s[3],focusable:(a=r.focusable)!==null&&a!==void 0?a:!0},d;return l&&(d={relative:"editor",row:l[0]+c,col:l[1]+u,width:l[2],height:l[3],focusable:!1}),[f,d]}winConfig(e,r,o=!0){return _t.workspace.isVim?[this.vimWinConfig(e,r,o),void 0]:this.nvimWinConfig(e,r,o)}getRenderBorderData(e,r,o){var i,n,a,s,l,c;let u=(n=(i=e.title)===null||i===void 0?void 0:i.text)!==null&&n!==void 0?n:"",f=(s=(a=e.title)===null||a===void 0?void 0:a.width)!==null&&s!==void 0?s:0;if(!e.borderEnabled)return;let[d,p,m,h]=e.border,[g,x,b,S,I,V,pt,qe]=(l=r.borderChars)!==null&&l!==void 0?l:Xu;d||(g=""),p||(x=""),m||(b=""),h||(S=""),(!d||!h)&&(I=""),(!d||!p)&&(V=""),(!m||!h)&&(qe=""),(!m||!p)&&(pt="");let Ae=o[0],Te=o[1],mt=Ae-h-p,oo=Te-d-m,Sr=[];d&&Sr.push(I+u+g.repeat(mt-f)+V),Sr.push(...Array.from({length:oo},()=>S+" ".repeat(mt)+x)),m&&Sr.push(qe+b.repeat(mt)+pt);let Ve=[],Tr=(c=r.borderWinHl)!==null&&c!==void 0?c:Ju;if(Tr){Ve.push({hlGroup:Tr,line:0,colStart:0,colEnd:Ae});for(let At=0,mn=oo;At<mn;At++)h&&Ve.push({hlGroup:Tr,line:At+1,colStart:0,colEnd:h}),p&&Ve.push({hlGroup:Tr,line:At+1,colStart:h+mt,colEnd:Ae});m&&Ve.push({hlGroup:Tr,line:Te-1,colStart:0,colEnd:Ae})}return{lines:Sr,highlights:Ve}}renderBorderNotifier(e,r,o,i){let n=this.getRenderBorderData(r,o,"width"in i?[i.width,i.height]:[i.minwidth,i.minheight]);if(!n)return v.noop();let{lines:a,highlights:s}=n;return v.create(()=>{e.setOption("modifiable",!0,!0),e.setOption("readonly",!1,!0),e.setLines(a,{start:0,end:-1},!0),e.setOption("modifiable",!1,!0),e.setOption("readonly",!0,!0),this.addHighlightsNotify(e,s)})}nvimWinHl(e){var r,o;if(_t.workspace.isVim)return"";let i=[];return i.push(`Normal:${(r=e.winHl)!==null&&r!==void 0?r:Qu}`),i.push(`NormalNC:${(o=e.winHlNC)!==null&&o!==void 0?o:Kb}`),i.join(",")}addHighlightsNotify(e,r){for(let o of r)!o.hlGroup||o.line===void 0||o.colStart===void 0||o.colEnd===void 0||e.highlightRanges(this.srcId,o.hlGroup,[_t.Range.create(o.line,o.colStart,o.line,o.colEnd)])}};var z=class{constructor(e,r,o,i,n){this.bufnr=e,this.borderBufnr=r,this.createOptions=o,this.mode=i,this.util=n,this.nvim=Le.workspace.nvim,this.disposables=[],this.nvim=Le.workspace.nvim,this.buffer=this.nvim.createBuffer(e),r&&(this.borderBuffer=Le.workspace.nvim.createBuffer(r),this.disposables.push(Le.events.on("BufWinLeave",Re.asyncCatch(async a=>{this.borderBufnr&&a===this.bufnr&&await Nr.closeWinByBufnr.call([this.borderBufnr])}))))}static getInitedExecute(e,r){var o,i,n,a;let s=(i=(o=r.initedExecute)===null||o===void 0?void 0:o.call(r,z.initedContextVars.create))!==null&&i!==void 0?i:"";s=`${z.modePresets[e].createInitedExecute(z.initedContextVars.create)}
${s}`;let l=(a=(n=r.borderInitedExecute)===null||n===void 0?void 0:n.call(r,z.initedContextVars.create))!==null&&a!==void 0?a:z.modePresets.show.createInitedExecute(z.initedContextVars.create);return[s,l]}static async create(e={}){var r,o,i;let n=(r=e.mode)!==null&&r!==void 0?r:"default",[a,s]=this.getInitedExecute(n,e),[l,c]=await ot.create.call((o=e.name)!==null&&o!==void 0?o:"",a,(i=e.hasBorderBuf)!==null&&i!==void 0?i:!0,s),u=new yi(this.srcId);return new z(l,c!=null?c:void 0,e,n,u)}getInitedExecute(e){var r,o,i,n;let a=(o=(r=e.initedExecute)===null||r===void 0?void 0:r.call(e,z.initedContextVars.open))!==null&&o!==void 0?o:"";a=`${z.modePresets[this.mode].openInitedExecute(z.initedContextVars.open)}
${a}`;let s=(n=(i=e.borderInitedExecute)===null||i===void 0?void 0:i.call(e,z.initedContextVars.open))!==null&&n!==void 0?n:z.modePresets.show.openInitedExecute(z.initedContextVars.open);return[a,s]}getFocus(e){var r,o;return(o=(r=e.focus)!==null&&r!==void 0?r:this.mode?z.modePresets[this.mode].focus:void 0)!==null&&o!==void 0?o:!1}getModifiable(e){var r,o;return(o=(r=e.modifiable)!==null&&r!==void 0?r:this.mode?z.modePresets[this.mode].modifiable:void 0)!==null&&o!==void 0?o:!1}setLinesNotifier(e){return v.create(()=>{if(!e.lines&&!e.modifiable)return;let r=this.getModifiable(e);if(this.buffer.setOption("modifiable",!0,!0),this.buffer.setOption("readonly",!1,!0),e.lines&&this.buffer.setLines(e.lines,{start:0,end:-1},!0),r||(this.buffer.setOption("modifiable",!1,!0),this.buffer.setOption("readonly",!0,!0)),e.highlights)for(let o of e.highlights)this.util.addHighlightsNotify(this.buffer,[o]);Le.workspace.isVim&&this.nvim.command("redraw!",!0)})}async setLines(e){await this.setLinesNotifier(e).run()}async opened(){return!!await this.win()}async openNotifier(e){var r;if(e.width<=0||e.height<=0)return v.noop();let o=[];o.push(this.closeNotifier());let i=await this.util.createContext(e),[n,a]=this.getInitedExecute(e),[s,l]=this.util.winConfig(i,e);return e.borderOnly&&l?(o.push(ot.open.callNotifier(this.bufnr,l,a,null,null,"",!1,this.util.nvimWinHl(e))),o.push(this.util.renderBorderNotifier(this.buffer,i,e,l))):o.push(ot.open.callNotifier(this.bufnr,s,n,(r=this.borderBufnr)!==null&&r!==void 0?r:null,l!=null?l:null,a,this.getFocus(e),this.util.nvimWinHl(e))),Le.workspace.isNvim&&this.borderBuffer&&l&&o.push(this.util.renderBorderNotifier(this.borderBuffer,i,e,l)),o.push(this.setLinesNotifier(e),v.create(()=>{e.filetype&&this.buffer.setOption("filetype",e.filetype,!0)})),v.combine(o)}async open(e){await(await this.openNotifier(e)).run()}async resumeNotifier(e){let r=await this.util.createContext(e),[o,i]=this.util.winConfig(r,e);return v.create(()=>{var n;ot.resume.callNotify(this.bufnr,o,(n=this.borderBufnr)!==null&&n!==void 0?n:null,i!=null?i:null,this.getFocus(e),this.util.nvimWinHl(e)),this.borderBuffer&&i&&this.util.renderBorderNotifier(this.borderBuffer,r,e,i).notify(),Le.workspace.isVim&&this.nvim.command("redraw!",!0)})}async resume(e){await(await this.resumeNotifier(e)).run()}async resizeNotifier(e){var r;let o=await this.util.createContext(e),[i,n]=this.util.winConfig(o,e,!1),a=[];return e.borderOnly&&n?(a.push(ot.update.callNotifier(this.bufnr,n,null,null,this.util.nvimWinHl(e))),a.push(this.util.renderBorderNotifier(this.buffer,o,e,n))):a.push(ot.update.callNotifier(this.bufnr,i,(r=this.borderBufnr)!==null&&r!==void 0?r:null,n!=null?n:null,this.util.nvimWinHl(e))),Le.workspace.isNvim&&this.borderBuffer&&n&&a.push(this.util.renderBorderNotifier(this.borderBuffer,o,e,n)),a.push(v.create(()=>{Le.workspace.isVim&&this.nvim.command("redraw!",!0)})),v.combine(a)}async resize(e){await(await this.resizeNotifier(e)).run()}async win(){let e=await ot.winid.call(this.bufnr);return e?this.nvim.createWindow(e):void 0}async borderWin(){let e=await ot.winid.call(this.bufnr);return e?this.nvim.createWindow(e):void 0}closeNotifier(){return ot.close.callNotifier(this.bufnr)}async close(){await this.closeNotifier().run()}dispose(){(0,Le.disposeAll)(this.disposables),this.disposables.forEach(e=>e.dispose())}};z.modePresets={default:{modifiable:!1,focus:!1,createInitedExecute:()=>"",openInitedExecute:()=>""},base:{createInitedExecute:t=>`
        call setbufvar(${t.bufnr}, '&buftype', 'nofile')
        call setbufvar(${t.bufnr}, '&bufhidden', 'hide')
        call setbufvar(${t.bufnr}, '&buflisted', 0)

        call setbufvar(${t.bufnr}, '&wrap', 1)

        call setbufvar(${t.bufnr}, '&swapfile', 0)

        call setbufvar(${t.bufnr}, '&modeline', 0)
      `,openInitedExecute:t=>`
        call setbufvar(${t.bufnr}, '&list', 0)

        call setbufvar(${t.bufnr}, '&listchars', '')
        if has('nvim')
          call setbufvar(${t.bufnr}, '&fillchars', 'eob: ')
        endif

        call setbufvar(${t.bufnr}, '&signcolumn', 'no')
        call setbufvar(${t.bufnr}, '&number', 0)
        call setbufvar(${t.bufnr}, '&relativenumber', 0)
        call setbufvar(${t.bufnr}, '&foldenable', 0)
        call setbufvar(${t.bufnr}, '&foldcolumn', 0)

        call setbufvar(${t.bufnr}, '&spell', 0)

        call setbufvar(${t.bufnr}, '&cursorcolumn', 0)
        call setbufvar(${t.bufnr}, '&cursorline', 0)
        call setbufvar(${t.bufnr}, '&colorcolumn', '')
      `},show:{modifiable:!1,createInitedExecute:t=>`
        ${z.modePresets.base.createInitedExecute(t)}
        " call setbufvar(${t.bufnr}, '&undofile', 0)
        " call setbufvar(${t.bufnr}, '&undolevels', -1)

        call setbufvar(${t.bufnr}, '&modifiable', 0)
        call setbufvar(${t.bufnr}, '&modified', 0)
        call setbufvar(${t.bufnr}, '&readonly', 1)
      `,openInitedExecute:t=>`
        ${z.modePresets.base.openInitedExecute(t)}
      `}};z.initedContextVars={create:{bufnr:"a:ctx.bufnr"},open:{bufnr:"a:ctx.bufnr",winid:"a:ctx.winid"}};z.srcId="coc-helper-floatwin";var gn=require("coc.nvim");var Zu=require("coc.nvim"),vi=class{constructor(e){this.root=e}static convertVimLayoutNode(e,r){if(e[0]==="leaf")return{type:e[0],winid:e[1],parent:r};{let o={type:e[0],children:[]};return o.children=e[1].map((i,n)=>this.convertVimLayoutNode(i,{group:o,indexInParent:n})),o}}static async create(){let e=await Zu.workspace.nvim.call("winlayout",[]);return new this(this.convertVimLayoutNode(e))}static getFirstLeafWinid(e){return e.type==="leaf"?e.winid:this.getFirstLeafWinid(e.children[0])}findWinid(e,r=this.root){if(r.type==="leaf"){if(r.winid===e)return r}else for(let o of r.children){let i=this.findWinid(e,o);if(i)return i}}findClosest(e,r){let o=new Set([e]),i=[e];for(;i.length;){let n=i.shift();if(n.type==="leaf"){if(r.includes(n.winid))return n}else for(let a of n.children)if(!o.has(a)){i.push(a),o.add(a);continue}n.parent&&!o.has(n.parent.group)&&(i.push(n.parent.group),o.add(n.parent.group))}}};async function ef(t,e={}){var r,o,i;(!((o=(r=e.vimModule)!==null&&r!==void 0?r:e.events)!==null&&o!==void 0)||o)&&await ue.init(t),(!((i=e.events)!==null&&i!==void 0)||i)&&await Us.register(t);try{await so.workspace.nvim.command("hi default link CocHelperNormalFloatNC CocHelperNormalFloat")}catch(n){so.window.showMessage(n.toString(),"error")}}var Er=require("coc.nvim");var Mt;(e=>{function t(r){return Object.entries(r).map(([o,i])=>{let n=async()=>o.split(/:/);return typeof i=="string"?{description:i,args:o,actionArgs:n}:Object.assign({args:o,actionArgs:n},i)})}e.getNormalizeMenus=t})(Mt||(Mt={}));var cc=require("coc.nvim");function tf(t){return Buffer.byteLength(t)}function rf(t,e,r=2){let o=[],i=t,n=t.indexOf(e);for(;n!==-1&&r>1;)o.push(i.slice(0,n)),i=i.slice(n+1),n=i.indexOf(e),r-=1;return o.push(i),o}function of(t){return/^[\x00-\xFF]*$/.test(t)}var Xb={0:"\u2080",1:"\u2081",2:"\u2082",3:"\u2083",4:"\u2084",5:"\u2085",6:"\u2086",7:"\u2087",8:"\u2088",9:"\u2089"};function nf(t){return t.toString().split("").map(e=>{var r;return(r=Xb[e])!=null?r:e}).join("")}var Qb=typeof global=="object"&&global&&global.Object===Object&&global,wn=Qb;var Jb=typeof self=="object"&&self&&self.Object===Object&&self,Zb=wn||Jb||Function("return this")(),ae=Zb;var ey=ae.Symbol,we=ey;var af=Object.prototype,ty=af.hasOwnProperty,ry=af.toString,Ei=we?we.toStringTag:void 0;function oy(t){var e=ty.call(t,Ei),r=t[Ei];try{t[Ei]=void 0;var o=!0}catch{}var i=ry.call(t);return o&&(e?t[Ei]=r:delete t[Ei]),i}var sf=oy;var iy=Object.prototype,ny=iy.toString;function ay(t){return ny.call(t)}var lf=ay;var sy="[object Null]",ly="[object Undefined]",cf=we?we.toStringTag:void 0;function cy(t){return t==null?t===void 0?ly:sy:cf&&cf in Object(t)?sf(t):lf(t)}var ze=cy;function uy(t){return t!=null&&typeof t=="object"}var Ne=uy;var fy="[object Symbol]";function dy(t){return typeof t=="symbol"||Ne(t)&&ze(t)==fy}var it=dy;function py(t,e){for(var r=-1,o=t==null?0:t.length,i=Array(o);++r<o;)i[r]=e(t[r],r,t);return i}var uf=py;var my=Array.isArray,te=my;var hy=1/0,ff=we?we.prototype:void 0,df=ff?ff.toString:void 0;function pf(t){if(typeof t=="string")return t;if(te(t))return uf(t,pf)+"";if(it(t))return df?df.call(t):"";var e=t+"";return e=="0"&&1/t==-hy?"-0":e}var mf=pf;var gy=/\s/;function wy(t){for(var e=t.length;e--&&gy.test(t.charAt(e)););return e}var hf=wy;var xy=/^\s+/;function by(t){return t&&t.slice(0,hf(t)+1).replace(xy,"")}var gf=by;function yy(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}var Ce=yy;var wf=0/0,vy=/^[-+]0x[0-9a-f]+$/i,Ey=/^0b[01]+$/i,Sy=/^0o[0-7]+$/i,Ty=parseInt;function Ny(t){if(typeof t=="number")return t;if(it(t))return wf;if(Ce(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=Ce(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=gf(t);var r=Ey.test(t);return r||Sy.test(t)?Ty(t.slice(2),r?2:8):vy.test(t)?wf:+t}var xf=Ny;var bf=1/0,Cy=17976931348623157e292;function Iy(t){if(!t)return t===0?t:0;if(t=xf(t),t===bf||t===-bf){var e=t<0?-1:1;return e*Cy}return t===t?t:0}var yf=Iy;function Oy(t){var e=yf(t),r=e%1;return e===e?r?e-r:e:0}var xn=Oy;function Py(t){return t}var kt=Py;var Ay="[object AsyncFunction]",_y="[object Function]",My="[object GeneratorFunction]",ky="[object Proxy]";function Ry(t){if(!Ce(t))return!1;var e=ze(t);return e==_y||e==My||e==Ay||e==ky}var bn=Ry;var Ly=ae["__core-js_shared__"],yn=Ly;var vf=function(){var t=/[^.]+$/.exec(yn&&yn.keys&&yn.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function Dy(t){return!!vf&&vf in t}var Ef=Dy;var By=Function.prototype,Wy=By.toString;function Fy(t){if(t!=null){try{return Wy.call(t)}catch{}try{return t+""}catch{}}return""}var gt=Fy;var jy=/[\\^$.*+?()[\]{}|]/g,Hy=/^\[object .+?Constructor\]$/,$y=Function.prototype,Gy=Object.prototype,Uy=$y.toString,qy=Gy.hasOwnProperty,Vy=RegExp("^"+Uy.call(qy).replace(jy,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function zy(t){if(!Ce(t)||Ef(t))return!1;var e=bn(t)?Vy:Hy;return e.test(gt(t))}var Sf=zy;function Yy(t,e){return t==null?void 0:t[e]}var Tf=Yy;function Ky(t,e){var r=Tf(t,e);return Sf(r)?r:void 0}var _e=Ky;var Xy=_e(ae,"WeakMap"),vn=Xy;var Nf=Object.create,Qy=function(){function t(){}return function(e){if(!Ce(e))return{};if(Nf)return Nf(e);t.prototype=e;var r=new t;return t.prototype=void 0,r}}(),Cf=Qy;function Jy(){}var If=Jy;function Zy(t,e){var r=-1,o=t.length;for(e||(e=Array(o));++r<o;)e[r]=t[r];return e}var Of=Zy;var ev=function(){try{var t=_e(Object,"defineProperty");return t({},"",{}),t}catch{}}(),Vs=ev;function tv(t,e){for(var r=-1,o=t==null?0:t.length;++r<o&&e(t[r],r,t)!==!1;);return t}var Pf=tv;function rv(t,e,r,o){for(var i=t.length,n=r+(o?1:-1);o?n--:++n<i;)if(e(t[n],n,t))return n;return-1}var lo=rv;function ov(t){return t!==t}var Af=ov;function iv(t,e,r){for(var o=r-1,i=t.length;++o<i;)if(t[o]===e)return o;return-1}var _f=iv;function nv(t,e,r){return e===e?_f(t,e,r):lo(t,Af,r)}var Mf=nv;function av(t,e){var r=t==null?0:t.length;return!!r&&Mf(t,e,0)>-1}var kf=av;var sv=9007199254740991,lv=/^(?:0|[1-9]\d*)$/;function cv(t,e){var r=typeof t;return e=e==null?sv:e,!!e&&(r=="number"||r!="symbol"&&lv.test(t))&&t>-1&&t%1==0&&t<e}var En=cv;function uv(t,e,r){e=="__proto__"&&Vs?Vs(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r}var Rt=uv;function fv(t,e){return t===e||t!==t&&e!==e}var co=fv;var dv=Object.prototype,pv=dv.hasOwnProperty;function mv(t,e,r){var o=t[e];(!(pv.call(t,e)&&co(o,r))||r===void 0&&!(e in t))&&Rt(t,e,r)}var Sn=mv;function hv(t,e,r,o){var i=!r;r||(r={});for(var n=-1,a=e.length;++n<a;){var s=e[n],l=o?o(r[s],t[s],s,r,t):void 0;l===void 0&&(l=t[s]),i?Rt(r,s,l):Sn(r,s,l)}return r}var Lt=hv;var gv=9007199254740991;function wv(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=gv}var uo=wv;function xv(t){return t!=null&&uo(t.length)&&!bn(t)}var fo=xv;var bv=Object.prototype;function yv(t){var e=t&&t.constructor,r=typeof e=="function"&&e.prototype||bv;return t===r}var po=yv;function vv(t,e){for(var r=-1,o=Array(t);++r<t;)o[r]=e(r);return o}var Rf=vv;var Ev="[object Arguments]";function Sv(t){return Ne(t)&&ze(t)==Ev}var zs=Sv;var Lf=Object.prototype,Tv=Lf.hasOwnProperty,Nv=Lf.propertyIsEnumerable,Cv=zs(function(){return arguments}())?zs:function(t){return Ne(t)&&Tv.call(t,"callee")&&!Nv.call(t,"callee")},mo=Cv;function Iv(){return!1}var Df=Iv;var Ff=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Bf=Ff&&typeof module=="object"&&module&&!module.nodeType&&module,Ov=Bf&&Bf.exports===Ff,Wf=Ov?ae.Buffer:void 0,Pv=Wf?Wf.isBuffer:void 0,Av=Pv||Df,Cr=Av;var _v="[object Arguments]",Mv="[object Array]",kv="[object Boolean]",Rv="[object Date]",Lv="[object Error]",Dv="[object Function]",Bv="[object Map]",Wv="[object Number]",Fv="[object Object]",jv="[object RegExp]",Hv="[object Set]",$v="[object String]",Gv="[object WeakMap]",Uv="[object ArrayBuffer]",qv="[object DataView]",Vv="[object Float32Array]",zv="[object Float64Array]",Yv="[object Int8Array]",Kv="[object Int16Array]",Xv="[object Int32Array]",Qv="[object Uint8Array]",Jv="[object Uint8ClampedArray]",Zv="[object Uint16Array]",e0="[object Uint32Array]",Z={};Z[Vv]=Z[zv]=Z[Yv]=Z[Kv]=Z[Xv]=Z[Qv]=Z[Jv]=Z[Zv]=Z[e0]=!0;Z[_v]=Z[Mv]=Z[Uv]=Z[kv]=Z[qv]=Z[Rv]=Z[Lv]=Z[Dv]=Z[Bv]=Z[Wv]=Z[Fv]=Z[jv]=Z[Hv]=Z[$v]=Z[Gv]=!1;function t0(t){return Ne(t)&&uo(t.length)&&!!Z[ze(t)]}var jf=t0;function r0(t){return function(e){return t(e)}}var ho=r0;var Hf=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Si=Hf&&typeof module=="object"&&module&&!module.nodeType&&module,o0=Si&&Si.exports===Hf,Ys=o0&&wn.process,i0=function(){try{var t=Si&&Si.require&&Si.require("util").types;return t||Ys&&Ys.binding&&Ys.binding("util")}catch{}}(),wt=i0;var $f=wt&&wt.isTypedArray,n0=$f?ho($f):jf,Tn=n0;var a0=Object.prototype,s0=a0.hasOwnProperty;function l0(t,e){var r=te(t),o=!r&&mo(t),i=!r&&!o&&Cr(t),n=!r&&!o&&!i&&Tn(t),a=r||o||i||n,s=a?Rf(t.length,String):[],l=s.length;for(var c in t)(e||s0.call(t,c))&&!(a&&(c=="length"||i&&(c=="offset"||c=="parent")||n&&(c=="buffer"||c=="byteLength"||c=="byteOffset")||En(c,l)))&&s.push(c);return s}var Nn=l0;function c0(t,e){return function(r){return t(e(r))}}var Cn=c0;var u0=Cn(Object.keys,Object),Gf=u0;var f0=Object.prototype,d0=f0.hasOwnProperty;function p0(t){if(!po(t))return Gf(t);var e=[];for(var r in Object(t))d0.call(t,r)&&r!="constructor"&&e.push(r);return e}var Uf=p0;function m0(t){return fo(t)?Nn(t):Uf(t)}var nt=m0;function h0(t){var e=[];if(t!=null)for(var r in Object(t))e.push(r);return e}var qf=h0;var g0=Object.prototype,w0=g0.hasOwnProperty;function x0(t){if(!Ce(t))return qf(t);var e=po(t),r=[];for(var o in t)o=="constructor"&&(e||!w0.call(t,o))||r.push(o);return r}var Vf=x0;function b0(t){return fo(t)?Nn(t,!0):Vf(t)}var go=b0;var y0=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,v0=/^\w*$/;function E0(t,e){if(te(t))return!1;var r=typeof t;return r=="number"||r=="symbol"||r=="boolean"||t==null||it(t)?!0:v0.test(t)||!y0.test(t)||e!=null&&t in Object(e)}var wo=E0;var S0=_e(Object,"create"),xt=S0;function T0(){this.__data__=xt?xt(null):{},this.size=0}var zf=T0;function N0(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}var Yf=N0;var C0="__lodash_hash_undefined__",I0=Object.prototype,O0=I0.hasOwnProperty;function P0(t){var e=this.__data__;if(xt){var r=e[t];return r===C0?void 0:r}return O0.call(e,t)?e[t]:void 0}var Kf=P0;var A0=Object.prototype,_0=A0.hasOwnProperty;function M0(t){var e=this.__data__;return xt?e[t]!==void 0:_0.call(e,t)}var Xf=M0;var k0="__lodash_hash_undefined__";function R0(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=xt&&e===void 0?k0:e,this}var Qf=R0;function xo(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var o=t[e];this.set(o[0],o[1])}}xo.prototype.clear=zf;xo.prototype.delete=Yf;xo.prototype.get=Kf;xo.prototype.has=Xf;xo.prototype.set=Qf;var Ks=xo;function L0(){this.__data__=[],this.size=0}var Jf=L0;function D0(t,e){for(var r=t.length;r--;)if(co(t[r][0],e))return r;return-1}var Dt=D0;var B0=Array.prototype,W0=B0.splice;function F0(t){var e=this.__data__,r=Dt(e,t);if(r<0)return!1;var o=e.length-1;return r==o?e.pop():W0.call(e,r,1),--this.size,!0}var Zf=F0;function j0(t){var e=this.__data__,r=Dt(e,t);return r<0?void 0:e[r][1]}var ed=j0;function H0(t){return Dt(this.__data__,t)>-1}var td=H0;function $0(t,e){var r=this.__data__,o=Dt(r,t);return o<0?(++this.size,r.push([t,e])):r[o][1]=e,this}var rd=$0;function bo(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var o=t[e];this.set(o[0],o[1])}}bo.prototype.clear=Jf;bo.prototype.delete=Zf;bo.prototype.get=ed;bo.prototype.has=td;bo.prototype.set=rd;var Bt=bo;var G0=_e(ae,"Map"),Wt=G0;function U0(){this.size=0,this.__data__={hash:new Ks,map:new(Wt||Bt),string:new Ks}}var od=U0;function q0(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}var id=q0;function V0(t,e){var r=t.__data__;return id(e)?r[typeof e=="string"?"string":"hash"]:r.map}var Ft=V0;function z0(t){var e=Ft(this,t).delete(t);return this.size-=e?1:0,e}var nd=z0;function Y0(t){return Ft(this,t).get(t)}var ad=Y0;function K0(t){return Ft(this,t).has(t)}var sd=K0;function X0(t,e){var r=Ft(this,t),o=r.size;return r.set(t,e),this.size+=r.size==o?0:1,this}var ld=X0;function yo(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var o=t[e];this.set(o[0],o[1])}}yo.prototype.clear=od;yo.prototype.delete=nd;yo.prototype.get=ad;yo.prototype.has=sd;yo.prototype.set=ld;var Ir=yo;var Q0="Expected a function";function Xs(t,e){if(typeof t!="function"||e!=null&&typeof e!="function")throw new TypeError(Q0);var r=function(){var o=arguments,i=e?e.apply(this,o):o[0],n=r.cache;if(n.has(i))return n.get(i);var a=t.apply(this,o);return r.cache=n.set(i,a)||n,a};return r.cache=new(Xs.Cache||Ir),r}Xs.Cache=Ir;var cd=Xs;var J0=500;function Z0(t){var e=cd(t,function(o){return r.size===J0&&r.clear(),o}),r=e.cache;return e}var ud=Z0;var eE=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,tE=/\\(\\)?/g,rE=ud(function(t){var e=[];return t.charCodeAt(0)===46&&e.push(""),t.replace(eE,function(r,o,i,n){e.push(i?n.replace(tE,"$1"):o||r)}),e}),fd=rE;function oE(t){return t==null?"":mf(t)}var dd=oE;function iE(t,e){return te(t)?t:wo(t,e)?[t]:fd(dd(t))}var In=iE;var nE=1/0;function aE(t){if(typeof t=="string"||it(t))return t;var e=t+"";return e=="0"&&1/t==-nE?"-0":e}var jt=aE;function sE(t,e){e=In(e,t);for(var r=0,o=e.length;t!=null&&r<o;)t=t[jt(e[r++])];return r&&r==o?t:void 0}var On=sE;function lE(t,e,r){var o=t==null?void 0:On(t,e);return o===void 0?r:o}var pd=lE;function cE(t,e){for(var r=-1,o=e.length,i=t.length;++r<o;)t[i+r]=e[r];return t}var vo=cE;var md=we?we.isConcatSpreadable:void 0;function uE(t){return te(t)||mo(t)||!!(md&&t&&t[md])}var hd=uE;function gd(t,e,r,o,i){var n=-1,a=t.length;for(r||(r=hd),i||(i=[]);++n<a;){var s=t[n];e>0&&r(s)?e>1?gd(s,e-1,r,o,i):vo(i,s):o||(i[i.length]=s)}return i}var wd=gd;function fE(t){var e=t==null?0:t.length;return e?wd(t,1):[]}var ye=fE;var dE=Cn(Object.getPrototypeOf,Object),Pn=dE;function pE(){this.__data__=new Bt,this.size=0}var xd=pE;function mE(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r}var bd=mE;function hE(t){return this.__data__.get(t)}var yd=hE;function gE(t){return this.__data__.has(t)}var vd=gE;var wE=200;function xE(t,e){var r=this.__data__;if(r instanceof Bt){var o=r.__data__;if(!Wt||o.length<wE-1)return o.push([t,e]),this.size=++r.size,this;r=this.__data__=new Ir(o)}return r.set(t,e),this.size=r.size,this}var Ed=xE;function Eo(t){var e=this.__data__=new Bt(t);this.size=e.size}Eo.prototype.clear=xd;Eo.prototype.delete=bd;Eo.prototype.get=yd;Eo.prototype.has=vd;Eo.prototype.set=Ed;var Ht=Eo;function bE(t,e){return t&&Lt(e,nt(e),t)}var Sd=bE;function yE(t,e){return t&&Lt(e,go(e),t)}var Td=yE;var Od=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Nd=Od&&typeof module=="object"&&module&&!module.nodeType&&module,vE=Nd&&Nd.exports===Od,Cd=vE?ae.Buffer:void 0,Id=Cd?Cd.allocUnsafe:void 0;function EE(t,e){if(e)return t.slice();var r=t.length,o=Id?Id(r):new t.constructor(r);return t.copy(o),o}var Pd=EE;function SE(t,e){for(var r=-1,o=t==null?0:t.length,i=0,n=[];++r<o;){var a=t[r];e(a,r,t)&&(n[i++]=a)}return n}var Ad=SE;function TE(){return[]}var An=TE;var NE=Object.prototype,CE=NE.propertyIsEnumerable,_d=Object.getOwnPropertySymbols,IE=_d?function(t){return t==null?[]:(t=Object(t),Ad(_d(t),function(e){return CE.call(t,e)}))}:An,So=IE;function OE(t,e){return Lt(t,So(t),e)}var Md=OE;var PE=Object.getOwnPropertySymbols,AE=PE?function(t){for(var e=[];t;)vo(e,So(t)),t=Pn(t);return e}:An,_n=AE;function _E(t,e){return Lt(t,_n(t),e)}var kd=_E;function ME(t,e,r){var o=e(t);return te(t)?o:vo(o,r(t))}var Mn=ME;function kE(t){return Mn(t,nt,So)}var Ti=kE;function RE(t){return Mn(t,go,_n)}var Rd=RE;var LE=_e(ae,"DataView"),kn=LE;var DE=_e(ae,"Promise"),Rn=DE;var BE=_e(ae,"Set"),$t=BE;var Ld="[object Map]",WE="[object Object]",Dd="[object Promise]",Bd="[object Set]",Wd="[object WeakMap]",Fd="[object DataView]",FE=gt(kn),jE=gt(Wt),HE=gt(Rn),$E=gt($t),GE=gt(vn),Or=ze;(kn&&Or(new kn(new ArrayBuffer(1)))!=Fd||Wt&&Or(new Wt)!=Ld||Rn&&Or(Rn.resolve())!=Dd||$t&&Or(new $t)!=Bd||vn&&Or(new vn)!=Wd)&&(Or=function(t){var e=ze(t),r=e==WE?t.constructor:void 0,o=r?gt(r):"";if(o)switch(o){case FE:return Fd;case jE:return Ld;case HE:return Dd;case $E:return Bd;case GE:return Wd}return e});var bt=Or;var UE=Object.prototype,qE=UE.hasOwnProperty;function VE(t){var e=t.length,r=new t.constructor(e);return e&&typeof t[0]=="string"&&qE.call(t,"index")&&(r.index=t.index,r.input=t.input),r}var jd=VE;var zE=ae.Uint8Array,To=zE;function YE(t){var e=new t.constructor(t.byteLength);return new To(e).set(new To(t)),e}var No=YE;function KE(t,e){var r=e?No(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.byteLength)}var Hd=KE;var XE=/\w*$/;function QE(t){var e=new t.constructor(t.source,XE.exec(t));return e.lastIndex=t.lastIndex,e}var $d=QE;var Gd=we?we.prototype:void 0,Ud=Gd?Gd.valueOf:void 0;function JE(t){return Ud?Object(Ud.call(t)):{}}var qd=JE;function ZE(t,e){var r=e?No(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.length)}var Vd=ZE;var eS="[object Boolean]",tS="[object Date]",rS="[object Map]",oS="[object Number]",iS="[object RegExp]",nS="[object Set]",aS="[object String]",sS="[object Symbol]",lS="[object ArrayBuffer]",cS="[object DataView]",uS="[object Float32Array]",fS="[object Float64Array]",dS="[object Int8Array]",pS="[object Int16Array]",mS="[object Int32Array]",hS="[object Uint8Array]",gS="[object Uint8ClampedArray]",wS="[object Uint16Array]",xS="[object Uint32Array]";function bS(t,e,r){var o=t.constructor;switch(e){case lS:return No(t);case eS:case tS:return new o(+t);case cS:return Hd(t,r);case uS:case fS:case dS:case pS:case mS:case hS:case gS:case wS:case xS:return Vd(t,r);case rS:return new o;case oS:case aS:return new o(t);case iS:return $d(t);case nS:return new o;case sS:return qd(t)}}var zd=bS;function yS(t){return typeof t.constructor=="function"&&!po(t)?Cf(Pn(t)):{}}var Yd=yS;var vS="[object Map]";function ES(t){return Ne(t)&&bt(t)==vS}var Kd=ES;var Xd=wt&&wt.isMap,SS=Xd?ho(Xd):Kd,Qd=SS;var TS="[object Set]";function NS(t){return Ne(t)&&bt(t)==TS}var Jd=NS;var Zd=wt&&wt.isSet,CS=Zd?ho(Zd):Jd,ep=CS;var IS=1,OS=2,PS=4,tp="[object Arguments]",AS="[object Array]",_S="[object Boolean]",MS="[object Date]",kS="[object Error]",rp="[object Function]",RS="[object GeneratorFunction]",LS="[object Map]",DS="[object Number]",op="[object Object]",BS="[object RegExp]",WS="[object Set]",FS="[object String]",jS="[object Symbol]",HS="[object WeakMap]",$S="[object ArrayBuffer]",GS="[object DataView]",US="[object Float32Array]",qS="[object Float64Array]",VS="[object Int8Array]",zS="[object Int16Array]",YS="[object Int32Array]",KS="[object Uint8Array]",XS="[object Uint8ClampedArray]",QS="[object Uint16Array]",JS="[object Uint32Array]",Q={};Q[tp]=Q[AS]=Q[$S]=Q[GS]=Q[_S]=Q[MS]=Q[US]=Q[qS]=Q[VS]=Q[zS]=Q[YS]=Q[LS]=Q[DS]=Q[op]=Q[BS]=Q[WS]=Q[FS]=Q[jS]=Q[KS]=Q[XS]=Q[QS]=Q[JS]=!0;Q[kS]=Q[rp]=Q[HS]=!1;function Ln(t,e,r,o,i,n){var a,s=e&IS,l=e&OS,c=e&PS;if(r&&(a=i?r(t,o,i,n):r(t)),a!==void 0)return a;if(!Ce(t))return t;var u=te(t);if(u){if(a=jd(t),!s)return Of(t,a)}else{var f=bt(t),d=f==rp||f==RS;if(Cr(t))return Pd(t,s);if(f==op||f==tp||d&&!i){if(a=l||d?{}:Yd(t),!s)return l?kd(t,Td(a,t)):Md(t,Sd(a,t))}else{if(!Q[f])return i?t:{};a=zd(t,f,s)}}n||(n=new Ht);var p=n.get(t);if(p)return p;n.set(t,a),ep(t)?t.forEach(function(g){a.add(Ln(g,e,r,g,t,n))}):Qd(t)&&t.forEach(function(g,x){a.set(x,Ln(g,e,r,x,t,n))});var m=c?l?Rd:Ti:l?go:nt,h=u?void 0:m(t);return Pf(h||t,function(g,x){h&&(x=g,g=t[x]),Sn(a,x,Ln(g,e,r,x,t,n))}),a}var ip=Ln;var ZS=4;function eT(t){return ip(t,ZS)}var Qs=eT;var tT="__lodash_hash_undefined__";function rT(t){return this.__data__.set(t,tT),this}var np=rT;function oT(t){return this.__data__.has(t)}var ap=oT;function Dn(t){var e=-1,r=t==null?0:t.length;for(this.__data__=new Ir;++e<r;)this.add(t[e])}Dn.prototype.add=Dn.prototype.push=np;Dn.prototype.has=ap;var Bn=Dn;function iT(t,e){for(var r=-1,o=t==null?0:t.length;++r<o;)if(e(t[r],r,t))return!0;return!1}var sp=iT;function nT(t,e){return t.has(e)}var Wn=nT;var aT=1,sT=2;function lT(t,e,r,o,i,n){var a=r&aT,s=t.length,l=e.length;if(s!=l&&!(a&&l>s))return!1;var c=n.get(t),u=n.get(e);if(c&&u)return c==e&&u==t;var f=-1,d=!0,p=r&sT?new Bn:void 0;for(n.set(t,e),n.set(e,t);++f<s;){var m=t[f],h=e[f];if(o)var g=a?o(h,m,f,e,t,n):o(m,h,f,t,e,n);if(g!==void 0){if(g)continue;d=!1;break}if(p){if(!sp(e,function(x,b){if(!Wn(p,b)&&(m===x||i(m,x,r,o,n)))return p.push(b)})){d=!1;break}}else if(!(m===h||i(m,h,r,o,n))){d=!1;break}}return n.delete(t),n.delete(e),d}var Fn=lT;function cT(t){var e=-1,r=Array(t.size);return t.forEach(function(o,i){r[++e]=[i,o]}),r}var lp=cT;function uT(t){var e=-1,r=Array(t.size);return t.forEach(function(o){r[++e]=o}),r}var Co=uT;var fT=1,dT=2,pT="[object Boolean]",mT="[object Date]",hT="[object Error]",gT="[object Map]",wT="[object Number]",xT="[object RegExp]",bT="[object Set]",yT="[object String]",vT="[object Symbol]",ET="[object ArrayBuffer]",ST="[object DataView]",cp=we?we.prototype:void 0,Js=cp?cp.valueOf:void 0;function TT(t,e,r,o,i,n,a){switch(r){case ST:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case ET:return!(t.byteLength!=e.byteLength||!n(new To(t),new To(e)));case pT:case mT:case wT:return co(+t,+e);case hT:return t.name==e.name&&t.message==e.message;case xT:case yT:return t==e+"";case gT:var s=lp;case bT:var l=o&fT;if(s||(s=Co),t.size!=e.size&&!l)return!1;var c=a.get(t);if(c)return c==e;o|=dT,a.set(t,e);var u=Fn(s(t),s(e),o,i,n,a);return a.delete(t),u;case vT:if(Js)return Js.call(t)==Js.call(e)}return!1}var up=TT;var NT=1,CT=Object.prototype,IT=CT.hasOwnProperty;function OT(t,e,r,o,i,n){var a=r&NT,s=Ti(t),l=s.length,c=Ti(e),u=c.length;if(l!=u&&!a)return!1;for(var f=l;f--;){var d=s[f];if(!(a?d in e:IT.call(e,d)))return!1}var p=n.get(t),m=n.get(e);if(p&&m)return p==e&&m==t;var h=!0;n.set(t,e),n.set(e,t);for(var g=a;++f<l;){d=s[f];var x=t[d],b=e[d];if(o)var S=a?o(b,x,d,e,t,n):o(x,b,d,t,e,n);if(!(S===void 0?x===b||i(x,b,r,o,n):S)){h=!1;break}g||(g=d=="constructor")}if(h&&!g){var I=t.constructor,V=e.constructor;I!=V&&"constructor"in t&&"constructor"in e&&!(typeof I=="function"&&I instanceof I&&typeof V=="function"&&V instanceof V)&&(h=!1)}return n.delete(t),n.delete(e),h}var fp=OT;var PT=1,dp="[object Arguments]",pp="[object Array]",jn="[object Object]",AT=Object.prototype,mp=AT.hasOwnProperty;function _T(t,e,r,o,i,n){var a=te(t),s=te(e),l=a?pp:bt(t),c=s?pp:bt(e);l=l==dp?jn:l,c=c==dp?jn:c;var u=l==jn,f=c==jn,d=l==c;if(d&&Cr(t)){if(!Cr(e))return!1;a=!0,u=!1}if(d&&!u)return n||(n=new Ht),a||Tn(t)?Fn(t,e,r,o,i,n):up(t,e,l,r,o,i,n);if(!(r&PT)){var p=u&&mp.call(t,"__wrapped__"),m=f&&mp.call(e,"__wrapped__");if(p||m){var h=p?t.value():t,g=m?e.value():e;return n||(n=new Ht),i(h,g,r,o,n)}}return d?(n||(n=new Ht),fp(t,e,r,o,i,n)):!1}var hp=_T;function gp(t,e,r,o,i){return t===e?!0:t==null||e==null||!Ne(t)&&!Ne(e)?t!==t&&e!==e:hp(t,e,r,o,gp,i)}var Hn=gp;var MT=1,kT=2;function RT(t,e,r,o){var i=r.length,n=i,a=!o;if(t==null)return!n;for(t=Object(t);i--;){var s=r[i];if(a&&s[2]?s[1]!==t[s[0]]:!(s[0]in t))return!1}for(;++i<n;){s=r[i];var l=s[0],c=t[l],u=s[1];if(a&&s[2]){if(c===void 0&&!(l in t))return!1}else{var f=new Ht;if(o)var d=o(c,u,l,t,e,f);if(!(d===void 0?Hn(u,c,MT|kT,o,f):d))return!1}}return!0}var wp=RT;function LT(t){return t===t&&!Ce(t)}var $n=LT;function DT(t){for(var e=nt(t),r=e.length;r--;){var o=e[r],i=t[o];e[r]=[o,i,$n(i)]}return e}var xp=DT;function BT(t,e){return function(r){return r==null?!1:r[t]===e&&(e!==void 0||t in Object(r))}}var Gn=BT;function WT(t){var e=xp(t);return e.length==1&&e[0][2]?Gn(e[0][0],e[0][1]):function(r){return r===t||wp(r,t,e)}}var bp=WT;function FT(t,e){return t!=null&&e in Object(t)}var yp=FT;function jT(t,e,r){e=In(e,t);for(var o=-1,i=e.length,n=!1;++o<i;){var a=jt(e[o]);if(!(n=t!=null&&r(t,a)))break;t=t[a]}return n||++o!=i?n:(i=t==null?0:t.length,!!i&&uo(i)&&En(a,i)&&(te(t)||mo(t)))}var vp=jT;function HT(t,e){return t!=null&&vp(t,e,yp)}var Ep=HT;var $T=1,GT=2;function UT(t,e){return wo(t)&&$n(e)?Gn(jt(t),e):function(r){var o=pd(r,t);return o===void 0&&o===e?Ep(r,t):Hn(e,o,$T|GT)}}var Sp=UT;function qT(t){return function(e){return e==null?void 0:e[t]}}var Tp=qT;function VT(t){return function(e){return On(e,t)}}var Np=VT;function zT(t){return wo(t)?Tp(jt(t)):Np(t)}var Cp=zT;function YT(t){return typeof t=="function"?t:t==null?kt:typeof t=="object"?te(t)?Sp(t[0],t[1]):bp(t):Cp(t)}var Gt=YT;function KT(t,e,r,o){for(var i=-1,n=t==null?0:t.length;++i<n;){var a=t[i];e(o,a,r(a),t)}return o}var Ip=KT;function XT(t){return function(e,r,o){for(var i=-1,n=Object(e),a=o(e),s=a.length;s--;){var l=a[t?s:++i];if(r(n[l],l,n)===!1)break}return e}}var Op=XT;var QT=Op(),Pp=QT;function JT(t,e){return t&&Pp(t,e,nt)}var Ap=JT;function ZT(t,e){return function(r,o){if(r==null)return r;if(!fo(r))return t(r,o);for(var i=r.length,n=e?i:-1,a=Object(r);(e?n--:++n<i)&&o(a[n],n,a)!==!1;);return r}}var _p=ZT;var eN=_p(Ap),Mp=eN;function tN(t,e,r,o){return Mp(t,function(i,n,a){e(o,i,r(i),a)}),o}var kp=tN;function rN(t,e){return function(r,o){var i=te(r)?Ip:kp,n=e?e():{};return i(r,t,Gt(o,2),n)}}var Io=rN;function oN(t,e,r){for(var o=-1,i=t==null?0:t.length;++o<i;)if(r(e,t[o]))return!0;return!1}var Rp=oN;var iN=Math.max;function nN(t,e,r){var o=t==null?0:t.length;if(!o)return-1;var i=r==null?0:xn(r);return i<0&&(i=iN(o+i,0)),lo(t,Gt(e,3),i)}var Ni=nN;var aN=Math.max,sN=Math.min;function lN(t,e,r){var o=t==null?0:t.length;if(!o)return-1;var i=o-1;return r!==void 0&&(i=xn(r),i=r<0?aN(o+i,0):sN(i,o-1)),lo(t,Gt(e,3),i,!0)}var Ci=lN;var cN=Object.prototype,uN=cN.hasOwnProperty,fN=Io(function(t,e,r){uN.call(t,r)?t[r].push(e):Rt(t,r,[e])}),Un=fN;function dN(t,e){return t>e}var Lp=dN;var pN=Io(function(t,e,r){Rt(t,r,e)}),qn=pN;function mN(t,e){return t<e}var Vn=mN;function hN(t,e,r){for(var o=-1,i=t.length;++o<i;){var n=t[o],a=e(n);if(a!=null&&(s===void 0?a===a&&!it(a):r(a,s)))var s=a,l=n}return l}var Oo=hN;function gN(t){return t&&t.length?Oo(t,kt,Lp):void 0}var Po=gN;function wN(t,e){for(var r,o=-1,i=t.length;++o<i;){var n=e(t[o]);n!==void 0&&(r=r===void 0?n:r+n)}return r}var Dp=wN;function xN(t){return t&&t.length?Oo(t,kt,Vn):void 0}var Ii=xN;function bN(t,e){return t&&t.length?Oo(t,Gt(e,2),Vn):void 0}var Zs=bN;var yN=Io(function(t,e,r){t[r?0:1].push(e)},function(){return[[],[]]}),Ao=yN;function vN(t){return t&&t.length?Dp(t,kt):0}var se=vN;var EN=1/0,SN=$t&&1/Co(new $t([,-0]))[1]==EN?function(t){return new $t(t)}:If,Bp=SN;var TN=200;function NN(t,e,r){var o=-1,i=kf,n=t.length,a=!0,s=[],l=s;if(r)a=!1,i=Rp;else if(n>=TN){var c=e?null:Bp(t);if(c)return Co(c);a=!1,i=Wn,l=new Bn}else l=e?[]:s;e:for(;++o<n;){var u=t[o],f=e?e(u):u;if(u=r||u!==0?u:0,a&&f===f){for(var d=l.length;d--;)if(l[d]===f)continue e;e&&l.push(f),s.push(u)}else i(l,f,r)||(l!==s&&l.push(f),s.push(u))}return s}var Wp=NN;function CN(t){return t&&t.length?Wp(t):[]}var Oi=CN;var fe=t=>t.filter(e=>e!=null);function zn(t,e,r){let o=t.get(e);return o===void 0&&(o=r(),t.set(e,o)),o}function Yn(t,e,r,o){if(e>0){let i=Ci(t,o,e-1);if(i!==-1)return i}if(r&&e<t.length-1){let i=Ci(t.slice(e+1),o);return i===-1?void 0:i+e+1}}function Kn(t,e,r,o){if(e<t.length-1){let i=Ni(t,o,e+1);if(i!==-1)return i}if(r&&e>0){let i=Ni(t.slice(0,e),o);return i===-1?void 0:i}}var Fp=t=>new Promise(e=>{setTimeout(e,t)});var Me=_(require("fs")),bh=_(require("os")),yh=_(Qp()),Xt=_(require("path")),vh=_(require("readline")),Eh=_(Xm()),He=require("util");var ua=require("child_process"),gh=_(hh()),fa=(t,e,r)=>{let o=(0,ua.spawn)(t,e,r),i="";return o.stdout.on("data",n=>{i+=n.toString()}),new Promise((n,a)=>{o.stdout.on("error",s=>{a(s)}),o.stdout.on("end",()=>{n(i)})})},Bl=(t,e)=>new Promise((r,o)=>{(0,ua.exec)(t,e,(i,n)=>{if(i)return o(i);r(n.toString("utf8"))})});function Wl(t){return process.platform==="win32"?`"${t.replace(/"/g,'\\"')}"`:(/[^A-Za-z0-9_/:=-]/.test(t)&&(t=`'${t.replace(/'/g,"'\\''")}'`,t=t.replace(/^(?:'')+/g,"").replace(/\\'''/g,"\\'")),t)}var Di=async t=>{try{await(0,gh.default)(t)}catch{return!1}return!0};var Be=process.platform==="win32",jF=process.platform==="darwin",HF=process.platform==="linux";var da=require("coc.nvim");var C=da.workspace.getConfiguration("explorer"),pa=(t=ga(da.workspace.cwd))=>da.workspace.getConfiguration("explorer",t);var ma=()=>C.get("buffer.tabOnly"),Fl=t=>{let e=t.get("file.autoReveal");return e!==void 0?E.error("`explorer.file.autoReveal` has been deprecated, please use explorer.file.reveal.auto instead of it"):e=t.get("file.reveal.auto"),e},ha=(t,e)=>{if(e!==void 0)return e;let r=t.get("file.revealWhenOpen");return r!==void 0?E.error("`explorer.file.autoReveal` has been deprecated, please use explorer.file.reveal.whenOpen instead of it"):r=t.get("file.reveal.whenOpen"),r};function wh(t){return{get config(){return t},get(e,r){return this.config.get(e,r)}}}var EI=async t=>{let{default:e}=await Promise.resolve().then(()=>_(require("trash")));await e(t,{glob:!1})},jl=class{constructor(){this.inited=!1;this.placeholders={list:"%l",sourceFile:"%s"};this.exec_=async()=>{}}async init(){if(this.inited)return;let e=C.get("trash.command");if(e==="nodejs:module"){this.exec_=async n=>{await EI(n)};return}let r=e.match(/^([^\s]+)/),o=r==null?void 0:r[1];if(!o){this.exec_=async()=>{throw new Error("'explorer.trash.command' must not be empty")};return}let i=async n=>{if(!await Di(n))throw new Error(`command(${n}) does not exist`)};e.includes(this.placeholders.list)?this.exec_=async n=>{await i(o);let a=n.map(s=>Wl(s)).join(" ");await Bl(e.replace(new RegExp(this.placeholders.list,"g"),a))}:e.includes(this.placeholders.sourceFile)&&(this.exec_=async n=>{await i(o);for(let a of n.map(s=>Wl(s)))await Bl(e.replace(new RegExp(this.placeholders.sourceFile,"g"),a))}),this.inited=!0}async exec(e){await this.init(),await this.exec_(e)}},xh=new jl;var Sh=_(Ro()),SI=(0,He.promisify)(Me.default.open),TI=(0,He.promisify)(Me.default.close),Th=async t=>await TI(await SI(t,"w")),Wo=yh.default,Fo=(0,He.promisify)(Me.default.readdir),Nh=(0,He.promisify)(Me.default.readlink),Bi=(t,e)=>new Promise(r=>{Me.default.access(t,e,o=>{r(!o)})}),wa=(0,He.promisify)(Me.default.writeFile),Ch=(0,He.promisify)(Me.default.readFile),xa=Bi,Dr=(0,He.promisify)(Me.default.stat),Lr=(0,He.promisify)(Me.default.lstat),NI=(0,He.promisify)(Me.default.copyFile),Hl=(0,He.promisify)(Me.default.rename),Ih=(0,He.promisify)(Eh.default),ba=async t=>{await xh.exec(typeof t=="string"?[t]:t)};async function $l(t,e){if((await Lr(t)).isDirectory()){await Wo(e);let o=await Fo(t);for(let i of o)await $l(Xt.default.join(t,i),Xt.default.join(e,i))}else await NI(t,e)}async function Oh(t,e,r){let o=await Fo(t);for(let i of o){let n=Xt.default.join(t,i),a=Xt.default.join(e,i);if(await xa(a)){let s=await Lr(n),l=await Lr(a);s.isDirectory()&&l.isDirectory()?await Oh(n,a,r):(await ba(a),await r(n,a))}else await r(n,a)}}async function Br(t,e,r){let o=[],i=async(n,a)=>{await Wo(Xt.default.dirname(a)),await r(n,a),o.push(a)};for(let n=0,a=e.length;n<a;n++){let s=e[n].source,l=e[n].target;if(!await xa(l)){await i(s,l);continue}let c=typeof s=="string"?await Lr(s):void 0,u=await Lr(l),f=async function(){let h=await $e(`Rename: ${l} ->`,l,"file");if(!h){n-=1;return}return i(s,h)},d=async function(){return await ba(l),i(s,l)},p=function(){n=a},m=async function(h={}){var x;h=G(N({skip:void 0,rename:f,"force replace":d},h),{quit:p});let g=await Ye(`${t[0].toUpperCase()}${t.slice(1)}: ${l} already exists.`,Object.keys(h));if(g&&g in h)return(x=h[g])==null?void 0:x.call(h)};s&&(c==null?void 0:c.isDirectory())?u.isDirectory()?await m({merge:()=>Oh(s,l,i),"one by one":async()=>{let g=(await Fo(s)).map(x=>({source:x,target:Xt.default.join(l,Xt.default.basename(x))}));await Br(t,g,r)}}):await m():u.isDirectory()?await m():await m()}return{endFullpaths:o}}function Ph(t,e,r){if(!Me.default.existsSync(t))return Promise.reject(new Error(`file does not exist: ${t}`));let o=[],i=Me.default.createReadStream(t,{encoding:"utf8"}),n=vh.default.createInterface({input:i,crlfDelay:1/0,terminal:!1}),a=0;return new Promise((s,l)=>{i.on("error",l),n.on("line",c=>{a===0&&c.startsWith("\uFEFF")&&(c=c.slice(1)),a>=e&&a<=r&&o.push(c),a===r&&n.close(),a=a+1}),n.on("close",()=>{s(o)}),n.on("error",l)})}async function Gl(t,e){try{let r=await Fo(t);for(let o of e)if(o.includes("*")?Sh.default.match(r,o,{nobrace:!0,noext:!0,nocomment:!0,nonegate:!0,dot:!0}).length!==0:r.includes(o))return!0}catch{}return!1}function Qt(t){let e=bh.default.homedir();return t.startsWith(e)?`~${t.slice(e.length)}`:t}async function ya(){if(Be)return(await fa("wmic",["logicaldisk","get","name"])).split(`
`).map(r=>r.trim()).filter(r=>r.endsWith(":")).map(r=>`${r}\\`);throw new Error(`not support listDrive in ${process.platform}`)}var Ah=_(require("os")),Jt=_(require("path"));function va(t){let e=Jt.default.basename(t).split("."),[r,...o]=e;if(r)return{basename:r,extensions:o};{let[i,...n]=o;return{basename:[r,i].join("."),extensions:n}}}function le(t){let e=Jt.default.normalize(t);return e[0]==="~"&&(e=Jt.default.join(Ah.default.homedir(),e.slice(1))),Be&&/[a-z]:/.test(e)&&(e=e[0].toUpperCase()+e.slice(1)),e}function Ea(t,e){let r=le(Jt.default.resolve(t)),o=le(Jt.default.resolve(e));return r==="//"&&(r="/"),r.endsWith(Jt.default.sep)?o.startsWith(r):o.startsWith(r)&&o[r.length]===Jt.default.sep}var ee=require("coc.nvim"),Wh=_(Fi());function Vl(){return ee.workspace.floatSupported}function Fh(){return ee.workspace.isNvim&&Vl()}async function St(){return!!await ee.workspace.nvim.getOption("wrapscan")}async function jh(t){let{nvim:e}=ee.workspace;(await e.getOption("runtimepath")).split(",").includes(t)||await e.command(`execute 'noa set rtp+='.fnameescape('${t.replace(/'/g,"''")}')`)}function Hh(t,e){var o;if(!e)return;let r=e.guifg;if(r){let i=(o=e.ctermfg)!=null?o:Wh.default.rgb.ansi256([r.red,r.green,r.blue]);return`highlight default ${t} ctermfg=${i} guifg=#${Hi(r)}`}else if(e.ctermfg)return`highlight default ${t} ctermfg=${e.ctermfg}`}async function $h(t){return await ee.workspace.nvim.call("strdisplaywidth",[t])}async function Wr(t,e,r){return await ee.workspace.nvim.call("coc_explorer#util#strdisplayslice",[t,e,r!=null?r:void 0])}function zl(t){return v.create(()=>{ee.workspace.nvim.call("coc_explorer#util#close_win_by_bufnr",t,!0)})}async function ji(t){if(!!t)return ee.workspace.nvim.call("bufwinnr",t).then(e=>{if(e>0)return e})}async function Yl(t){if(!t)return;let e=await ee.workspace.nvim.call("win_getid",t);if(e>=0)return e}async function Kl(t){if(t)return ee.workspace.nvim.createWindow(t)}async function Ta(t){if(!t)return;let e=await ee.workspace.nvim.call("winbufnr",t);if(e>=0)return e}async function Xl(t){return await ee.workspace.nvim.call("win_findbuf",[t])}async function Gh(t){let o=(await(await ee.workspace.nvim.tabpage).windows).map(n=>n.id);return(await ee.workspace.nvim.call("win_findbuf",[t])).filter(n=>o.includes(n))}async function Na(t){let e=await ee.workspace.nvim.call("win_getid",[]);if(!!t.length){ee.workspace.nvim.pauseNotification();for(let r of t)ee.workspace.nvim.call("win_gotoid",[r],!0),ee.workspace.nvim.command("enew",!0),ee.workspace.isVim&&ee.workspace.nvim.command("redraw",!0);ee.workspace.nvim.call("win_gotoid",[e],!0),await ee.workspace.nvim.resumeNotification()}}async function Ke(){return ee.workspace.nvim.call("bufnr")}var Ho=require("coc.nvim");var $i;async function LI(){return $i||($i=Ho.extensions.all.find(t=>t.id==="coc-floatinput")),$i==null?void 0:$i.exports}async function Uh(){var t;if(!!C.get("enableFloatinput"))return(t=await LI())==null?void 0:t.FloatingUI}async function DI(t,e,r){e||(e=["yes","no"],r="no");let o=r?e.indexOf(r):-1,i=await Ho.workspace.nvim.call("confirm",[t,e.map(n=>{let a=[...n].findIndex(s=>/[A-Z]/.test(s));return a===-1&&(a=0),`${n.slice(0,a)}&${n[a].toUpperCase()}${n.slice(a+1)}`}).join(`
`),o+1]);if(i!==0)return e[i-1]}async function Ye(t,e,r){let o=await Uh();return o?o.confirm({prompt:t,values:e,defaultValue:r}):DI(t,e,r)}async function BI(t,e="",r=void 0){return Ho.workspace.nvim.callAsync("coc#util#with_callback",["input",[`${t} `,e,r]])}async function $e(t,e="",r=void 0){var i;let o=await Uh();return o?(i=await o.stringInput({prompt:t,defaultValue:e}))!=null?i:"":BI(t,e,r)}async function Ca(t,e,{onSelect:r,noChoice:o,onCancel:i}){var s,l,c;let n=t.get("openAction.select.filter");if(n.sources){let u=n.sources[e];u&&(n=N(N({},n),u))}let a=await Ho.workspace.nvim.call("coc_explorer#select_wins#start",[(s=n.buftypes)!=null?s:[],(l=n.filetypes)!=null?l:[],(c=n.floatingWindows)!=null?c:!0]);a>0?await Promise.resolve(r(a)):a===0?await Promise.resolve(o==null?void 0:o()):await Promise.resolve(i==null?void 0:i())}function ga(t,e="file"){return e==="file"&&Be&&/^[A-Za-z]:/.test(t)&&(t=`/${t}`),`${e}://${t}`}var qh=_(Fi());function Ia(t,e,r,o){return{red:t,green:e,blue:r,alpha:o}}function WI(t,e){let r=(t.red+e.red)/2,o=t.red-e.red,i=t.green-e.green,n=t.blue-e.blue;return Math.sqrt(((512+r)*o*o>>8)+4*i*i+((767-r)*n*n>>8))}function Ql(t,e,r=o=>o){return Zs(e,o=>WI(r(o),t))}function Gi(t){t=t.trim(),t[0]==="#"&&(t=t.slice(1));let e=t.match(/.{1,2}/g);if(!e)return;let[r,o,i]=e,n=parseInt(r,16);if(isNaN(n))return;let a=parseInt(o,16);if(isNaN(a))return;let s=parseInt(i,16);if(!isNaN(s))return Ia(n,a,s,1)}function Hi(t){return qh.default.rgb.hex(t.red,t.green,t.blue)}var Gg=require("coc.nvim");function U(t){return typeof t=="function"}function $o(t){let r=t(o=>{Error.call(o),o.stack=new Error().stack});return r.prototype=Object.create(Error.prototype),r.prototype.constructor=r,r}var Oa=$o(t=>function(r){t(this),this.message=r?`${r.length} errors occurred during unsubscription:
${r.map((o,i)=>`${i+1}) ${o.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=r});function Fr(t,e){if(t){let r=t.indexOf(e);0<=r&&t.splice(r,1)}}var Oe=class{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;let{_parentage:r}=this;if(r)if(this._parentage=null,Array.isArray(r))for(let n of r)n.remove(this);else r.remove(this);let{initialTeardown:o}=this;if(U(o))try{o()}catch(n){e=n instanceof Oa?n.errors:[n]}let{_finalizers:i}=this;if(i){this._finalizers=null;for(let n of i)try{Vh(n)}catch(a){e=e!=null?e:[],a instanceof Oa?e=[...e,...a.errors]:e.push(a)}}if(e)throw new Oa(e)}}add(e){var r;if(e&&e!==this)if(this.closed)Vh(e);else{if(e instanceof Oe){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(r=this._finalizers)!==null&&r!==void 0?r:[]).push(e)}}_hasParent(e){let{_parentage:r}=this;return r===e||Array.isArray(r)&&r.includes(e)}_addParent(e){let{_parentage:r}=this;this._parentage=Array.isArray(r)?(r.push(e),r):r?[r,e]:e}_removeParent(e){let{_parentage:r}=this;r===e?this._parentage=null:Array.isArray(r)&&Fr(r,e)}remove(e){let{_finalizers:r}=this;r&&Fr(r,e),e instanceof Oe&&e._removeParent(this)}};Oe.EMPTY=(()=>{let t=new Oe;return t.closed=!0,t})();var Jl=Oe.EMPTY;function Pa(t){return t instanceof Oe||t&&"closed"in t&&U(t.remove)&&U(t.add)&&U(t.unsubscribe)}function Vh(t){U(t)?t():t.unsubscribe()}var Xe={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var Go={setTimeout(t,e,...r){let{delegate:o}=Go;return o!=null&&o.setTimeout?o.setTimeout(t,e,...r):setTimeout(t,e,...r)},clearTimeout(t){let{delegate:e}=Go;return((e==null?void 0:e.clearTimeout)||clearTimeout)(t)},delegate:void 0};function Aa(t){Go.setTimeout(()=>{let{onUnhandledError:e}=Xe;if(e)e(t);else throw t})}function Ui(){}var zh=(()=>Zl("C",void 0,void 0))();function Yh(t){return Zl("E",void 0,t)}function Kh(t){return Zl("N",t,void 0)}function Zl(t,e,r){return{kind:t,value:e,error:r}}var jr=null;function Uo(t){if(Xe.useDeprecatedSynchronousErrorHandling){let e=!jr;if(e&&(jr={errorThrown:!1,error:null}),t(),e){let{errorThrown:r,error:o}=jr;if(jr=null,r)throw o}}else t()}function Xh(t){Xe.useDeprecatedSynchronousErrorHandling&&jr&&(jr.errorThrown=!0,jr.error=t)}var Hr=class extends Oe{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,Pa(e)&&e.add(this)):this.destination=HI}static create(e,r,o){return new Zt(e,r,o)}next(e){this.isStopped?tc(Kh(e),this):this._next(e)}error(e){this.isStopped?tc(Yh(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?tc(zh,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},FI=Function.prototype.bind;function ec(t,e){return FI.call(t,e)}var rc=class{constructor(e){this.partialObserver=e}next(e){let{partialObserver:r}=this;if(r.next)try{r.next(e)}catch(o){_a(o)}}error(e){let{partialObserver:r}=this;if(r.error)try{r.error(e)}catch(o){_a(o)}else _a(e)}complete(){let{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(r){_a(r)}}},Zt=class extends Hr{constructor(e,r,o){super();let i;if(U(e)||!e)i={next:e!=null?e:void 0,error:r!=null?r:void 0,complete:o!=null?o:void 0};else{let n;this&&Xe.useDeprecatedNextContext?(n=Object.create(e),n.unsubscribe=()=>this.unsubscribe(),i={next:e.next&&ec(e.next,n),error:e.error&&ec(e.error,n),complete:e.complete&&ec(e.complete,n)}):i=e}this.destination=new rc(i)}};function _a(t){Xe.useDeprecatedSynchronousErrorHandling?Xh(t):Aa(t)}function jI(t){throw t}function tc(t,e){let{onStoppedNotification:r}=Xe;r&&Go.setTimeout(()=>r(t,e))}var HI={closed:!0,next:Ui,error:jI,complete:Ui};var qo=(()=>typeof Symbol=="function"&&Symbol.observable||"@@observable")();function Qh(t){return t}function Jh(t){return t.length===0?Qh:t.length===1?t[0]:function(r){return t.reduce((o,i)=>i(o),r)}}var xe=class{constructor(e){e&&(this._subscribe=e)}lift(e){let r=new xe;return r.source=this,r.operator=e,r}subscribe(e,r,o){let i=GI(e)?e:new Zt(e,r,o);return Uo(()=>{let{operator:n,source:a}=this;i.add(n?n.call(i,a):a?this._subscribe(i):this._trySubscribe(i))}),i}_trySubscribe(e){try{return this._subscribe(e)}catch(r){e.error(r)}}forEach(e,r){return r=Zh(r),new r((o,i)=>{let n=new Zt({next:a=>{try{e(a)}catch(s){i(s),n.unsubscribe()}},error:i,complete:o});this.subscribe(n)})}_subscribe(e){var r;return(r=this.source)===null||r===void 0?void 0:r.subscribe(e)}[qo](){return this}pipe(...e){return Jh(e)(this)}toPromise(e){return e=Zh(e),new e((r,o)=>{let i;this.subscribe(n=>i=n,n=>o(n),()=>r(i))})}};xe.create=t=>new xe(t);function Zh(t){var e;return(e=t!=null?t:Xe.Promise)!==null&&e!==void 0?e:Promise}function $I(t){return t&&U(t.next)&&U(t.error)&&U(t.complete)}function GI(t){return t&&t instanceof Hr||$I(t)&&Pa(t)}function UI(t){return U(t==null?void 0:t.lift)}function er(t){return e=>{if(UI(e))return e.lift(function(r){try{return t(r,this)}catch(o){this.error(o)}});throw new TypeError("Unable to lift unknown Observable type")}}function Qe(t,e,r,o,i){return new oc(t,e,r,o,i)}var oc=class extends Hr{constructor(e,r,o,i,n,a){super(e),this.onFinalize=n,this.shouldUnsubscribe=a,this._next=r?function(s){try{r(s)}catch(l){e.error(l)}}:super._next,this._error=i?function(s){try{i(s)}catch(l){e.error(l)}finally{this.unsubscribe()}}:super._error,this._complete=o?function(){try{o()}catch(s){e.error(s)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:r}=this;super.unsubscribe(),!r&&((e=this.onFinalize)===null||e===void 0||e.call(this))}}};var eg=$o(t=>function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var ke=class extends xe{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(e){let r=new Ma(this,this);return r.operator=e,r}_throwIfClosed(){if(this.closed)throw new eg}next(e){Uo(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let r of this.currentObservers)r.next(e)}})}error(e){Uo(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=e;let{observers:r}=this;for(;r.length;)r.shift().error(e)}})}complete(){Uo(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:e}=this;for(;e.length;)e.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var e;return((e=this.observers)===null||e===void 0?void 0:e.length)>0}_trySubscribe(e){return this._throwIfClosed(),super._trySubscribe(e)}_subscribe(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)}_innerSubscribe(e){let{hasError:r,isStopped:o,observers:i}=this;return r||o?Jl:(this.currentObservers=null,i.push(e),new Oe(()=>{this.currentObservers=null,Fr(i,e)}))}_checkFinalizedStatuses(e){let{hasError:r,thrownError:o,isStopped:i}=this;r?e.error(o):i&&e.complete()}asObservable(){let e=new xe;return e.source=this,e}};ke.create=(t,e)=>new Ma(t,e);var Ma=class extends ke{constructor(e,r){super(),this.destination=e,this.source=r}next(e){var r,o;(o=(r=this.destination)===null||r===void 0?void 0:r.next)===null||o===void 0||o.call(r,e)}error(e){var r,o;(o=(r=this.destination)===null||r===void 0?void 0:r.error)===null||o===void 0||o.call(r,e)}complete(){var e,r;(r=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||r===void 0||r.call(e)}_subscribe(e){var r,o;return(o=(r=this.source)===null||r===void 0?void 0:r.subscribe(e))!==null&&o!==void 0?o:Jl}};var ic={now(){return(ic.delegate||Date).now()},delegate:void 0};var ka=class extends Oe{constructor(e,r){super()}schedule(e,r=0){return this}};var qi={setInterval(t,e,...r){let{delegate:o}=qi;return o!=null&&o.setInterval?o.setInterval(t,e,...r):setInterval(t,e,...r)},clearInterval(t){let{delegate:e}=qi;return((e==null?void 0:e.clearInterval)||clearInterval)(t)},delegate:void 0};var Ra=class extends ka{constructor(e,r){super(e,r),this.scheduler=e,this.work=r,this.pending=!1}schedule(e,r=0){if(this.closed)return this;this.state=e;let o=this.id,i=this.scheduler;return o!=null&&(this.id=this.recycleAsyncId(i,o,r)),this.pending=!0,this.delay=r,this.id=this.id||this.requestAsyncId(i,this.id,r),this}requestAsyncId(e,r,o=0){return qi.setInterval(e.flush.bind(e,this),o)}recycleAsyncId(e,r,o=0){if(o!=null&&this.delay===o&&this.pending===!1)return r;qi.clearInterval(r)}execute(e,r){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;let o=this._execute(e,r);if(o)return o;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,r){let o=!1,i;try{this.work(e)}catch(n){o=!0,i=n||new Error("Scheduled action threw falsy error")}if(o)return this.unsubscribe(),i}unsubscribe(){if(!this.closed){let{id:e,scheduler:r}=this,{actions:o}=r;this.work=this.state=this.scheduler=null,this.pending=!1,Fr(o,this),e!=null&&(this.id=this.recycleAsyncId(r,e,null)),this.delay=null,super.unsubscribe()}}};var tr=class{constructor(e,r=tr.now){this.schedulerActionCtor=e,this.now=r}schedule(e,r=0,o){return new this.schedulerActionCtor(this,e).schedule(o,r)}};tr.now=ic.now;var La=class extends tr{constructor(e,r=tr.now){super(e,r),this.actions=[],this._active=!1,this._scheduled=void 0}flush(e){let{actions:r}=this;if(this._active){r.push(e);return}let o;this._active=!0;do if(o=e.execute(e.state,e.delay))break;while(e=r.shift());if(this._active=!1,o){for(;e=r.shift();)e.unsubscribe();throw o}}};var Vi=new La(Ra),tg=Vi;function rg(t){return t&&U(t.schedule)}var Ng=_(Tg(),1),{__extends:L5,__assign:D5,__rest:B5,__decorate:W5,__param:F5,__metadata:j5,__awaiter:Cg,__generator:H5,__exportStar:$5,__createBinding:G5,__values:U5,__read:q5,__spread:V5,__spreadArrays:z5,__spreadArray:Y5,__await:Fa,__asyncGenerator:Ig,__asyncDelegator:K5,__asyncValues:Og,__makeTemplateObject:X5,__importStar:Q5,__importDefault:J5,__classPrivateFieldGet:Z5,__classPrivateFieldSet:eH,__classPrivateFieldIn:tH}=Ng.default;var Pg=t=>t&&typeof t.length=="number"&&typeof t!="function";function Ag(t){return U(t==null?void 0:t.then)}function _g(t){return U(t[qo])}function Mg(t){return Symbol.asyncIterator&&U(t==null?void 0:t[Symbol.asyncIterator])}function kg(t){return new TypeError(`You provided ${t!==null&&typeof t=="object"?"an invalid object":`'${t}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function qI(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var Rg=qI();function Lg(t){return U(t==null?void 0:t[Rg])}function Dg(t){return Ig(this,arguments,function*(){let r=t.getReader();try{for(;;){let{value:o,done:i}=yield Fa(r.read());if(i)return yield Fa(void 0);yield yield Fa(o)}}finally{r.releaseLock()}})}function Bg(t){return U(t==null?void 0:t.getReader)}function ja(t){if(t instanceof xe)return t;if(t!=null){if(_g(t))return VI(t);if(Pg(t))return zI(t);if(Ag(t))return YI(t);if(Mg(t))return Wg(t);if(Lg(t))return KI(t);if(Bg(t))return XI(t)}throw kg(t)}function VI(t){return new xe(e=>{let r=t[qo]();if(U(r.subscribe))return r.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function zI(t){return new xe(e=>{for(let r=0;r<t.length&&!e.closed;r++)e.next(t[r]);e.complete()})}function YI(t){return new xe(e=>{t.then(r=>{e.closed||(e.next(r),e.complete())},r=>e.error(r)).then(null,Aa)})}function KI(t){return new xe(e=>{for(let r of t)if(e.next(r),e.closed)return;e.complete()})}function Wg(t){return new xe(e=>{QI(t,e).catch(r=>e.error(r))})}function XI(t){return Wg(Dg(t))}function QI(t,e){var r,o,i,n;return Cg(this,void 0,void 0,function*(){try{for(r=Og(t);o=yield r.next(),!o.done;){let a=o.value;if(e.next(a),e.closed)return}}catch(a){i={error:a}}finally{try{o&&!o.done&&(n=r.return)&&(yield n.call(r))}finally{if(i)throw i.error}}e.complete()})}var Fg=$o(t=>function(){t(this),this.name="EmptyError",this.message="no elements in sequence"});function zi(t,e){let r=typeof e=="object";return new Promise((o,i)=>{let n=new Zt({next:a=>{o(a),n.unsubscribe()},error:i,complete:()=>{r?o(e.defaultValue):i(new Fg)}});t.subscribe(n)})}function jg(t){return t instanceof Date&&!isNaN(t)}function Hg(t=0,e,r=tg){let o=-1;return e!=null&&(rg(e)?r=e:o=e),new xe(i=>{let n=jg(t)?+t-r.now():t;n<0&&(n=0);let a=0;return r.schedule(function(){i.closed||(i.next(a++),0<=o?this.schedule(void 0,o):i.complete())},n)})}function $r(t){return er((e,r)=>{let o=[];return e.subscribe(Qe(r,i=>o.push(i),()=>{r.next(o),r.complete()})),t.subscribe(Qe(r,()=>{let i=o;o=[],r.next(i)},Ui)),()=>{o=null}})}function at(t,e=Vi){return er((r,o)=>{let i=null,n=null,a=null,s=()=>{if(i){i.unsubscribe(),i=null;let c=n;n=null,o.next(c)}};function l(){let c=a+t,u=e.now();if(u<c){i=this.schedule(void 0,c-u),o.add(i);return}s()}r.subscribe(Qe(o,c=>{n=c,a=e.now(),i||(i=e.schedule(l,t),o.add(i))},()=>{s(),o.complete()},void 0,()=>{n=i=null}))})}function rr(t,e){return er((r,o)=>{let i=null,n=0,a=!1,s=()=>a&&!i&&o.complete();r.subscribe(Qe(o,l=>{i==null||i.unsubscribe();let c=0,u=n++;ja(t(l,u)).subscribe(i=Qe(o,f=>o.next(e?e(l,f,u,c++):f),()=>{i=null,s()}))},()=>{a=!0,s()}))})}var ac={leading:!0,trailing:!1};function $g(t,e=ac){return er((r,o)=>{let{leading:i,trailing:n}=e,a=!1,s=null,l=null,c=!1,u=()=>{l==null||l.unsubscribe(),l=null,n&&(p(),c&&o.complete())},f=()=>{l=null,c&&o.complete()},d=m=>l=ja(t(m)).subscribe(Qe(o,u,f)),p=()=>{if(a){a=!1;let m=s;s=null,o.next(m),!c&&d(m)}};r.subscribe(Qe(o,m=>{a=!0,s=m,!(l&&!l.closed)&&(i?p():d(m))},()=>{c=!0,!(n&&a&&l&&!l.closed)&&o.complete()}))})}function sc(t,e=Vi,r=ac){let o=Hg(t,e);return $g(()=>o,r)}function Ha(t){return e=>{let r=t.subscribe(E.asyncCatch(e));return Gg.Disposable.create(()=>r.unsubscribe())}}function $a(t){let e=new ke;return t(e).subscribe({error:E.error}),e}function Ug(t,e){let r=new ke;return t.once(e,o=>{r.next(o)}),r.asObservable()}function qg(t){let e=new ke;return t.event(r=>{e.next(r)}),e.asObservable()}function Ga(t,e){let r=new ke;r.pipe(at(t),rr(async i=>e(...i))).subscribe({error:E.error});let o=(...i)=>r.next(i);return o.dispose=()=>r.unsubscribe(),o}function Ua(t,e,r){let o=new ke;o.pipe(sc(t,void 0,r),rr(async n=>e(...n))).subscribe({error:E.error});let i=(...n)=>o.next(n);return i.dispose=()=>o.unsubscribe(),i}function Je(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var E=new mi("explorer");var st=require("coc.nvim");var qa=Symbol("arg"),Yi,lc=class extends st.BasicList{constructor(r){super(st.workspace.nvim);Bu(this,Yi,void 0);this.name=r.name,Wu(this,Yi,(i,n)=>r.loadItems(this[qa],i,n)),r.doHighlight&&(this.doHighlight=r.doHighlight),r.defaultAction&&(this.defaultAction=r.defaultAction);let o={addAction:(i,n,a)=>this.addAction(i,(s,l)=>n({arg:this[qa],item:s,context:l}),a),addLocationActions:()=>this.addLocationActions(),convertLocation:i=>this.convertLocation(i)};r.init.call(o,o)}loadItems(r,o){return Du(this,Yi).call(this,r,o)}};qa,Yi=new WeakMap;function or(t){return new lc(t)}async function Gr(t,e,r,o=[]){e[qa]=r;let i=t.config,n=t.nvim,a=t.explorerManager.bufManager,s=i.get("floating.hideOnCocList",!0),l=!0;t.isFloating&&s&&(await t.hide(),l=!1);let c=new st.Emitter,u=st.listManager.registerList(e);return await n.command(`CocList ${o.join(" ")} ${e.name}`),u.dispose(),{async waitExplorerShow(){await a.waitReload();let f=st.events.on("BufEnter",async()=>{let d=a.getBufferNode(`list:///${e.name}`);d&&await ji(d.bufnr)||(f.dispose(),t.isFloating&&!l&&(await Fp(200),await t.show(),c.fire()))});if(!l)return new Promise(d=>{c.event(()=>{l=!0,d(void 0)})})}}}function JI(t,e){let r=t.indexOf(e);return r===-1?-1:t.length-r}var zo=cc.workspace.createMru("explorer-actions"),Vg=or({name:"explorerActionList",defaultAction:"do",async loadItems(t){let e=await zo.load(),r=t.map(o=>({label:`${o.name} [${o.key||""}] ${o.description}`,data:G(N({},o),{score:JI(e,o.name)})}));return r.sort((o,i)=>i.data.score-o.data.score),r},doHighlight(){let{nvim:t}=cc.workspace;t.pauseNotification(),t.command("syntax match CocExplorerActionName /\\v^[a-zA-Z0-9:|<>]+/",!0),t.command("syntax match CocExplorerActionKey /\\v\\[.*\\]/",!0),t.command("syntax match CocExplorerActionDescription /\\v\\] \\zs.*/",!0),t.command("highlight default link CocExplorerActionName PreProc",!0),t.command("highlight default link CocExplorerActionKey Identifier",!0),t.command("highlight default link CocExplorerActionDescription Comment",!0),t.resumeNotification().catch(E.error)},init(){this.addAction("do",({item:t})=>{E.asyncCatch(async()=>{let e=t.data;await e.callback(),await zo.add(e.name)})()})}});var Ki=require("coc.nvim");var Yo={"expandable?":{filter:(t,e)=>e.expandable,getHelpDescription:()=>"expandable?"},"expanded?":{filter:(t,e)=>t.view.isExpanded(e),getHelpDescription:()=>"expanded?"},"type?":{filter:(t,e,r)=>e.type===r[0],getHelpDescription:t=>`type is ${t[0]}`}},Ur={name:"wait",helpDescription:"<wait>"},ir={name:"noop",helpDescription:"<noop>"};function ZI(t){if(typeof t!="string")return t;let[e,...r]=t.split(/:/);return{name:e,args:r}}function zg(t){let{name:e,args:r}=t;return[e,...r].join(":")}function Yg(t){return t.includes("<dot>")?t.replace(/<dot>/g,"."):t}function qr(t){return Array.isArray(t)?t.map(qr):ZI(t)}function Kg(t){let e={};for(let[r,o]of Object.entries(t))e[Yg(r)]=qr(o);return e}function Va(t,e){let r=Kg(t);for(let[o,i]of Object.entries(e)){if(i===!1){delete r[o];continue}r[Yg(o)]=qr(i)}return r}function uc(t){return Array.isArray(t)?t.map(r=>uc(r)).filter(r=>r&&!(r.name in Yo)&&r.name!==Ur.name&&r.name!==ir.name)[0]:t}var fc=class{constructor(){this.mode=C.get("keyMappingMode","default");this.mouseMappings={none:{},singleclick:{"<LeftRelease>":["expandable?",["expanded?","collapse","expand"],"open"]},doubleclick:{"<2-LeftMouse>":["expandable?",["expanded?","collapse","expand"],"open"]}}[C.get("mouseMode")];this.configByModes={none:{global:{},vmap:{},sources:{}},default:{global:G(N({"*":"toggleSelection","<tab>":"actionMenu",h:["wait","collapse"],l:["wait","expandable?","expand","open"],J:["wait","toggleSelection","normal:j"],K:["wait","toggleSelection","normal:k"],gl:["wait","expand:recursive"],gh:["wait","collapse:recursive"]},this.mouseMappings),{o:["wait","expanded?","collapse","expand"],"<cr>":["wait","expandable?","cd","open"],e:"open",s:"open:split",E:"open:vsplit",t:"open:tab","<bs>":["wait","gotoParent"],gs:["wait","reveal:select"],il:"preview:labeling",ic:"preview:content",Il:"previewOnHover:toggle:labeling",Ic:"previewOnHover:toggle:content",II:"previewOnHover:disable",yp:"copyFilepath",yn:"copyFilename",yy:"copyFile",yt:"copyFile:toggle",ya:"copyFile:append","y<space>":"clearCopyOrCut",dd:"cutFile",dt:"cutFile:toggle",da:"cutFile:append","d<space>":"clearCopyOrCut",p:["pasteFile","clearCopyOrCut"],P:"pasteFile",df:"delete",dF:"deleteForever",a:"addFile",A:"addDirectory",r:"rename",zh:"toggleHidden","g<dot>":"toggleHidden",R:"refresh","?":"help",q:"quit","<esc>":"esc",X:"systemExecute",gd:"listDrive",f:"search",F:"search:recursive",gf:"gotoSource:file",gb:"gotoSource:buffer","[[":["wait","sourcePrev"],"]]":["wait","sourceNext"],"[i":["wait","indentPrev"],"]i":["wait","indentNext"],"[m":["wait","markPrev:modified"],"]m":["wait","markNext:modified"],"[d":["wait","markPrev:diagnosticError:diagnosticWarning"],"]d":["wait","markNext:diagnosticError:diagnosticWarning"],"[D":["wait","markPrev:diagnosticError"],"]D":["wait","markNext:diagnosticError"],"[c":["wait","markPrev:gitUnstaged:gitStaged"],"]c":["wait","markNext:gitUnstaged:gitStaged"],"[C":["wait","markPrev:gitUnstaged"],"]C":["wait","markNext:gitUnstaged"],"<<":"gitStage",">>":"gitUnstage"}),vmap:{il:"textobj:line:i",al:"textobj:line:a",ii:"textobj:indent:i",ai:"textobj:indent:a"},sources:{}}}}get config(){return this.configByModes[this.mode]}globalMappings(){return this.globalMappings_||(this.globalMappings_=Va(this.config.global,N({},C.get("keyMappings.global",{})))),this.globalMappings_}vmapMappings(){return this.vmapMappings_||(this.vmapMappings_=Va(this.config.vmap,N({},C.get("keyMappings.vmap",{})))),this.vmapMappings_}allSourceMappings(){var e;if(!this.allSourceMappings_){let r=(e=this.config.sources)!=null?e:{},o=C.get("keyMappings.sources",{});this.allSourceMappings_=new Map;for(let[i,n]of Object.entries(r))this.allSourceMappings_.set(i,N({},Kg(n)));for(let[i,n]of Object.entries(o)){let a=this.allSourceMappings_.get(i);a?this.allSourceMappings_.set(i,Va(a,n)):this.allSourceMappings_.set(i,Va({},n))}}return this.allSourceMappings_}sourceMappings(e){return this.allSourceMappings().get(e)}async filterEscForVim(e){Ki.workspace.isVim&&!await Ki.workspace.nvim.call("has",["gui_running"])&&e.delete("<esc>")}async getCommonKeys(){let e=new Set;for(let r of Object.keys(this.globalMappings()))e.add(r);for(let r of this.allSourceMappings().values())for(let o of Object.keys(r))e.add(o);return await this.filterEscForVim(e),e}async getVisualKeys(){let e=new Set;for(let r of Object.keys(this.vmapMappings()))e.add(r);return e}getActionExp(e,r,o){var s,l,c;let i=this.vmapMappings(),n=this.globalMappings(),a=this.sourceMappings(e);return o==="v"?(l=(s=i==null?void 0:i[r])!=null?s:a==null?void 0:a[r])!=null?l:n[r]:(c=a==null?void 0:a[r])!=null?c:n[r]}async getMappings(e){let r=this.globalMappings(),o=this.vmapMappings(),i=this.sourceMappings(e),n=N(N({},r),i);return Ki.workspace.isVim&&!await Ki.workspace.nvim.call("has",["gui_running"])&&delete n["<esc>"],{all:n,vmap:o}}async getReversedMappings(e){let r=await this.getMappings(e),o={};return Object.entries(r.all).find(([i,n])=>{let a=uc(n);if(a){let s=zg(a);o[s]||(o[s]={}),o[s].all=i}}),Object.entries(r.vmap).find(([i,n])=>{let a=uc(n);if(a){let s=zg(a);o[s]||(o[s]={}),o[s].vmap=i}}),o}},Ze=new fc;function Xg(t,e){let r=t.indexOf(e);return r===-1?-1:t.length-r}var za=class{constructor(e){this.explorerManager=e}async provideCodeActions(e,r,o,i){let n=await this.explorerManager.currentExplorer();if(!n)return[];let a=await n.view.currentSource();if(!a)return[];let s=await Ze.getReversedMappings(a.sourceType),l=a.action.registeredActions(),c=await zo.load();return ye([...l.entries()].filter(([u])=>u!=="actionMenu").sort(([u],[f])=>u.localeCompare(f)).sort(([u],[f])=>u.localeCompare(f)).map(([u,{options:f}])=>{var h;let d=s[u],p=d?(h=d.vmap)!=null?h:d.all:"",m=[{title:`${u} [${p}]`,name:u,command:"explorer.doCodeAction",arguments:[u,u,async()=>[]],score:Xg(c,u)}];return f.menus&&m.push(...Mt.getNormalizeMenus(f.menus).map(g=>{var I;let x=`${u}:${g.args}`,b=s[x],S=b?(I=b.vmap)!=null?I:b.all:"";return{title:`${x} [${S}]`,name:x,command:"explorer.doCodeAction",arguments:[x,u,()=>g.actionArgs()],score:Xg(c,x)}})),m})).sort((u,f)=>f.score-u.score)}};var Qi=require("coc.nvim"),Ka=_(require("path"));var Ko=require("coc.nvim");var dc=class{constructor(){this.bufnrs=new Set}getExplorer(e){return this[e.name]}setExplorer(e,r){this[e.name]=r}all(){let e=[];return this.left&&e.push(this.left),this.right&&e.push(this.right),this.tab&&e.push(this.tab),this.floating&&e.push(this.floating),e}},pc=class{constructor(){this.initedEmitter=new Ko.Emitter;this.tabContainerMap=new Map;this.waitInited=zi(qg(this.initedEmitter))}get(e){let r=this.tabContainerMap.get(e);if(r)return r;{let o=new dc;return this.tabContainerMap.set(e,o),o}}async register(){let e=await Ko.workspace.nvim.call("tabpagebuflist");await oe.curTabAddBufnr(...e)}values(){return Array.from(this.tabContainerMap.values())}async currentTabId(){return await this.waitInited,await Ko.workspace.nvim.call("coc_explorer#tab#current_id")}async currentTabMaxId(){return await this.waitInited,await Ko.workspace.nvim.call("coc_explorer#tab#max_id")}async currentTabContainer(){return this.get(await this.currentTabId())}existBufnr(e){return this.values().some(r=>r.bufnrs.has(e))}async curTabAddBufnr(...e){let r=await this.currentTabId(),o=this.get(r);e.forEach(i=>o.bufnrs.add(i))}async curTabDelBufnr(...e){let r=await this.currentTabId(),o=this.get(r);e.forEach(i=>o.bufnrs.delete(i))}},oe=new pc;var nr=require("coc.nvim");var We=(t,e,r,o)=>{let i=nr.events.on(t,E.asyncCatch(e),r),n=nr.Disposable.create(()=>{typeof e.cancel=="function"&&e.cancel(),typeof e.dispose=="function"&&e.dispose(),i.dispose()});return o&&o.push(n),n};function Vr(t,e,r){let o=0,i=e!==0?Ga(e,n=>{if(n!==o)return o=n,t(n)}):t;return We("BufEnter",i,void 0,r)}function mc(t,e,r){let o=Ua(e,t,{leading:!1,trailing:!0});return We("CursorMoved",o,void 0,r)}var Xi=new bi({BufDelete:{eventExpr:"BufDelete *",argExprs:['+expand("<abuf>")']},BufWipeout:{eventExpr:"BufWipeout *",argExprs:['+expand("<abuf>")']},TabEnter:{eventExpr:"TabEnter *",argExprs:['+expand("<abuf>")']},ColorScheme:{eventExpr:"ColorScheme *",argExprs:["g:colors_name"]},CocDiagnosticChange:{eventExpr:"User CocDiagnosticChange"},CocGitStatusChange:{eventExpr:"User CocGitStatusChange"},FugitiveChanged:{eventExpr:"User FugitiveChanged"},CocBookmarkChange:{eventExpr:"User CocBookmarkChange"}},E,{name:"explorer"}),lt=Xi.events,gG=new nr.Emitter;function hc(t){return v.create(()=>{nr.workspace.nvim.call("coc_explorer#util#do_autocmd",[t],!0)})}async function Ya(t){await hc(t).run()}var eO=/^\s*(\d+)(.+?)"(.+?)".*/,Xa=class{constructor(e){this.bufferNodeMapByFullpath=new Map;this.bufferNodeMapById=new Map;this.nvim=Qi.workspace.nvim;this.reloadSubject=new ke;this.modifiedSubject=new ke;this.bufferNodes=[];this.onReload=Ha(this.reloadSubject);this.onReloadDebounce=Ha(this.reloadSubject.pipe(at(500)));this.onModifiedDebounce=Ha(this.modifiedSubject.pipe($r(this.modifiedSubject.pipe(at(500)))));this.registerEvents(e).catch(E.error)}async registerEvents(e){e.subscriptions.push(We(["BufCreate","BufHidden","BufUnload","BufWinEnter","BufWinLeave"],Ua(100,()=>this.reload(),{leading:!1,trailing:!0})),lt.on("BufDelete",()=>this.reload()),lt.on("BufWipeout",()=>this.reload())),e.subscriptions.push(We("BufWinEnter",o=>oe.curTabAddBufnr(o)),lt.on("TabEnter",o=>oe.curTabAddBufnr(o)));let r=async o=>{let i=this.bufferNodeMapById.get(o);if(!i)return;let n=await Qi.workspace.nvim.eval(`bufloaded(${o}) ? getbufvar(${o}, '&modified') : v:null`);n===null||i.modified===n||(i.modified=n,this.modifiedSubject.next(i.fullpath))};e.subscriptions.push(We("BufWritePost",async o=>{await r(o)}),...["TextChanged","TextChangedI","TextChangedP"].map(o=>We(o,async i=>{await r(i)})))}async removeBufNode(e,r){if(!r.skipModified&&e.modified)throw new Error("The content of buffer has not been saved!");let o=await Xl(e.bufnr);await Na(o),r.bwipeout?await this.nvim.command(`bwipeout! ${e.bufnr}`):await this.nvim.command(`bdelete! ${e.bufnr}`)}async removePrefix(e,r){for(let[o,i]of this.bufferNodeMapByFullpath)o.startsWith(e)&&await this.removeBufNode(i,r)}async remove(e,r){if(r.directory)return this.removePrefix(e+Ka.default.sep,r);{let o=this.bufferNodeMapByFullpath.get(e);if(!o)return;await this.removeBufNode(o,r)}}async replaceBufNode(e,r,o){if(!o.skipModified&&e.modified)throw new Error("The content of buffer has not been saved!");let{nvim:i}=this,n=await i.call("win_getid",[]),a=await Xl(e.bufnr);if(a.length){let s=await i.call("fnameescape",[r]);i.pauseNotification();for(let l of a)i.call("win_gotoid",[l],!0),i.command(`edit ${s}`,!0),Qi.workspace.isVim&&i.command("redraw",!0);i.call("win_gotoid",[n],!0),await i.resumeNotification()}o.bwipeout?await i.command(`bwipeout! ${e.bufnr}`):await i.command(`bdelete! ${e.bufnr}`)}async replacePrefix(e,r,o){for(let[i,n]of this.bufferNodeMapByFullpath)if(i.startsWith(e)){let a=n.fullpath.replace(e,r);await this.replaceBufNode(n,a,o)}}async replace(e,r,o){return this.replacePrefix(e,r,o)}modified(e,r){var o,i;return r.directory?this.modifiedPrefix(e+Ka.default.sep):(i=(o=this.bufferNodeMapByFullpath.get(e))==null?void 0:o.modified)!=null?i:!1}modifiedPrefix(e){for(let[r,o]of this.bufferNodeMapByFullpath)if(r.startsWith(e)&&o.modified)return!0;return!1}getBufferNode(e){return typeof e=="number"?this.bufferNodeMapById.get(e):this.bufferNodeMapByFullpath.get(e)}async waitReload(){return new Promise(e=>{let r=this.onReload(()=>{r.dispose(),e()});setTimeout(e,100)})}async reload(){let e="ls!",r=await this.nvim.call("execute",e);this.bufferNodes=fe(await Promise.all(r.split(/\n/).map(async o=>{let i=o.match(eO);if(!i)return;let n=i[1],a=i[2],s=i[3],l=await Qi.workspace.nvim.call("expand",[`#${n}:p`,1]);return{type:"child",uid:n,level:1,bufnr:parseInt(n),bufnrStr:n,bufname:s,fullpath:l,name:Ka.default.basename(s),unlisted:a.includes("u"),current:a.includes("%"),previous:a.includes("#"),visible:a.includes("a"),hidden:a.includes("h"),modifiable:!a.includes("-"),readonly:a.includes("="),terminal:a.includes("R")||a.includes("F")||a.includes("?"),modified:a.includes("+"),readErrors:a.includes("x")}}))),this.bufferNodeMapByFullpath=this.bufferNodes.reduce((o,i)=>(o.set(i.fullpath,i),o),new Map),this.bufferNodeMapById=this.bufferNodes.reduce((o,i)=>(o.set(i.bufnr,i),o),new Map),this.reloadSubject.next()}};var ro=require("coc.nvim");var Jg=require("coc.nvim");var Qg=require("coc.nvim");async function Qa(t){let e=await Qg.workspace.nvim.eval('get(g:, "coc_explorer_global_presets", {})');return new Map(Object.entries(N(N({},e),t.get("presets"))).map(([r,o])=>[r,new Map(Object.entries(o))]))}var Xo=class{constructor(e){this.args=e;this.optionValues=new Map}static registerOption(e,r={}){let o=N({type:r.position===void 0?"string":"positional",name:e},r);return this.registeredOptions.set(e,o),o}static registerBoolOption(e,r){let o={type:"boolean",name:e,getDefault:typeof r=="boolean"?()=>r:r};return this.registeredOptions.set(e,o),this.registeredOptions.set(`no-${e}`,o),o}static async parse(e,r){var c,u;let o=new Xo(e),i=[...e],n=1;for(;i.length>0;){let f=i.shift();if(f.startsWith("--")){let p,m;/^--[\w-]+=/.test(f)?[p,m]=rf(f.slice(2),"=",2):p=f.slice(2);let h=this.registeredOptions.get(p);if(!h)throw Error(`coc-explorer command no support option(${p})`);if(m===void 0){if(h.type==="boolean"){o.optionValues.set(h.name,!p.startsWith("no-"));continue}else if(m=i.shift(),m===void 0)continue}o.optionValues.set(h.name,h.parseArg?await h.parseArg(m):m);continue}let d=Array.from(this.registeredOptions.values()).find(p=>p.position===n);d&&o.optionValues.set(d.name,d.parseArg?await d.parseArg(f):f),n+=1}let a=o.optionValues.get("preset");if(!a)return o;let l=(await Qa(r)).get(a);if(!l)return Jg.window.showMessage(`coc-explorer preset(${a}) not found`,"warning"),o;for(let[f,d]of l){if(o.optionValues.has(f)||d===void 0)continue;let p=this.registeredOptions.get(f);p&&o.optionValues.set(f,(u=(c=p.parsePreset)==null?void 0:c.call(p,d))!=null?u:d)}return o}has(e){return this.optionValues.has(e.name)}async value(e){var o,i,n,a,s;let r;if(this.optionValues.has(e.name))r=this.optionValues.get(e.name);else if(Xo.registeredOptions.has(e.name))r=await((i=(o=Xo.registeredOptions.get(e.name))==null?void 0:o.getDefault)==null?void 0:i.call(o));else throw new Error(`Argument(${e.name}) not found`);return(s=(a=(n=Xo.registeredOptions.get(e.name))==null?void 0:n.handler)==null?void 0:a.call(n,r))!=null?s:r}async values(e){return(await Promise.all(Object.entries(e).map(async([o,i])=>[o,await this.value(i)]))).reduce((o,[i,n])=>(o[i]=n,o),{})}},R=Xo;R.registeredOptions=new Map;var Pe={rootUri:R.registerOption("root-uri",{position:1}),rootStrategies:R.registerOption("root-strategies",{parseArg:t=>t.split(","),getDefault:()=>C.get("root.strategies")}),toggle:R.registerBoolOption("toggle",()=>C.get("toggle")),openActionStrategy:R.registerOption("open-action-strategy",{getDefault:()=>C.get("openAction.strategy")}),focus:R.registerBoolOption("focus",()=>C.get("focus")),quit:R.registerBoolOption("quit",!1),quitOnOpen:R.registerBoolOption("quit-on-open",()=>C.get("quitOnOpen")),reveal:R.registerOption("reveal",{handler:t=>t&&le(t)}),revealWhenOpen:R.registerBoolOption("reveal-when-open"),preset:R.registerOption("preset"),sources:R.registerOption("sources",{parseArg:t=>t.split(",").map(e=>{let r=!1,o;return e.endsWith("+")?(r=!0,o=e.slice(0,e.length-1)):e.endsWith("-")?(r=!1,o=e.slice(0,e.length-1)):o=e,{name:o,expand:r}}),getDefault:()=>C.get("sources")}),position:R.registerOption("position",{parseArg:t=>{let[e,r]=t.split(":");return{name:e,arg:r}},parsePreset:t=>Array.isArray(t)?{name:t[0],arg:t[0]}:typeof t=="string"?{name:t}:t,getDefault:()=>{let t=C.get("position");return Array.isArray(t)?{name:t[0],arg:t[1]}:{name:t}}}),width:R.registerOption("width",{parseArg:t=>parseInt(t,10),getDefault:()=>C.get("width")}),contentWidth:R.registerOption("content-width",{parseArg:t=>parseInt(t,10),getDefault:()=>C.get("contentWidth")}),contentWidthType:R.registerOption("content-width-type",{getDefault:()=>C.get("contentWidthType")}),floatingPosition:R.registerOption("floating-position",{parseArg:t=>["left-center","right-center","center","center-top"].includes(t)?t:t.split(",").map(e=>parseInt(e,10)),getDefault:()=>C.get("floating.position")}),floatingWidth:R.registerOption("floating-width",{parseArg:t=>parseInt(t,10),getDefault:()=>C.get("floating.width")}),floatingHeight:R.registerOption("floating-height",{parseArg:t=>parseInt(t,10),getDefault:()=>C.get("floating.height")}),floatingContentWidth:R.registerOption("floating-content-width",{parseArg:t=>parseInt(t,10),getDefault:()=>C.get("floating.contentWidth")})};var Zg=require("coc.nvim"),Ja="coc_explorer_context",Za=class{constructor(e){this.name=e}async set(e){let r=await this.read();e===void 0?Reflect.deleteProperty(r,this.name):Reflect.set(r,this.name,e),await this.write(r)}async get(){let e=await this.read();return Reflect.get(e,this.name)}},Qo=class extends Za{constructor(r,o){super(r);this.name=r;this.buffer=o}async read(){return await this.buffer.getVar(Ja)||{}}async write(r){await this.buffer.setVar(Ja,r)}};var Ji=class extends Za{constructor(){super(...arguments);this.nvim=Zg.workspace.nvim}async read(){var r;return(r=await this.nvim.getVar(Ja))!=null?r:{}}async write(r){await this.nvim.setVar(Ja,r)}};var Ue=require("coc.nvim"),nb=_(xc());var ts=require("coc.nvim");var Jo=class{constructor(e){this.owner=e;this.actions=new Map}addNodesAction(e,r,o,i={}){this.actions.set(e,{callback:r,description:o,options:N({select:!0},i)})}addNodeAction(e,r,o,i={}){this.actions.set(e,{callback:async({source:n,nodes:a,args:s,mode:l})=>{for(let c of a)await r.call(n,{source:n,node:c,args:s,mode:l})},description:o,options:i})}};var es=class extends Jo{constructor(r){super(r);this.waitActionMutex=new ts.Mutex;this.explorer=this.owner}get locator(){return this.explorer.locator}async doActionByKey(r,o,i=1){for(let n=0;n<i;n++){let a=await this.explorer.getSelectedOrCursorLineIndexes(o),s=this.explorer.lineIndexesGroupBySource(a);for(let{source:l,lineIndexes:c}of s){let u=Ze.getActionExp(l.sourceType,r,o);u&&await this.doActionExp(u,{mode:o,lineIndexes:c})}}await this.explorer.view.emitRequestRenderNodes()}async doActionExp(r,o={}){var s,l;let i=(s=o.count)!=null?s:1,n=(l=o.mode)!=null?l:"n",a=o.lineIndexes?new Set(o.lineIndexes):await this.explorer.getSelectedOrCursorLineIndexes(n);try{for(let c=0;c<i;c++){let u=c===0?a:await this.explorer.getSelectedOrCursorLineIndexes(n),f=new Map;for(let d of u){let{source:p}=this.explorer.findSourceByLineIndex(d);f.has(p)||f.set(p,[]);let m=d-p.view.startLineIndex;f.get(p).push(p.view.flattenedNodes[m])}for(let[d,p]of f)await d.action.doActionExp(r,p,{mode:n})}}catch(c){ts.window.showMessage(`Error when do action(${JSON.stringify(r)})`,"error"),E.error(c)}}async nodePrev(r="default",o){let i=async(n,a,s)=>{let l=Yn(n,a,await St(),o);l!==void 0&&await this.locator.gotoLineIndex(s+l)};if(r==="insideSource"){let n=await this.explorer.view.currentSource();if(!n)return;await i(n.view.flattenedNodes,n.view.currentLineIndex,n.view.startLineIndex)}else await i(this.explorer.view.flattenedNodes,this.explorer.view.currentLineIndex,0)}async nodeNext(r="default",o){let i=async(n,a,s)=>{let l=Kn(n,a,await St(),o);l!==void 0&&await this.locator.gotoLineIndex(s+l)};if(r==="insideSource"){let n=await this.explorer.view.currentSource();if(!n)return;await i(n.view.flattenedNodes,n.view.currentLineIndex,n.view.startLineIndex)}else await i(this.explorer.view.flattenedNodes,this.explorer.view.currentLineIndex,0)}};var Nw=require("coc.nvim");var pw=require("coc.nvim"),ut=_(require("path"));var zr=require("coc.nvim"),bc=_(require("path"));var Tt=(u=>(u.mixed="*",u.unmodified=" ",u.modified="M",u.added="A",u.deleted="D",u.renamed="R",u.copied="C",u.unmerged="U",u.untracked="?",u.ignored="!",u))(Tt||{});var oO=(t,e)=>t.x===e.x&&t.y===e.y,iO=(t,e)=>t.allStaged!==e.allStaged?!1:t.formats.join(",")===e.formats.join(","),rs=class{constructor(){this.sourcesBinding=new Map;this.prevStatusesMapInRoot=new Map;this.prevIgnoresMapInRoot=new Map;this.prevRootStatuses=new Map;this.registerForSourceDisposables=[];this.registerDisposables=[];this.inited=!1;this.reloadDebounceSubject=$a(e=>e.pipe($r(e.pipe(at(200))),rr(async r=>{let o=new Set(r.map(n=>n.sources).flat()),i=new Set(r.map(n=>n.directory));await this.reload([...o],[...i])})))}get explorerManager(){if(!this.explorerManager_)throw new Error("ExplorerSource(explorerManager) is not bound yet");return this.explorerManager_}get sources(){return Array.from(this.sourcesBinding.keys())}get refTotalCount(){return se(Array.from(this.sourcesBinding.values()).map(e=>e.refCount))}init_(e){this.inited||(this.inited=!0,this.explorerManager_=e.explorer.explorerManager)}bind(e){this.init_(e);let r=zn(this.sourcesBinding,e,()=>({refCount:0}));return r.refCount+=1,r.refCount===1&&(this.registerForSourceDisposables=this.registerForSource(e)),this.refTotalCount===1&&(this.registerDisposables=this.register()),zr.Disposable.create(()=>{r.refCount-=1,r.refCount===0&&((0,zr.disposeAll)(this.registerForSourceDisposables),this.registerForSourceDisposables=[]),this.refTotalCount===0&&((0,zr.disposeAll)(this.registerDisposables),this.registerDisposables=[])})}register(){return[...["CocGitStatusChange","FugitiveChanged"].map(e=>lt.on(e,async()=>{this.reloadDebounceSubject.next({sources:this.sources,directory:zr.workspace.cwd})})),We("BufWritePost",async e=>{var o;let r=(o=this.explorerManager.bufManager.getBufferNode(e))==null?void 0:o.fullpath;if(r){let i=bc.default.dirname(r);this.reloadDebounceSubject.next({sources:this.sources,directory:i})}})]}registerForSource(e){return[e.events.on("loaded",async r=>{let o="isRoot"in r?e.root:r.expandable?r.fullpath:r.fullpath&&bc.default.dirname(r.fullpath);o&&this.reloadDebounceSubject.next({sources:[e],directory:o})})]}async reload(e,r){let o=await B.getGitRoots(r);if(!o.length)return;let i=new Set,n=new Set;for(let a of o){await B.reload(a);let s=B.getMixedStatusesByRoot(a),l=B.getIgnoreByRoot(a),c=B.getRootStatus(a)||{allStaged:!1,formats:[]},u=this.prevStatusesMapInRoot.get(a);u||(u=new Map,this.prevStatusesMapInRoot.set(a,u));let f=this.prevIgnoresMapInRoot.get(a);f||(f=new Map,this.prevIgnoresMapInRoot.set(a,f));let d=this.prevRootStatuses.get(a);d||(d={allStaged:!1,formats:[]},this.prevRootStatuses.set(a,d));let p=(m,h)=>{h===0?n.add(m.replace(/[\\/]$/,"")):i.add(m)};for(let[m,h]of s){let g=u.get(m);if(g&&oO(g,h)){u.delete(m);continue}i.add(m)}for(let m of u.keys())i.add(m);for(let[m,h]of l){if(f.get(m)===h){f.delete(m);continue}p(m,h)}for(let[m,h]of f)p(m,h);c&&!iO(d,c)&&i.add(a),this.prevStatusesMapInRoot.set(a,s),this.prevIgnoresMapInRoot.set(a,l),this.prevRootStatuses.set(a,c)}for(let a of e)await a.view.renderPaths([...i,{paths:n,withChildren:!0}])}};var fw=require("coc.nvim"),dw=_(uw()),Sc=_(require("path"));var ei=class{static get binPath(){return C.get("git.command")}static async waitLoaded(){if(!this.loaded)return new Promise(e=>{this.onLoaded(e)})}static async preload(){try{await(0,dw.default)(this.binPath),this.available=!0}catch{this.available=!1}finally{this.loaded=!0,this.loadedEmitter.fire()}}get binPath(){return ei.binPath}async available(){return await ei.waitLoaded(),ei.available}spawn(e,{cwd:r}={}){return fa(this.binPath,e,{cwd:r})}async getRoot(e){let r=await Dr(e).catch(()=>{}),o=r!=null&&r.isDirectory()?e:Sc.default.dirname(e),i=await this.spawn(["rev-parse","--show-toplevel"],{cwd:o});return le(i.trim())}parseStatusFormat(e){var r;return(r=Object.values(Tt).find(o=>o===e))!=null?r:" "}parsePath(e,r){let o=0,i="",n=!1,a=!1,s=!1,l=[];for(;o<e.length;){let c=e[o];if(!n&&!a){c==='"'&&(a=!0,o+=1),i="",n=!0;continue}else a?s?(i+=c==="t"?"	":c,s=!1):c==='"'?(l.push(i),a=!1,n=!1):c==="\\"?s=!0:i+=c:c===" "&&r&&e.slice(o,o+4)===" -> "?(i.length&&l.push(i),o+=3,n=!1):i+=c;o+=1}return n&&(l.push(i),n=!1),l}parseStatusLine(e,r){let o=this.parseStatusFormat(r[0]),i=this.parseStatusFormat(r[1]),n=r.slice(3),a=["R","C"].includes(o)||["R","C"].includes(i),s=this.parsePath(n,a);return[o,i,...s.map(l=>Sc.default.join(e,l))]}async status(e,{showUntrackedFiles:r="system",showIgnored:o=!0}={}){let i=new Map,n=["status","--porcelain"];return r===!0?n.push("-u"):r===!1&&n.push("-uno"),o&&n.push("--ignored=matching"),(await this.spawn(n,{cwd:e})).split(`
`).forEach(l=>{if(!l)return;let[c,u,f,d]=this.parseStatusLine(e,l),p=c==="?"?" ":c,m=u==="!"?" ":u,h=["M","A","D","R","C"],g=p==="A"||m==="A",x=p==="M"||m==="M",b=p==="D"||m==="D",S=p==="R"||m==="R",I=p==="C"||m==="C",V=h.includes(p)&&m===" ",pt=p==="D"&&m==="D"||p==="A"&&m==="A"||p==="U"||m==="U",qe=p==="!",Ae=m==="?",Te=d||f;i.set(Te,{fullpath:Te,x:p,y:m,added:g,modified:x,deleted:b,renamed:S,copied:I,staged:V,unmerged:pt,untracked:Ae,ignored:qe})}),i}async stage(e){if(e.length){let r=await this.getRoot(e[0]);await this.spawn(["add",...e],{cwd:r})}}async unstage(e){if(e.length){let r=await this.getRoot(e[0]);await this.spawn(["reset",...e],{cwd:r})}}async fetch(e){await this.spawn(["fetch"],{cwd:e})}async hasPull(e){let r=await this.spawn(["rev-list","--count","@..@{upstream}"],{cwd:e});return parseInt(r)}async hasPush(e){let r=await this.spawn(["rev-list","--count","@{upstream}..@"],{cwd:e});return parseInt(r)}async hasStashed(e){return(await this.spawn(["stash","list"],{cwd:e})).split(/\n/g).length-1}async checkIgnore(e){if(!e.length)return[];let r=await this.getRoot(e[0]);return(await this.spawn(["check-ignore",...e],{cwd:r})).split(/\n/g)}},ct=ei;ct.available=!1,ct.loadedEmitter=new fw.Emitter,ct.loaded=!1,ct.onLoaded=ei.loadedEmitter.event;var Tc=class{constructor(){this.cmd=new ct;this.rootCache=new Map;this.mixedStatusMapCacheInRoot=new Map;this.ignoreMapCacheInRoot=new Map;this.rootStatusCache=new Map;this.binder=new rs;this.showIgnored=C.get("git.showIgnored"),this.showUntrackedFiles=C.get("file.git.showUntrackedFiles")}async getGitRoots(e){let r=[...new Set(e)],o=await Promise.all(r.map(i=>this.getGitRoot(i)));return fe(o)}async getGitRoot(e){let r=this.rootCache.get(e);if(r)return r;let o=e.split(ut.default.sep),i=o.indexOf(".git");if(i!==-1){let n=o.slice(0,i).join(ut.default.sep);this.rootCache.set(e,n)}else try{let n=await this.cmd.getRoot(e);ut.default.isAbsolute(n)?this.rootCache.set(e,n):ut.default.join(e,n)}catch(n){E.error(n);return}return this.rootCache.get(e)}async reload(e,r={}){var i,n;let o=await this.getGitRoot(e);if(o){let a={showIgnored:(i=r.showIgnored)!=null?i:this.showIgnored,showUntrackedFiles:(n=r.showUntrackedFiles)!=null?n:this.showUntrackedFiles},s=await this.cmd.status(o,a),l=[...s.values()],c={allStaged:!0,formats:[]};this.rootStatusCache.set(o,c),await this.cmd.hasStashed(o)&&c.formats.push(5),await this.cmd.hasPull(o)&&c.formats.push(2),await this.cmd.hasPush(o)&&c.formats.push(1),l.some(d=>d.y==="U")&&c.formats.push(3),l.some(d=>d.y==="?")&&c.formats.push(4),l.some(d=>d.x==="M"||d.y==="M")&&c.formats.push(6),l.some(d=>d.x==="A")&&c.formats.push(7),l.some(d=>d.x==="R")&&c.formats.push(8),l.some(d=>d.x==="D"||d.y==="D")&&c.formats.push(9),l.some(d=>d.y!==" ")&&(c.allStaged=!1);let u=new Map,f=new Map;this.mixedStatusMapCacheInRoot.set(o,u),this.ignoreMapCacheInRoot.set(o,f),s.forEach((d,p)=>{if(d.x==="!"){["/","\\"].includes(p[p.length-1])?f.set(p,0):f.set(p,1);return}let h=ut.default.relative(o,p).split(ut.default.sep);for(let g=1;g<=h.length;g++){let x=ut.default.join(o,ut.default.join(...h.slice(0,g))),b=u.get(x);b?(b.x!=="*"&&b.x!==d.x&&(b.x===" "?b.x=d.x:d.x!==" "&&(b.x="*")),b.y!=="*"&&b.y!==d.y&&(b.y===" "?b.y=d.y:d.y!==" "&&(b.y="*"))):u.set(x,{x:d.x,y:d.y})}})}return o}bindColumn(e){return C.get("git.enable")?this.binder.bind(e):pw.Disposable.create(()=>{})}getMixedStatusesByRoot(e){return this.mixedStatusMapCacheInRoot.get(e)||new Map}getIgnoreByRoot(e){return this.ignoreMapCacheInRoot.get(e)||new Map}getMixedStatus(e,r){let o=[...this.mixedStatusMapCacheInRoot.entries()].sort((n,a)=>a[0].localeCompare(n[0])).find(([n])=>e.startsWith(n));if(o){let n=o[1].get(e);if(n)return n}let i=[...this.ignoreMapCacheInRoot.entries()].sort((n,a)=>a[0].localeCompare(n[0])).find(([n])=>e.startsWith(n));if(i&&[...i[1].entries()].some(([s,l])=>l===1?s===e:(r?e+ut.default.sep:e).startsWith(s)))return{x:"!",y:" "}}getRootStatus(e){return this.rootStatusCache.get(e)}},B=new Tc;var mw=["line","indent"],hw=["i","a"],gw=["default","insideSource"],ww=["select","previousBuffer","previousWindow","sourceWindow","path"],xw=["select","split","split.plain","split.intelligent","vsplit","vsplit.plain","vsplit.intelligent","tab","previousBuffer","previousWindow","sourceWindow"],bw=["toggle","append","replace"],yw=["toggle","enable","disable"],Nc=["labeling","content"],is=["keep","workspace","cwd","sourceBuffer","reveal"],vw=["recursive","noIgnore","strict"],Ew=["recursive","compact","uncompact","recursiveSingle"],Sw=["recursive","all"];var Zi=require("coc.nvim");var Cc=class{constructor(e,r,o,i,n,a,s){this.explorer=e;this.source=r;this.cursorPosition=o;this.getFullpath=n;this.quitOnOpenNotifier=a;this.explorerWinid=s;this.nvim=Zi.workspace.nvim,this.explorerPosition=e.argValues.position,this.openByWinnr=i!=null?i:async l=>{let c=await this.getEscapePath();await this.openWrap(()=>{this.nvim.command(`${l}wincmd w`,!0),this.nvim.command(`edit ${c}`,!0),Zi.workspace.isVim&&this.nvim.command("redraw",!0)})}}jumpToNotify(){var e;if(this.cursorPosition==="keep"){if(!this.explorerWinid)return;this.nvim.call("win_gotoid",[this.explorerWinid],!0)}else this.cursorPosition&&this.nvim.call("cursor",[this.cursorPosition.lineIndex+1,((e=this.cursorPosition.columnIndex)!=null?e:0)+1],!0)}async openWrap(e,r){var s;let o=(s=r==null?void 0:r.earlyQuit)!=null?s:!1,i=[];o?await this.explorer.tryQuitOnOpen():i.push(await this.quitOnOpenNotifier());let a=await this.nvim.call("winnr",["$"])===1&&this.explorerPosition.name!=="floating";this.nvim.pauseNotification(),e(),v.notifyAll(i),this.jumpToNotify(),a&&this.explorer.resizeNotifier().notify(),await this.nvim.resumeNotification()}async getEscapePath(){let e=await this.getFullpath();return this.explorer.config.get("openAction.relativePath")&&(e=await Zi.workspace.nvim.call("fnamemodify",[e,":."])),await Zi.workspace.nvim.call("fnameescape",[e])}async tryResize(){await this.explorer.resize()}},Ic=class{constructor(e){this.ctx=e}async select(){let e=this.ctx;e.explorerPosition.name==="floating"&&await e.explorer.hide(),await Ca(e.explorer.config,e.source.sourceType,{onSelect:async r=>{await e.openByWinnr(r)},noChoice:async()=>{await this.vsplit()},onCancel:async()=>{e.explorerPosition.name==="floating"&&await e.explorer.show()}})}async splitIntelligent(e,r){let o=this.ctx,i=await o.explorer.winid;if(!i)return;let a=(await vi.create()).findWinid(i);if(a)if(a.parent&&a.parent.group.type==="row"){let s=a.parent.group.children[a.parent.indexInParent+(o.explorerPosition.name==="left"?1:-1)];if(s){let l=vi.getFirstLeafWinid(s),c=await o.getEscapePath();await o.openWrap(()=>{o.nvim.call("win_gotoid",[l],!0),o.nvim.command(`${e} ${c}`,!0)})}}else await this["vsplit.plain"]();else await this[r]()}async split(){await this["split.intelligent"]()}async"split.plain"(){let e=this.ctx,r=await e.getEscapePath();await e.openWrap(()=>{e.nvim.command(`split ${r}`,!0)})}async"split.intelligent"(){let e=this.ctx;if(e.explorerPosition.name==="floating"){await this["split.plain"]();return}else if(e.explorerPosition.name==="tab"){await this.vsplit();return}await this.splitIntelligent("split","split.plain")}async vsplit(){await this["vsplit.intelligent"]()}async"vsplit.plain"(){let e=this.ctx,r=await e.getEscapePath();await e.openWrap(()=>{e.nvim.command(`vsplit ${r}`,!0)})}async"vsplit.intelligent"(){let e=this.ctx;if(e.explorerPosition.name==="floating"){await this["vsplit.plain"]();return}else if(e.explorerPosition.name==="tab"){await this["vsplit.plain"]();return}await this.splitIntelligent("vsplit","vsplit.plain")}async tab(){let e=this.ctx,r=await e.getEscapePath();await e.openWrap(()=>{e.nvim.command(`tabedit ${r}`,!0)},{earlyQuit:!0})}async previousBuffer(){let e=this.ctx,r=await e.explorer.explorerManager.prevWinnrByPrevBufnr();r?await e.openByWinnr(r):await this.vsplit()}async previousWindow(){let e=this.ctx,r=await e.explorer.explorerManager.prevWinnrByPrevWindowID();r?await e.openByWinnr(r):await this.vsplit()}async sourceWindow(){let e=this.ctx,r=await e.explorer.sourceWinnr();r?await e.openByWinnr(r):await this.vsplit()}};async function Tw(t,e,r,o,{openByWinnr:i,openStrategy:n,cursorPosition:a}){if(r.expandable)return;let s,l;a==="keep"?(s=await t.winid,l=()=>v.noop()):l=()=>t.tryQuitOnOpenNotifier();let c=new Cc(t,e,a,i,o,l,s),u=new Ic(c);n||(n=await t.args.value(Pe.openActionStrategy)),Je(u,n)||new Error(`openStrategy(${n}) is not supported`),await u[n]()}function Cw(t){let e=t.owner,r=e.locator,{nvim:o}=Nw.workspace,i=[{name:"open strategy",description:xw.join(" | ")},{name:"open with position",description:"line-number,column-number | keep"}],n={select:"use select window UI","select:keep":"use select window UI, but keep cursor in explorer","split.plain":"use vim split","split.intelligent":"use split like vscode","vsplit.plain":"use vim vsplit","vsplit.intelligent":"use vim vsplit, but keep the explorer in the original position",tab:"vim tab",previousBuffer:"use last used buffer",previousWindow:"use last used window",sourceWindow:"use the window where explorer opened"};t.addNodeAction("open",async({source:u,node:f,args:d,mode:p})=>{if(f.expandable){let x=e.config.get("openAction.for.directory");x&&await e.action.doActionExp(qr(x),{mode:p,lineIndexes:[e.view.flattenedNodes.indexOf(f)]});return}let[m,h]=d,g;if(h==="keep")g=h;else if(h){let[x,b]=h.split(",").map(S=>parseInt(S,10));g={lineIndex:x},b&&(g.columnIndex=b)}else if(f.location){let{range:x}=f.location;g={lineIndex:x.start.line-1}}await Tw(e,u,f,()=>f.fullpath,{openStrategy:m,cursorPosition:g})},"open file or directory",{select:!0,args:i,menus:n}),t.addNodeAction("expand",async({source:u,node:f,args:d})=>{var p;if(f.expandable){let m=((p=d[0])!=null?p:"").split("|"),h=m.includes("recursive")||void 0,g=m.includes("compact")||void 0,x=m.includes("uncompact")||void 0,b=m.includes("recursiveSingle")||void 0;await u.view.expand(f,{recursive:h,compact:g,uncompact:x,recursiveSingle:b})}},"expand node",{select:!0,args:[{name:"expand options",description:Ew.join(" | ")}],menus:{recursive:"recursively",compact:"single child folders will be compressed in a combined node",uncompact:"reset the combined node","compact|uncompact":"compact or uncompact",recursiveSingle:"expand single child folder recursively"}}),t.addNodeAction("collapse",async({source:u,node:f,args:d})=>{var g;let p=((g=d[0])!=null?g:"").split("|"),m=p.includes("all"),h=p.includes("recursive");if(m&&u.view.rootNode.children)for(let x of u.view.rootNode.children)x.expandable&&u.view.isExpanded(x)&&await u.action.doAction("collapse",x,p.filter(b=>b!=="all"));else f.expandable&&u.view.isExpanded(f)?await u.view.collapse(f,{recursive:h}):f.parent&&await u.view.collapse(f.parent,{recursive:h})},"collapse node",{select:!0,args:[{name:"collapse options",description:Sw.join(" | ")}],menus:{recursive:"recursively",all:"for all nodes"}}),t.addNodesAction("gitStage",async({nodes:u,source:f})=>{let d=di(u.map(m=>m.fullpath));if(!d.length)return;await B.cmd.stage(d);let p=await B.getGitRoots(d);for(let m of p)await B.reload(m);f.view.requestRenderNodes([{nodes:u,withParents:!0,withChildren:!0}])},"add file to git index"),t.addNodesAction("gitUnstage",async({nodes:u,source:f})=>{let d=di(u.map(m=>m.fullpath));if(!d.length)return;await B.cmd.unstage(d);let p=await B.getGitRoots(d);for(let m of p)await B.reload(m);f.view.requestRenderNodes([{nodes:u,withParents:!0,withChildren:!0}])},"reset file from git index");let a=[{name:"move action options",description:gw.join(" | ")}],s={insideSource:"move inside current source"};t.addNodeAction("nodePrev",async({args:u})=>{if(u[0]==="insideSource"){let d=await e.view.currentSource();if(!d)return;await d.locator.gotoLineIndex(d.view.currentLineIndex-1)}else{let d=e.view.currentLineIndex;await r.gotoLineIndex(d-1)}},"previous node",{args:a,menus:s}),t.addNodeAction("nodeNext",async({args:u})=>{if(u[0]==="insideSource"){let d=await e.view.currentSource();if(!d)return;await d.locator.gotoLineIndex(d.view.currentLineIndex+1)}else{let d=e.view.currentLineIndex;await r.gotoLineIndex(d+1)}},"next node",{args:a,menus:s}),t.addNodeAction("expandablePrev",async({args:u})=>{await e.action.nodePrev(u[0],f=>!!f.expandable)},"previous expandable node",{args:a,menus:s}),t.addNodeAction("expandableNext",async({args:u})=>{await t.nodeNext(u[0],f=>!!f.expandable)},"next expandable node",{args:a,menus:s}),t.addNodeAction("indentPrev",async({node:u,args:f})=>{var p;let d=(p=u.level)!=null?p:0;await t.nodePrev(f[0],m=>m.level!==d)},"previous indent node",{args:a,menus:s}),t.addNodeAction("indentNext",async({node:u,args:f})=>{var p;let d=(p=u.level)!=null?p:0;await t.nodeNext(f[0],m=>m.level!==d)},"next indent node",{args:a,menus:s}),t.addNodeAction("gotoSource",async({args:u})=>{let f=e.sources.find(d=>d.sourceType===u[0]);f&&await f.locator.gotoLineIndex(0)},"go to source"),t.addNodeAction("sourceNext",async()=>{let u=e.sources[await e.view.currentSourceIndex()+1];u?await u.locator.gotoLineIndex(0):await St()&&await e.sources[0].locator.gotoLineIndex(0)},"go to next source"),t.addNodeAction("sourcePrev",async()=>{let u=e.sources[await e.view.currentSourceIndex()-1];u?await u.locator.gotoLineIndex(0):await St()&&await e.sources[e.sources.length-1].locator.gotoLineIndex(0)},"go to previous source"),t.addNodeAction("modifiedPrev",async()=>{await r.gotoPrevMark("modified")},"go to previous modified"),t.addNodeAction("modifiedNext",async()=>{await r.gotoNextMark("modified")},"go to next modified"),t.addNodeAction("diagnosticPrev",async()=>{await r.gotoPrevMark("diagnosticError","diagnosticWarning")},"go to previous diagnostic"),t.addNodeAction("diagnosticNext",async()=>{await r.gotoNextMark("diagnosticError","diagnosticWarning")},"go to next diagnostic"),t.addNodeAction("gitPrev",async()=>{await r.gotoPrevMark("git")},"go to previous git changed"),t.addNodeAction("gitNext",async()=>{await r.gotoNextMark("git")},"go to next git changed");let l={args:[{name:"mark name",description:"string"}],menus:{modified:"modified",diagnosticWarning:"diagnosticWarning",diagnosticError:"diagnosticError",git:"git"}};t.addNodeAction("markPrev",async({args:u})=>{await r.gotoPrevMark(...u)},"go to previous mark",l),t.addNodeAction("markNext",async({args:u})=>{await r.gotoNextMark(...u)},"go to next mark",l),t.addNodeAction("preview",async({source:u,node:f,args:d})=>{let p=d[0];if(!p)return;let m=u.view.getLineByNode(f);m!==void 0&&await e.floatingPreview.previewNode(p,u,f,m)},"preview",{args:[{name:"preview strategy",description:Nc.join(" | ")}],menus:{labeling:"preview for node labeling",content:"preview for node content"}}),t.addNodeAction("previewOnHover",async({args:u})=>{let f=u[0];if(!f)return;let d=u[1];if(!d){f==="disable"&&e.floatingPreview.unregisterOnHover();return}let p=u[2]?parseInt(u[2]):0;f==="toggle"?e.floatingPreview.toggleOnHover(d,p):f==="enable"?e.floatingPreview.registerOnHover(d,p):e.floatingPreview.unregisterOnHover()},"preview on hover",{args:[{name:"sub action",description:yw.join(" | ")},{name:"preview strategy",description:Nc.join(" | ")},{name:"delay",description:"delay millisecond"}],menus:{"toggle:labeling":"toggle labeling","toggle:labeling:200":"toggle labeling with debounce","toggle:content":"toggle content","enable:content":"enable with content","enable:labeling":"enable with labeling"}}),t.addNodeAction("textobj",async({node:u,args:f})=>{var m;let d=e.view.currentLineIndex,p=(m=f[0])!=null?m:"line";if(p==="line")await o.command("normal! V");else if(p==="indent"){let h=e.view.flattenedNodes,g=Yn(h,d,!1,b=>{var S,I;return((S=u.level)!=null?S:0)>((I=b.level)!=null?I:0)});if(g===void 0)return;let x=Kn(h,d,!1,b=>{var S,I;return((S=u.level)!=null?S:0)>((I=b.level)!=null?I:0)});if(x===void 0)return;await o.command(`normal! ${g+2}GV${x}G`)}},"use visual mode selects",{args:[{name:"target",description:mw.join(" | ")},{name:"type",description:hw.join(" | ")}],menus:{"line:i":"line:i","line:a":"line:a","indent:i":"indent:i","indent:a":"indent:a"}}),t.addNodeAction("select",async({source:u,node:f})=>{u.selectedNodes.add(f),u.view.requestRenderNodes([f])},"select node",{select:"visual"}),t.addNodeAction("unselect",async({source:u,node:f})=>{u.selectedNodes.delete(f),u.view.requestRenderNodes([f])},"unselect node",{select:"visual"}),t.addNodeAction("toggleSelection",async({source:u,node:f})=>{u.selectedNodes.has(f)?await u.action.doAction("unselect",f):await u.action.doAction("select",f)},"toggle node selection",{select:"visual"}),t.addNodeAction("toggleHidden",async({source:u})=>{u.showHidden=!u.showHidden},"toggle visibility of hidden node",{reload:!0});let c=u=>{let[f,d]=u.split(/,|x/).map(p=>p.trim());return[f?parseInt(f):void 0,d?parseInt(d):void 0]};t.addNodeAction("resize",async({args:u})=>{let[f]=u;if(!f)return;let[d,p]=c(f);e.isFloating?await e.resize([d,p]):await e.resize([d]),await e.render()},"resize",{args:[{name:"size",description:"{WIDTH}x{HEIGHT} | {WIDTH},{HEIGHT}"}],menus:{path:{description:"resize the explorer window",args:"[size]",async actionArgs(){return[await $e("input a the size:","20,10","file")]}}}}),t.addNodeAction("adjustSize",async({args:u})=>{let[f]=u;if(!f)return;let[d,p]=c(f);e.isFloating?await e.adjustSize([d,p]):await e.adjustSize([d]),await e.render()},"adjust window size",{args:[{name:"size",description:"+-{WIDTH}x+-{HEIGHT} | +-{WIDTH},+-{HEIGHT}"}],menus:{path:{description:"resize the explorer window",args:"[size]",async actionArgs(){return[await $e("input a the size:","+20,-10","file")]}}}}),t.addNodeAction("refresh",async({source:u})=>{u.selectedNodes.clear(),await e.view.sync(async f=>{let d=await e.loadAllNotifier(f);o.pauseNotification(),u.highlight.clearHighlightsNotify(),d==null||d.notify(),await o.resumeNotification()})},"refresh"),t.addNodeAction("render",async({source:u,node:f})=>{await u.view.render({node:f})},"render"),t.addNodeAction("help",async({source:u})=>{await u.explorer.showHelp(u)},"show help"),t.addNodesAction("actionMenu",async({source:u,nodes:f})=>{await u.action.listActionMenu(f)},"show actions in coc-list",{select:"visual"}),t.addNodeAction("normal",async({args:u})=>{u[0]&&await o.command(`execute "normal ${u[0]}"`)},"execute vim normal mode commands",{args:[{name:"normal commands"}],menus:{zz:"execute normal zz"}}),t.addNodeAction("esc",async({source:u,mode:f})=>{u.explorer.isFloating&&f==="n"?await u.explorer.quit():(u.view.requestRenderNodes(Array.from(u.selectedNodes)),u.selectedNodes.clear())},"esc action"),t.addNodeAction("quit",async()=>{await e.quit()},"quit explorer")}var pe=require("coc.nvim"),_w=_(Pw());var Aw=require("coc.nvim");var ti=class{constructor(e){this.win=e;this.bufnr=this.win.bufnr}static async create(e={}){let r=await z.create({mode:"show",name:e.name});return new ti(r)}dispose(){this.win.dispose()}async open(e,r,o){this.closeTimer&&clearTimeout(this.closeTimer),await this.win.open({top:o.top,left:o.left,width:o.width,height:o.height,winHl:"CocExplorerNormalFloat",winHlNC:"CocExplorerNormalFloat",borderWinHl:"CocExplorerNormalFloatBorder",lines:e,highlights:r,focus:!1,initedExecute:({winid:i})=>{let n=[];return Aw.workspace.isNvim?(n.push(`
            let store_winid = win_getid(winnr())
            if store_winid != ${i}
              noau let successful = win_gotoid(${i})
              if !successful
                return
              endif
            endif
          `),n.push("set filetype="),o.focusLineIndex&&n.push(`call nvim_win_set_cursor(${o.focusLineIndex})`),!o.filetype&&o.filepath&&n.push(`execute 'doautocmd filetypedetect BufRead ' . fnameescape('${o.filepath}')`),o.filetype&&n.push(`set filetype=${o.filetype}`),n.push(`
            if store_winid != ${i}
              noau call win_gotoid(store_winid)
            endif
          `)):(n.push(`call win_execute(${i}, 'set filetype=')`),o.focusLineIndex&&n.push(`call win_execute(${i}, 'call cursor(${o.focusLineIndex}, 1)')`),!o.filetype&&o.filepath&&n.push(`call win_execute(${i}, 'doautocmd filetypedetect BufRead ' . fnameescape('${o.filepath}'))`),o.filetype&&n.push(`call win_execute(${i}, 'set filetype=${o.filetype}')`)),n.join(`
`)}})}async closeDelay(e){this.closeTimer&&clearTimeout(this.closeTimer),this.closeTimer=setTimeout(()=>{this.win.close().catch(E.error)},e)}async close(){await this.win.close()}};var as=class{constructor(e){this.explorer=e;this.shown=!1;this.disposables=[];this.preferTop=!1;this.onHoverStrategy=!1;this.nvim=pe.workspace.nvim;this.onHoverDisposables=[];this.registeredPreviewActions={};this.maxHeight=e.config.get("previewAction.content.maxHeight"),this.registerActions(),this.disposables.push(e.events.on("first-open-post",()=>{this.disposables.push(We("BufWinLeave",async o=>{o===this.explorer.bufnr&&await this.close()}),Vr(async o=>{var i;o!==this.explorer.bufnr&&o!==((i=this.previewWindow)==null?void 0:i.bufnr)&&await this.closeDelay(200)},0),mc(async o=>{this.onHoverStrategy||o!==this.explorer.bufnr||await this.closeDelay(200)},0),pe.Disposable.create(()=>{(0,pe.disposeAll)(this.onHoverDisposables)}));let r=e.config.get("previewAction.onHover");!r||(Array.isArray(r)?this.registerOnHover(r[0],r[1]):this.registerOnHover(r))}))}dispose(){var e;(e=this.previewWindow)==null||e.dispose()}async getPreviewWindow(){return this.previewWindow||(this.previewWindow=await ti.create()),this.previewWindow}async closeDelay(e){var r;await((r=this.previewWindow)==null?void 0:r.closeDelay(e))}async close(){var e;await((e=this.previewWindow)==null?void 0:e.close())}toggleOnHover(e,r){this.onHoverStrategy===e?this.unregisterOnHover():this.registerOnHover(e,r)}registerOnHover(e,r=300){if(this.onHoverStrategy===e)return;this.onHoverStrategy=e,(0,pe.disposeAll)(this.onHoverDisposables),this.onHoverDisposables=[];let o=async i=>{if(this.explorer.view.isHelpUI){await this.close();return}if(i!==this.explorer.bufnr)return;await this.explorer.view.refreshLineIndex();let n=await this.explorer.view.currentSource();if(!n)return;let a=n.view.currentNode();if(!a)return;let s=n.view.getLineByNode(a);s!==void 0&&await this.previewNode(e,n,a,s)};this.onHoverDisposables.push(mc(o,r),Vr(o,r)),Ke().then(o).catch(E.error),pe.window.showMessage(`Preview ${e} enabled`)}unregisterOnHover(){!this.onHoverStrategy||(this.onHoverStrategy=!1,(0,pe.disposeAll)(this.onHoverDisposables),this.onHoverDisposables=[],this.close().catch(E.error),pe.window.showMessage("Preview disabled "))}registerAction(e,r){this.registeredPreviewActions[e]=r}registerActions(){this.registerAction("labeling",async({source:e,node:r,nodeIndex:o})=>{var n;let i=await((n=e.view.sourcePainters)==null?void 0:n.drawNodeLabeling(r,o));if(!(!i||!await this.explorer.explorerManager.inExplorer()))return{lines:i.map(a=>a.content),highlights:ye(i.map((a,s)=>a.highlightPositions.map(l=>({hlGroup:l.group,line:s,colStart:l.start,colEnd:l.start+l.size})))),options:{filetype:"coc-explorer-labeling"}}}),this.registerAction("content",async({node:e})=>{if(e.expandable)return;let r;if(e.location)r=e.location;else if(e.fullpath)r=pe.Location.create(e.fullpath,pe.Range.create(0,0,0,0));else return;let{uri:o,range:i}=r;if(await(0,_w.isBinaryFile)(o)){pe.window.showMessage("Preview content skip binary");return}let n=pe.workspace.getDocument(o);return{lines:n?n.getLines(0,i.end.line+this.maxHeight):await Ph(o,0,i.end.line+this.maxHeight),highlights:[],options:{filepath:o,focusLineIndex:i.start.line}}})}borderOptions(){return{border_enable:!1,border_chars:[],title:""}}getDimension(e,r,o){if(r===0||o===0)return{width:0,height:0};let i=[];for(let s of e)i.push(tf(s.replace(/\t/g,"  ")));let n=Ii([Po(i),r]);if(n===void 0||n===0)return{width:0,height:0};let a=0;for(let s of i)a=a+Math.max(Math.ceil(s/n),1);return{width:n,height:Math.min(a,o)}}async getFloatOptions(e){let r=pe.workspace.env,o=r.columns,i=r.lines-r.cmdheight-1,n=this.explorer.argValues.position,a=n.name==="floating",s=await this.explorer.args.value(Pe.floatingPosition);if(!await this.explorer.win)return;let c=!1,f=await Ke()===this.explorer.bufnr?await this.nvim.call("winline"):1;f-=1;let d=a&&this.explorer.config.get("floating.border.enable")?await this.explorer.borderWin:await this.explorer.win;if(!d)return;let[p,m]=await this.nvim.call("win_screenpos",[d.id]);p-=1,m-=1;let h=await d.width,g=o-h-(a?0:1)-2,x=Ii([this.maxHeight,i]),{width:b,height:S}=this.getDimension(e,g,x);this.preferTop?(f>=x||f>=i-f)&&(c=!0):i-f<S&&f>S&&(c=!0);let I=p+(c?f-S+1:f),V;if(n.name==="left")V=m+h+2;else if(n.name==="right")V=m-b-2;else if(a&&s==="left-center")V=m+h+1;else if(a&&s==="right-center")V=m-b-1;else return;return N({top:I,left:V,width:b,height:S},this.borderOptions())}async previewNode(e,r,o,i){var l;if(!Vl())return;if(!this.registeredPreviewActions[e]){pe.window.showMessage(`coc-explorer no support preview strategy(${e})`);return}let n=await this.registeredPreviewActions[e]({source:r,node:o,nodeIndex:i});if(!n){await this.close();return}let a=await this.getPreviewWindow(),s=await this.getFloatOptions(n.lines);if(!s){await this.close();return}await a.open(n.lines,(l=n.highlights)!=null?l:[],N(N({},s),n.options))}};var ni=require("coc.nvim");var Yr=require("coc.nvim");var _c=class{constructor(){this.nvim=Yr.workspace.nvim;this.highlights=[]}linkGroup(e,r){let o=`CocExplorer${e}`,i=[`highlight default link ${o} ${r}`],n={group:o,commands:i};return this.highlights.push(n),n}createGroup(e,r){let o=`CocExplorer${e}`,i=[`highlight default ${o} ${r}`],n={group:o,commands:i};return this.highlights.push(n),n}async watchColorScheme(e,r,o=!0){e.push(Xi.events.on("ColorScheme",r)),o&&await r()}clearHighlightsNotify(e,r,o,i){e.buffer.clearNamespace(-1,o,i)}addHighlightsNotify(e,r,o){for(let i of o)i.size!==0&&e.buffer.highlightRanges(-1,i.group,[Yr.Range.create(Yr.Position.create(i.lineIndex,i.start),Yr.Position.create(i.lineIndex,i.start+i.size))])}bootHighlightSyntaxNotify(){let e=[];for(let r of this.highlights)this.nvim.command(`silent! syntax clear ${r.group}`,!0),e.push(...r.commands);this.nvim.call("coc_explorer#util#execute_commands",[e],!0)}},D=new _c;function Mw(t){if(!t.length)return[];let e=t.sort((i,n)=>i.nodeIndex-n.nodeIndex),r=[],o;for(let i=0,n=e.length;i<n;i++){let a=e[i];o?o.nodeIndexEnd+1===a.nodeIndex?(o.drawnList.push(a),o.nodeIndexEnd=a.nodeIndex):(r.push(o),i--,o=void 0):o={nodeIndexStart:a.nodeIndex,nodeIndexEnd:a.nodeIndex,drawnList:[a]}}return o&&r.push(o),r}var Mc=t=>se(t.map(e=>e.type==="content"?e.content.length:e.type==="group"?se(e.contents.map(r=>r.type==="content"?r.content.length:0)):0))===0;async function kw(t){async function e(r){return G(N({},r),{width:r.unicode&&!of(r.content)?await $h(r.content):r.content.length})}return fe(ye(await Promise.all(t.map(async r=>r.type==="content"?await e(r):r.type==="group"?G(N({},r),{contents:await Promise.all(fe(r.contents.map(o=>o.type==="content"?e(o):void 0)))}):r))))}function Rw(t,e,r){let o=t/se(e),i=new Array(e.length);if(r){for(let n=0;n<e.length;n++)Math.ceil(e[n]*o)>r[n]&&(i[n]=r[n],t-=r[n],e[n]=0);o=t/se(e)}for(let n=0;n<e.length;n++)if(i[n]===void 0){let a=Math.ceil(e[n]*o);a<=t?(t-=a,i[n]=a):i[n]=t}return i}async function Lw(t){return t.map(e=>{var r;if(e.type==="group"&&((r=e.flexible)==null?void 0:r.padding)&&e.flexible.paddingVolume){let o=se(e.contents.map(i=>i.type==="content"?i.width:0));if(e.flexible.paddingVolume>o){let i=e.flexible.paddingVolume;if(e.flexible.padding==="left")return G(N({},e),{contents:[{type:"content",content:" ".repeat(i),width:i},...e.contents]});if(e.flexible.padding==="right")return G(N({},e),{contents:[...e.contents,{type:"content",content:" ".repeat(i),width:i}]});if(e.flexible.padding==="center"){let n=Math.ceil(i/2),a=i-n;return G(N({},e),{contents:[{type:"content",content:" ".repeat(n),width:n},...e.contents,{type:"content",content:" ".repeat(a),width:a}]})}else return e}else return e}else return e})}async function Dw(t,e,r){let o=t-e,i=Rw(o,r.map(n=>{var a,s;return n.type==="group"&&((a=n.flexible)==null?void 0:a.grow)?(s=n.flexible.growVolume)!=null?s:1:0}));return fe(ye(await Promise.all(r.map(async(n,a)=>{var s;if(n.type==="content")return n;if(n.type==="group"){if(!((s=n.flexible)!=null&&s.grow))return n.contents;let l=i[a];if(n.flexible.grow==="left")return[{type:"content",content:" ".repeat(l),width:l},...n.contents];if(n.flexible.grow==="right")return[...n.contents,{type:"content",content:" ".repeat(l),width:l}];if(n.flexible.grow==="center"){let c=Math.floor(l/2),u=l-c;return[{type:"content",content:" ".repeat(c),width:c},...n.contents,{type:"content",content:" ".repeat(u),width:u}]}else return n.contents}}))))}var ss=D.linkGroup("OmitSymbol","SpecialComment");async function Bw(t,e,r){let o=e-t,i=Rw(o,r.map(n=>{var a,s;return n.type==="group"&&((a=n.flexible)==null?void 0:a.omit)?(s=n.flexible.omitVolume)!=null?s:1:0}),r.map(n=>n.type==="content"?n.width:n.type==="group"?se(n.contents.map(a=>a.type==="content"?a.width:0)):0));return fe(ye(await Promise.all(r.map(async(n,a)=>{var s;if(n.type==="content")return n;if(n.type==="group"){if(!((s=n.flexible)!=null&&s.omit))return n.contents;let l=i[a],c=[];if(n.flexible.omit==="left"){let f=l+1;for(let d of n.contents){if(d.type!=="content"){c.push(d);continue}f<0?c.push(d):f<d.width&&(c.push({type:"content",content:"\u2025",width:1,group:ss.group}),f>0&&c.push(G(N({},d),{content:await Wr(d.content,f),width:d.width-f}))),f-=d.width}return c}else if(n.flexible.omit==="right"){let u=l+1,d=se(n.contents.map(p=>p.type==="content"?p.width:0))-u;for(let p of n.contents){if(p.type!=="content"){c.push(p);continue}if(d>=p.width)c.push(p);else if(d<p.width){d>0&&c.push(G(N({},p),{content:await Wr(p.content,0,d),width:d})),c.push({type:"content",content:"\u2025",width:1,group:ss.group});break}d-=p.width}return c}else if(n.flexible.omit==="center"){let u=se(n.contents.map(b=>b.type==="content"?b.width:0)),f=l+1,d=u-f,p=Math.floor(d/2),m=u-(d-p),h=0,g=0,x=[];for(let b of n.contents){if(b.type!=="content"){x.push(b);continue}if(g+=b.width,h<p)if(g<=p)x.push(b);else if(g<=m){let S=p-h;x.push(G(N({},b),{content:await Wr(b.content,0,S),width:S})),x.push({type:"content",content:"\u2025",width:1,group:ss.group})}else{let S=p-h;x.push(G(N({},b),{content:await Wr(b.content,0,S),width:S})),x.push({type:"content",content:"\u2025",width:1,group:ss.group});let I=g-m;x.push(G(N({},b),{content:await Wr(b.content,b.width-I),width:I}))}else if(g>m)if(h>=m)x.push(b);else{let S=g-m;x.push(G(N({},b),{content:await Wr(b.content,b.width-S),width:S}))}h=g}return x}}}))))}var ri=class{constructor(e){this.explorer=e}get width(){return this.explorer.contentWidth}async drawRow(e){let r=new kc(this);return await e(r),r}},kc=class{constructor(e){this.view=e;this.drawableList=[]}async draw({flexible:e=!0}={}){let r=await Lw(await kw(this.drawableList)),o=[],i=this.view.width,n=se(r.map(c=>c.type==="content"?c.width:c.type==="group"?se(c.contents.map(u=>u.type==="content"?u.width:0)):0));!e||n===i?o=ye(r.map(c=>c.type==="group"?c.contents:c)):n<i?o=await Dw(i,n,r):n>i&&(o=await Bw(i,n,r));let a=[],s="",l=0;for(let c of o){let u=c.content.length;c.group&&a.push({group:c.group,start:l,size:u}),s+=c.content,l+=u}return{content:s,highlightPositions:a}}add(e,{hl:r,width:o,drawGroup:i,unicode:n=!1}={}){let a=r?typeof r=="string"?r:r.group:void 0,s={type:"content",content:e,unicode:n,group:a,width:o};i?i.contents.push(s):this.drawableList.push(s)}async drawBlockToList(e){let r=this.drawableList;this.drawableList=[],await e(this);let o=this.drawableList;return this.drawableList=r,o}async flexible(e,r){let o=await this.drawBlockToList(r);this.drawableList.push(this.flexibleForList(e,o))}flexibleForList(e,r){return{type:"group",contents:ye(r.map(o=>o.type==="content"?o:o.type==="group"?o.contents:o)),flexible:e}}async addColumn(e,r,o,i=!1){this.drawableList.push(...await this.columnToList(e,r,o,i))}async columnToList(e,r,o,i=!1){return await this.drawBlockToList(async()=>{var n;if(typeof o=="number"){this.add(" ".repeat(o));return}await((n=o.drawHandle)==null?void 0:n.drawNode(this,{node:e,nodeIndex:r,isLabeling:i}))})}async addTemplatePart(e,r,o,i=!1){if(typeof o=="string"){this.add(o);return}let n=[],a=o.column;n.push(...await this.columnToList(e,r,a,i));let s={},l=c=>typeof c=="number"?c:1;if(o.modifiers)for(let c of o.modifiers)c.name==="|"?Mc(n)&&n.push(...await this.columnToList(e,r,c.column,i)):c.name==="&"?Mc(n)||n.push(...await this.columnToList(e,r,c.column,i)):c.name==="growLeft"?(s.grow="left",s.growVolume=l(c.column)):c.name==="growCenter"?(s.grow="center",s.growVolume=l(c.column)):c.name==="growRight"?(s.grow="right",s.growVolume=l(c.column)):c.name==="omitLeft"?(s.omit="left",s.omitVolume=l(c.column)):c.name==="omitCenter"?(s.omit="center",s.omitVolume=l(c.column)):c.name==="omitRight"&&(s.omit="right",s.omitVolume=l(c.column));s.omit||s.grow?this.drawableList.push(this.flexibleForList(s,n)):this.drawableList.push(...n)}};var ii=require("coc.nvim");var oi={};async function Ww(t,e){let r=[...await Ze.getCommonKeys()],o=[["n",r],["v",[...r,...await Ze.getVisualKeys()]]];for(let[i,n]of o){oi[i]={};for(let a of n){if(oi[i][a]||i==="v"&&["o","j","k"].includes(a))continue;let s=`explorer-key-${i}-${a.replace(/<(.*)>/,"[$1]")}`;t.subscriptions.push(ii.workspace.registerKeymap([i],s,async()=>{let l=await ii.workspace.nvim.eval("v:count"),c=await e.currentExplorer();c==null||c.action.doActionByKey(a,i,l||1).catch(E.error)})),oi[i][a]=`<Plug>(coc-${s})`}}await ii.workspace.nvim.call("coc_explorer#mappings#register",[oi])}async function Fw(){await ii.workspace.nvim.call("coc_explorer#mappings#execute",[oi])}async function jw(){await ii.workspace.nvim.call("coc_explorer#mappings#clear",[oi])}var et=D.linkGroup.bind(D),J={line:et("HelpLine","Operator"),hint:et("HelpHint","Comment"),title:et("HelpTitle","Boolean"),subtitle:et("HelpSubTitle","Label"),mappingKey:et("HelpMappingKey","PreProc"),action:et("HelpAction","Identifier"),column:et("HelpColumn","Identifier"),arg:et("HelpArg","Identifier"),description:et("HelpDescription","Comment"),type:et("HelperType","Type"),conditional:et("HelpConditional","Conditional")},EO="coc-explorer-help",Rc=class{constructor(e,r,o){this.explorer=e;this.source=r;this.width=o;this.drawnResults=[];this.painter=new ri(e),this.registeredActions=this.source.action.registeredActions()}async drawRow(e){let r=await this.painter.drawRow(e);this.drawnResults.push(await r.draw())}async drawHr(){await this.drawRow(e=>{e.add("\u2014".repeat(this.width),{hl:J.line})})}async drawHead(){await this.drawRow(e=>{e.add("Help "),e.add("(use q, ? or <esc> return to explorer)",{hl:J.hint})}),await this.drawHr()}drawActionForMapping(e,r){e.add(r.name,{hl:J.action}),r.args&&e.add(`(${r.args.join(",")})`,{hl:J.arg}),e.add(" ");let o=this.registeredActions.get(r.name);o&&e.add(o.description,{hl:J.description})}anyAction(e,r){return Array.isArray(e)?e.some(o=>this.anyAction(o,r)):r(e)}drawMappingsPrefix(e,r,o){if(!o.isFirstLine){r.add(e);return}o.isFirstLine=!1,o.key&&(r.add(" "),r.add(o.key,{hl:J.mappingKey}),r.add(" - ")),o.isWait&&r.add(`${Ur.helpDescription} `,{hl:J.type})}async drawMappingsAction(e,r,o){await this.drawRow(i=>{if(this.drawMappingsPrefix(e,i,o),r.name===ir.name){i.add(ir.helpDescription,{hl:J.type});return}i.add(r.name,{hl:J.action}),r.args&&i.add(`(${r.args.join(",")})`,{hl:J.arg}),i.add(" ");let n=this.registeredActions.get(r.name);n&&i.add(n.description,{hl:J.description})})}async drawMappingsActionExp(e,r,o){if(Array.isArray(r))for(let i=0;i<r.length;i++){let n=r[i];if(Array.isArray(n)){await this.drawMappingsActionExp(e,n,o);continue}if(n.name===Ur.name){o.isFirstLine&&(o.isWait=!0);continue}let a=Yo[n.name];if(a){await this.drawRow(c=>{this.drawMappingsPrefix(e,c,o),c.add(`if ${a.getHelpDescription(n.args)}`,{hl:J.conditional})});let[s,l]=[r[i+1],r[i+2]];await this.drawMappingsActionExp(`${e}  `,s,o),await this.drawRow(c=>{c.add(e),c.add("else",{hl:J.conditional})}),await this.drawMappingsActionExp(`${e}  `,l,o),i+=2;continue}await this.drawMappingsAction(e,n,o)}else await this.drawMappingsAction(e,r,o)}async drawMappings(){await this.drawRow(o=>{o.add(`Mappings for source(${this.source.sourceType})`,{hl:J.title})});let e=async o=>{for(let[i,n]of Object.entries(o))!this.anyAction(n,a=>this.registeredActions.has(a.name)||a.name===ir.name)||await this.drawMappingsActionExp(" ".repeat(i.length+4),n,{key:i,isFirstLine:!0,isWait:!1})},r=await Ze.getMappings(this.source.sourceType);await e(r.all),await e(r.vmap)}async drawActions(){await this.drawRow(e=>{e.add(`Actions for source(${this.source.sourceType})`,{hl:J.title})});for(let[e,r]of this.registeredActions){if(await this.drawRow(o=>{o.add(" "),o.add(e,{hl:J.action}),o.add(" "),o.add(r.description,{hl:J.description})}),r.options.args){await this.drawRow(o=>{o.add("   "),o.add("args:",{hl:J.subtitle})});for(let o of r.options.args)await this.drawRow(i=>{i.add("     - "),i.add(o.name,{hl:J.arg}),o.description&&(i.add(" "),i.add(o.description,{hl:J.description}))})}if(r.options.menus){await this.drawRow(o=>{o.add("   "),o.add("menus:",{hl:J.subtitle})});for(let o of Mt.getNormalizeMenus(r.options.menus))await this.drawRow(i=>{i.add("     - "),i.add(`${e}:${o.args}`,{hl:J.action}),i.add(" "),i.add(o.description,{hl:J.description})})}}}async drawColumns(){await this.drawRow(r=>{r.add(`Columns for source(${this.source.sourceType})`,{hl:J.title})});let e=this.source.view.sourcePainters.columnRegistrar.registeredColumns;for(let[r,o]of e){await this.drawRow(i=>{i.add(`  Type: ${r}`,{hl:J.subtitle})});for(let[i]of o)await this.drawRow(n=>{n.add("   - "),n.add(i,{hl:J.column})})}}async render(){ni.workspace.nvim.pauseNotification(),this.explorer.setLinesNotifier(this.drawnResults.map(r=>r.content),0,-1).notify();let e=[];for(let[r,o]of this.drawnResults.entries())o.highlightPositions&&e.push(...o.highlightPositions.map(i=>N({lineIndex:r},i)));this.explorer.highlight.addHighlightsNotify(EO,e),await ni.workspace.nvim.resumeNotification()}};async function Hw(t,e){var a,s;t.view.isHelpUI=!0;let r=await t.view.currentNode(),o=(s=await((a=await t.win)==null?void 0:a.width))!=null?s:80,i=new Rc(t,e,o);await i.drawHead(),await i.drawMappings(),await i.drawHr(),await i.drawActions(),await i.drawHr(),await i.drawColumns(),await i.render(),await jw();let n=[];["<esc>","q","?"].forEach(l=>{n.push(ni.workspace.registerLocalKeymap("n",l,async()=>{(0,ni.disposeAll)(n),await Lc(t),await t.view.sync(async c=>{await v.runAll([await c.renderAllNotifier(),await e.locator.gotoNodeNotifier(r)])})},!0))})}async function Lc(t){await Fw(),t.view.isHelpUI=!1}var ai=require("coc.nvim");var ls=class{constructor(e){this.explorer=e}clearHighlightsNotify(e,r,o){D.clearHighlightsNotify(this.explorer,e,r,o)}addHighlightsNotify(e,r){D.addHighlightsNotify(this.explorer,e,r)}async bootSyntax(){let e=await this.explorer.winnr,r=await ai.workspace.nvim.call("winnr");e&&(ai.workspace.nvim.pauseNotification(),e!==r&&ai.workspace.nvim.command(`${e}wincmd w`,!0),D.bootHighlightSyntaxNotify(),e!==r&&ai.workspace.nvim.command(`${r}wincmd w`,!0),await ai.workspace.nvim.resumeNotification())}};var us=require("coc.nvim");var cs=class{constructor(e){this.explorer=e;this.marksGroupByType=new Map}add(e,r){this.marksGroupByType.has(e)||this.marksGroupByType.set(e,new Set),this.marksGroupByType.get(e).add(r)}remove(e,r){this.marksGroupByType.has(e)||this.marksGroupByType.set(e,new Set),this.marksGroupByType.get(e).delete(r)}removeAll(){this.marksGroupByType.clear()}removeLines(e,r=1/0){if(Array.isArray(e))this.marksGroupByType.forEach(o=>{e.forEach(i=>{o.delete(i)})});else{let o=e;this.marksGroupByType.forEach(i=>{i.forEach(n=>{o<=n&&n<=r&&i.delete(n)})})}}offsetLines(e,r,o=1/0){e!==0&&this.marksGroupByType.forEach((i,n)=>{let a=new Set;i.forEach(s=>{a.add(r<=s&&s<=o?s+e:s)}),this.marksGroupByType.set(n,a)})}async prevLineIndex(...e){let r=[];for(let o of e){let i=this.marksGroupByType.get(o);r=r.concat(i?Array.from(i):[])}if(r.length){let o=this.explorer.view.currentLineIndex,i=r.sort((a,s)=>s-a),n=i.find(a=>a<o);if(n)return n;if(await St())return i[0]}}async nextLineIndex(...e){let r=[];for(let o of e){let i=this.marksGroupByType.get(o);r=r.concat(i?Array.from(i):[])}if(r.length){let o=this.explorer.view.currentLineIndex,i=r.sort((a,s)=>a-s),n=i.find(a=>a>o);if(n)return n;if(await St())return i[0]}}};var fs=class{constructor(e){this.explorer=e;this.mark=new cs(this.explorer),this.view=this.explorer.view}async gotoPrevMark(...e){let r=await this.mark.prevLineIndex(...e);return r?(await this.gotoLineIndex(r),!0):!1}async gotoNextMark(...e){let r=await this.mark.nextLineIndex(...e);return r?(await this.gotoLineIndex(r),!0):!1}async gotoLineIndex(e){return(await this.gotoLineIndexNotifier(e)).run()}async gotoLineIndexNotifier(e,r){let o=await this.explorer.win;return v.create(()=>{if(o){let i=this.explorer.height;e<0?e=0:e>=i&&(e=i-1),this.view.currentLineIndex=e,o.setCursor([e+1,r!=null?r:0],!0),us.workspace.isVim?us.workspace.nvim.command("redraw",!0):us.workspace.nvim.command("redraw!",!0)}})}};var Gw=require("coc.nvim");var $w=require("coc.nvim");async function ds(t){let e=await $w.workspace.nvim.call("coc_explorer#highlight#extract_colors",[t]);return Object.entries(e).map(([r,o])=>{let i={};return o.ctermfg&&(i.ctermfg=o.ctermfg),o.ctermbg&&(i.ctermbg=o.ctermbg),o.guifg&&(i.guifg=Gi(o.guifg)),o.guibg&&(i.guibg=Gi(o.guibg)),[r,i]}).reduce((r,[o,i])=>(r[o]=i,r),{})}var Dc={Error:"ErrorColor",Comment:"CommentColor",Normal:"NormalColor",CocErrorSign:"CocErrorSignColor",CocWarningSign:"CocWarningSignColor"},Uw=t=>{D.watchColorScheme(t,async()=>{let e=Object.keys(Dc),r=await ds(e),{nvim:o}=Gw.workspace;o.pauseNotification();for(let i of e){let n=r[i],a=Hh(`CocExplorer${Dc[i]}_Internal`,n);!a||o.command(a,!0)}await o.resumeNotification()}).catch(E.error)},Ee={};Object.values(Dc).forEach(t=>{Ee[t]=`CocExplorer${t}_Internal`});var Nt=require("coc.nvim");var qw=_(xc());var ps=class{constructor(e,r){this.s=e;this.i=r}ch(){return this.s[this.i]}skip(e){this.i+=e}next(){this.i+=1}forwardString(e){return this.s.slice(this.i,this.i+e)}match(e,r={}){var o;return this.forwardString(e.length)===e?((o=r.skip)!=null&&o&&this.skip(e.length),!0):!1}end(){return this.i>=this.s.length}},tn=class extends Error{constructor(r,o){super(o);this.source=r}};function Bc(t,e,r){let o="";for(;!e.end();){let i=e.ch();if(!r.includes(i))o+=i,e.next();else return o}throw new tn(e,`Unexpected end when parse ${t}`)}function SO(t){return Bc("modifier name",t,[" "])}function TO(t){return Bc("modifier value",t,[" ","]"])}function NO(t){let e=SO(t);t.next();let r=TO(t);return{name:e,column:r}}function CO(t){let e=[];do{let r=t.ch();if(r===" ")t.next(),e.push(NO(t));else if(r==="]")return e}while(!0)}function IO(t){return Bc("column name",t,[" ","]"])}function OO(t){t.next();let e={column:IO(t)};do{let r=t.ch();if(r==="]")return t.next(),e;r===" "&&(e.modifiers=CO(t))}while(!t.end());throw new tn(t,"Unexpected end when parse column block")}function PO(t){let e="";for(;!t.end();){let r=t.ch();if(r==="\\")t.next(),e+=t.ch();else{if(r==="[")return e;e+=r}t.next()}return e}function Wc(t){let e=new ps(t,0),r=[];for(;!e.end();)e.ch()==="["?r.push(OO(e)):r.push(PO(e));return r}var AO=D.linkGroup("Label","Label"),Fc=class{constructor(e,r,o,i){this.type=e;this.painters=r;this.source=o;this.columnRegistrar=i;this.columns=new Set;this.parts=[];this.labelingParts=[]}dispose(){this.clearParts(this.parts)}clearColumn(e){typeof e!="number"&&e.subscriptions.map(r=>r.dispose())}clearParts(e){e.forEach(r=>{var o;typeof r!="string"&&(this.clearColumn(r.column),(o=r.modifiers)==null||o.forEach(i=>this.clearColumn(i.column)))})}async parseTemplate(e,r){let o=!1;if(this.templateStr!==e){this.templateStr=e;let i=[];for(let n of Wc(e)){let a=await this.initPart(n);a&&i.push(a)}this.clearParts(this.parts),this.parts=i,o=!0}if(r&&this.labelingTemplateStr!==r){this.labelingTemplateStr=r;let i=[];for(let n of Wc(r)){let a=await this.initPart(n);a&&i.push(a)}this.clearParts(this.labelingParts),this.labelingParts=i,o=!0}if(o){let i=new Set,n=[...this.parts,...this.labelingParts];for(let a of n)if(typeof a!="string"&&(typeof a.column!="number"&&i.add(a.column),a.modifiers))for(let s of a.modifiers)typeof s.column!="number"&&i.add(s.column);this.columns=i}}async initPart(e){if(typeof e=="string")return e;let r=await this.columnRegistrar.initColumn(this.type,this.source,e.column);if(!r)return;let o={column:r};if(e.modifiers){let i=await Promise.all(e.modifiers.map(async n=>{let a=await this.columnRegistrar.initColumn(this.type,this.source,n.column);if(!!a)return{name:n.name,column:a}}));o.modifiers=fe(i)}return o}},ms=class{constructor(e,r){this.source=e;this.columnRegistrar=r;this.painters=new Map;this.viewPainter=new ri(this.source.explorer)}dispose(){this.painters.forEach(e=>e.dispose())}getPainter(e){return this.painters.has(e)||this.painters.set(e,new Fc(e,this,this.source,this.columnRegistrar)),this.painters.get(e)}async parseTemplate(e,r,o){return await this.getPainter(e).parseTemplate(r,o)}async load(e){for(let r of this.painters.values())for(let o of r.columns)await(o.load&&o.load(e))}async drawPre(e,{draw:r,drawAll:o,abort:i,force:n=!1}={}){class a extends Error{}class s extends Error{}let l=Un(e,u=>u.type),c=Object.keys(l);for(let u of c){let f=this.getPainter(u);for(let d of f.columns)try{d.drawHandle=await d.draw(l[u],{drawAll(){if(o)throw new a},abort(){throw new s},force:n})}catch(p){if(p instanceof a)return o();if(p instanceof s){if(i)return i()}else throw p}}return r==null?void 0:r()}async drawNode(e,r,{isLabeling:o=!1}={}){let n=await(await this.viewPainter.drawRow(async a=>{for(let s of this.getPainter(e.type).parts)await a.addTemplatePart(e,r,s,o)})).draw();return{nodeIndex:r,nodeUid:e.uid,content:n.content,highlightPositions:n.highlightPositions}}async drawNodeLabeling(e,r){var i,n;let o=[];for(let a of this.getPainter(e.type).labelingParts){if(typeof a=="string"){o.push({content:a,highlightPositions:[]});continue}let s=[a.column,...(n=(i=a.modifiers)==null?void 0:i.map(m=>m.name==="&"?m.column:""))!=null?n:[]].filter(m=>typeof m!="string"),l=await(0,qw.default)(s,async m=>{var h;return!((h=m.drawHandle)!=null&&h.labelVisible)||await m.drawHandle.labelVisible({node:e,nodeIndex:r})});if(!l.length)continue;let c=l.every(m=>{var h;return(h=m.drawHandle)==null?void 0:h.labelOnly}),u=l.filter(async m=>{var h;return!((h=m.drawHandle)!=null&&h.labelOnly)}),f=await this.viewPainter.drawRow(async m=>{m.add(l.map(h=>h.label).join(" & ")+(c?"":":"),{hl:AO}),m.add(" ");for(let h of u)await m.addColumn(e,r,h,!0)}),{highlightPositions:d,content:p}=await f.draw({flexible:!1});o.push({content:p,highlightPositions:d})}return o}};var Vw=require("coc.nvim");var rn=require("coc.nvim");var Kr=Symbol("rendererSource"),hs=class{constructor(e,r=e.explorer,o=e.source){this.view=e;this.explorer=r;this.source=o;this.requestedRenderNodes=new Set}nodeAndChildrenRange(e){var n,a;let r=this.view.flattenedNodes.findIndex(s=>s.uid===e.uid);if(r===-1)return;let o=(n=e.level)!=null?n:0,i=this.view.flattenedNodes.length-1;for(let s=r+1,l=this.view.flattenedNodes.length;s<l;s++)if(((a=this.view.flattenedNodes[s].level)!=null?a:0)<=o){i=s-1;break}return{startIndex:r,endIndex:i}}async drawNodes(e){let r=fe(await Promise.all(e.map(async i=>{let n=this.view.flattenedNodes.findIndex(s=>s.uid===i.uid);if(n<0)return;let a=this.view.flattenedNodes[n];if(!!a)return this.view.sourcePainters.drawNode(a,n)}))),o=this.view.startLineIndex;return{drawnList:r,get contents(){return r.map(i=>i.content)},get highlightPositions(){return ye(r.map(i=>i.highlightPositions.map(n=>N({lineIndex:o+i.nodeIndex},n))))}}}async emitRequestRenderNodesNotifier(){if(this.requestedRenderNodes.size<=0)return;let e=Array.from(this.requestedRenderNodes);return this.requestedRenderNodes.clear(),this.renderNodesNotifier(e)}async renderPathsNotifier(e){if(this.view.isHelpUI)return v.noop();let r=e instanceof Set?Array.from(e):e;if(!r.length)return v.noop();let o=n=>this.view.flattenedNodes.filter(a=>a.fullpath&&n.includes(a.fullpath)),i=r.map(n=>typeof n=="string"?{nodes:o([n])}:{nodes:o([...n.paths]),withParents:n.withParents,withChildren:n.withChildren});return this.renderNodesNotifier(i)}async renderNodesNotifier(e){let o=(e instanceof Set?Array.from(e):e).map(n=>{var a,s;return"uid"in n?{nodes:[n],withParents:!1,withChildren:!1}:{nodes:[...n.nodes],withParents:(a=n.withParents)!=null?a:!1,withChildren:(s=n.withChildren)!=null?s:!1}}),i=[];for(let n of o){if(i.push(...n.nodes),n.withParents)for(let a of n.nodes)i.push(...this.view.flattenParents(a));if(n.withChildren)for(let a of n.nodes)i.push(...this.view.flattenNode(a))}return i.length?await this.view.sourcePainters.drawPre(i,{draw:async()=>{let{drawnList:n,highlightPositions:a}=await this.drawNodes(i),s=Mw(n);return await this.source.events.fire("drawn"),v.create(()=>{s.forEach(l=>{this.view.setLinesNotifier(l.drawnList.map(c=>c.content),l.nodeIndexStart,l.nodeIndexEnd+1).notify()}),this.source.highlight.addHighlightsNotify(a),rn.workspace.isVim&&rn.workspace.nvim.command("redraw",!0)})},drawAll:()=>this.renderNotifier(),abort:()=>v.noop()}):v.noop()}async renderNotifier({node:e=this.view.rootNode,force:r=!1}={}){if(this.view.isHelpUI)return v.noop();let o=this.nodeAndChildrenRange(e);if(!o&&!e.isRoot)return v.noop();let{startIndex:i,endIndex:n}=o||{startIndex:0,endIndex:this.view.flattenedNodes.length-1},a=n-i+1,s=this.view.flattenNode(e),l=s.length;this.view.flattenedNodes=this.view.flattenedNodes.slice(0,i).concat(s).concat(this.view.flattenedNodes.slice(n+1)),l<a&&this.explorer.locator.mark.removeLines(this.view.startLineIndex+l+1,this.view.startLineIndex+a+1),this.source.locator.mark.offsetAfterLine(l-a,this.view.endLineIndex),await this.view.sourcePainters.drawPre(s,{force:r});let{contents:c,highlightPositions:u}=await this.drawNodes(s);await this.source.events.fire("drawn");let f=this.view.currentSourceIndex(),d=this.explorer.sources.length-1===f;return v.create(()=>{this.explorer.setLinesNotifier(c,this.view.startLineIndex+i,d&&e.isRoot?-1:this.view.startLineIndex+i+a).notify(),this.source.highlight.addHighlightsNotify(u),rn.workspace.isVim&&rn.workspace.nvim.command("redraw",!0)})}};var si=Symbol("rendererExplorer"),gs=class{constructor(e,r=e.explorer){this.view=e;this.explorer=r;this.renderMutex=new Vw.Mutex}async runQueue(e){let r=await this.renderMutex.acquire();setTimeout(()=>{r&&(r(),r=void 0,E.error("view.sync timeout, force render, view.sync may cause deadlock due to recursive calls"))},5e3);try{return await e()}finally{r(),r=void 0}}rendererSources(){return this.explorer.sources.map(e=>e.view[Kr])}async renderAllNotifier(){let e=await Promise.all(this.rendererSources().map(r=>r.renderNotifier({force:!0})));return v.combine(e)}};var ws=class{constructor(e){this.viewSource=e;this.internal=(()=>{let e={records:new Map,store(r){return e.records.has(r.uid)||e.records.set(r.uid,{expanded:!1,compact:"uncompact"}),e.records.get(r.uid)},clear(){e.records.clear()},get(r,o){return e.store(r)[o]},set(r,o,i){e.store(r)[o]=i}};return e})();let r=e.source.context,o=e.config.get("expandStores");typeof o=="boolean"?this.enabled=o:"includes"in o?this.enabled=o.includes.includes(this.viewSource.source.sourceType):"excludes"in o?this.enabled=!o.excludes.includes(this.viewSource.source.sourceType):this.enabled=!0,r.subscriptions.push(e.source.explorer.events.on("open-pre",()=>{this.enabled||this.internal.clear()}))}setExpanded(e,r){r?this.expand(e):this.collapse(e)}expand(e){this.internal.set(e,"expanded",!0)}collapse(e){this.internal.set(e,"expanded",!1)}isExpanded(e){return this.internal.get(e,"expanded")}setCompact(e,r){this.internal.set(e,"compact",r)}getCompact(e){return this.internal.get(e,"compact")}};var lr=class{constructor(e,r,o){this.source=e;this.columnRegistrar=r;this.rootNode=o;this.flattenedNodes=[];this.startLineIndex=0;this.endLineIndex=0;this.rootExpandedForOpen=!1;this.explorer=this.source.explorer,this.nodeStores=new ws(this),this.sourcePainters=new ms(this.source,this.columnRegistrar),this[Kr]=new hs(this)}get isHelpUI(){return this.explorer.view.isHelpUI}get config(){return this.source.config}async sync(e){return await this.explorer.view[si].runQueue(()=>e(this[Kr]))}requestRenderNodes(e){for(let r of e)this[Kr].requestedRenderNodes.add(r)}dispose(){this.sourcePainters.dispose()}bootInit(e){this.rootExpandedForOpen=e}bootOpen(){this.nodeStores.setExpanded(this.rootNode,this.rootExpandedForOpen)}async load(e){await this.sourcePainters.load(e)}async parseTemplate(e,r,o){return await this.sourcePainters.parseTemplate(e,r,o)}get currentLineIndex(){return this.explorer.view.currentLineIndex-this.startLineIndex}currentNode(){return this.flattenedNodes[this.currentLineIndex]}currentSourceIndex(){let e=this.explorer.sources.indexOf(this.source);return e===-1?void 0:e}getNodeByLine(e){return this.flattenedNodes[e]}getLineByNode(e){if(e){let r=this.flattenedNodes.findIndex(o=>o.uid===e.uid);return r===-1?void 0:r}else return 0}setLinesNotifier(e,r,o){return this.explorer.setLinesNotifier(e,this.startLineIndex+r,this.startLineIndex+o)}replaceNodeInSibling(e,r){var o;if((o=e.parent)!=null&&o.children){let i=e.parent.children.indexOf(e);i!==-1&&(e.parent.children.splice(i,1,r),r.level=e.level,r.parent=e.parent,r.prevSiblingNode=e.prevSiblingNode,r.nextSiblingNode=e.nextSiblingNode)}}flattenParents(e){let r=e,o=[];for(;r.parent;)o.push(r.parent),r=r.parent;return o}flattenNode(e){var i,n,a;let r=[],o=[e];for(;o.length;){let s=o.shift();if(!s.isRoot){let l=this.nodeStores.getCompact(s);if(l==="compact"){if(!s.compactedNodes&&((i=s.children)==null?void 0:i.length)===1&&s.children[0].expandable){let c=s.children[0],u=[s,c];for(;((n=c.children)==null?void 0:n.length)===1&&c.children[0].expandable;)this.nodeStores.setCompact(c,"compact"),c=c.children[0],u.push(c);this.nodeStores.setCompact(c,"compact");let f=Qs(c);f.name=u.map(d=>d.name).join("/"),f.compactedNodes=u,f.compactedLastNode=c,this.replaceNodeInSibling(s,f),s=f}}else if(l==="uncompact"&&s.compactedNodes){let c=s.compactedNodes[0];for(let u of s.compactedNodes)this.nodeStores.setCompact(u,"uncompact");this.replaceNodeInSibling(s,c),s=c}}if(r.push(s),s.children)for(let l=s.children.length-1;l>=0;l--)s.children[l].parent=s,s.children[l].level=((a=s.level)!=null?a:0)+1,o.unshift(s.children[l])}return r}isExpanded(e){return this.nodeStores.isExpanded(e)}async expandRender(e){this.isHelpUI||!this.isExpanded(e)||!e.children||await this.sync(async r=>{let o=r.nodeAndChildrenRange(e);if(!o)return;let{startIndex:i,endIndex:n}=o,a=this.flattenNode(e);await this.sourcePainters.drawPre(a,{draw:async()=>{this.flattenedNodes=this.flattenedNodes.slice(0,i).concat(a).concat(this.flattenedNodes.slice(n+1)),this.source.locator.mark.offsetAfterLine(a.length-1-(n-i),i);let{contents:s,highlightPositions:l}=await r.drawNodes(a);await this.source.events.fire("drawn"),Nt.workspace.nvim.pauseNotification(),this.setLinesNotifier(s,i,n+1).notify(),this.source.highlight.addHighlightsNotify(l),Nt.workspace.isVim&&Nt.workspace.nvim.command("redraw",!0),await Nt.workspace.nvim.resumeNotification()},drawAll:async()=>(await r.renderNotifier()).run()})})}async expandRecursive(e,r){var s,l,c,u;let o=this.config.get("autoExpandOptions"),i=(s=r.compact)!=null?s:o.includes("compact"),n=(l=r.uncompact)!=null?l:o.includes("uncompact"),a=(c=r.recursiveSingle)!=null?c:o.includes("recursiveSingle")||i;if(e.expandable){let f=(u=r.depth)!=null?u:1,d=this.isExpanded(e);if(this.nodeStores.expand(e),e.children||(e.children=await this.source.loadInitedChildren(e,{recursiveExpanded:!0})),f>this.config.get("autoExpandMaxDepth"))return;let p=e.children.length===1&&e.children[0].expandable,m=this.nodeStores.getCompact(e);m==="uncompact"?p&&i&&this.nodeStores.setCompact(e,"compact"):m==="compact"&&(d&&n?this.nodeStores.setCompact(e,"uncompact"):this.nodeStores.setCompact(e,"compact")),(r.recursive||p&&a)&&await Promise.all(e.children.map(async h=>{await this.expandRecursive(h,G(N({},r),{depth:f+1}))}))}}async expand(e,r={}){var o;await this.expandRecursive(e,r),((o=r.render)==null||o)&&await this.expandRender(e)}async collapseRender(e){this.isHelpUI||this.isExpanded(e)||await this.sync(async r=>{let o=r.nodeAndChildrenRange(e);!o||await this.sourcePainters.drawPre([e],{draw:async()=>{let{startIndex:i,endIndex:n}=o;this.flattenedNodes.splice(i+1,n-i),this.explorer.locator.mark.removeLines(this.startLineIndex+i+1,this.startLineIndex+n),this.source.locator.mark.offsetAfterLine(-(n-i),n);let a=await this.source.locator.gotoLineIndexNotifier(i,0),{contents:s,highlightPositions:l}=await r.drawNodes([e]);await this.source.events.fire("drawn"),Nt.workspace.nvim.pauseNotification(),this.setLinesNotifier(s,i,n+1).notify(),this.source.highlight.addHighlightsNotify(l),a.notify(),Nt.workspace.isVim&&Nt.workspace.nvim.command("redraw",!0),await Nt.workspace.nvim.resumeNotification()},drawAll:async()=>(await r.renderNotifier()).run()})})}async collapseRecursive(e,r){if(e.expandable){this.nodeStores.collapse(e);let o=e.children;if(!o)return;if(e.children=void 0,r||this.config.get("autoCollapseOptions").includes("recursive"))for(let i of o)await this.collapseRecursive(i,r)}}async collapse(e,{recursive:r=!1}={}){await this.collapseRecursive(e,r),await this.collapseRender(e)}async renderNodes(e){return await this.sync(async r=>{await(await r.renderNodesNotifier(e)).run()})}async renderPaths(e){await this.sync(async r=>{await(await r.renderPathsNotifier(e)).run()})}async render(e){await this.sync(async r=>{var o;await((o=await r.renderNotifier(e))==null?void 0:o.run())})}};Kr;var jc=require("coc.nvim");var xs=class extends Jo{constructor(r,o){super(r);this.owner=r;this.source=this.owner;this.global=o}registeredActions(){return new Map([...this.global.actions,...this.actions])}registeredAction(r){return this.actions.get(r)||this.global.actions.get(r)}async doActionExp(r,o,i={}){var u,f;let n=(u=i.mode)!=null?u:"n",a=(f=i.isSubAction)!=null?f:!1,s,l=o,c={mode:n,isSubAction:!0};try{if(Array.isArray(r))for(let d=0;d<r.length;d++){d!==0&&(l=[this.source.view.currentNode()]);let p=r[d];if(Array.isArray(p)){await this.doActionExp(p,l,c);continue}if(p.name===Ur.name){let h=this.source.config.get("mapping.action.wait.timeout");if(h===0||s||a)continue;s=await this.global.waitActionMutex.acquire(),setTimeout(()=>{s&&(E.warn(`action(${JSON.stringify(r)}) timeout`),s(),s=void 0)},h);continue}let m=Yo[p.name];if(m){let[h,g]=Ao(l,S=>m.filter(this.source,S,p.args)),[x,b]=[r[d+1],r[d+2]];d+=2,h.length&&await this.doActionExp(x,h,c),g.length&&await this.doActionExp(b,g,c)}else await this.doActionExp(p,l,c)}else r.name!==ir.name&&await this.doAction(r.name,l,r.args,n)}finally{s==null||s(),s=void 0}}async doAction(r,o,i=[],n="n"){let a=this.registeredAction(r);if(!a)return;let{select:s=!1,render:l=!1,reload:c=!1}=a.options,u=Array.isArray(o)?o:[o],f=this.source;try{if(s===!0){let d=Oi([...u,...f.selectedNodes]);f.selectedNodes.clear(),f.view.requestRenderNodes(d),await a.callback.call(f,{source:f,nodes:d,args:i,mode:n})}else if(s===!1)await a.callback.call(f,{source:f,nodes:[u[0]],args:i,mode:n});else if(s==="visual")await a.callback.call(f,{source:f,nodes:u,args:i,mode:n});else if(s==="keep"){let d=Oi([...u,...f.selectedNodes]);await a.callback.call(f,{source:f,nodes:d,args:i,mode:n})}}finally{c?await f.load(f.view.rootNode):l&&await f.view.render()}}async listActionMenu(r){var s;let o=this.registeredActions(),i=this.source,n=await Ze.getReversedMappings(i.sourceType),a=await Gr(this.source.explorer,Vg,ye([...o.entries()].filter(([l])=>l!=="actionMenu").sort(([l],[c])=>l.localeCompare(c)).map(([l,{callback:c,options:u,description:f}])=>{var h;let d=n[l],p=d?(h=d.vmap)!=null?h:d.all:"",m=[{name:l,key:p,description:f,callback:async()=>{await a.waitExplorerShow(),await c.call(i,{source:i,nodes:r,args:[],mode:"n"})}}];return u.menus&&m.push(...Mt.getNormalizeMenus(u.menus).map(g=>{var I;let x=`${l}:${g.args}`,b=n[x],S=b?(I=b.vmap)!=null?I:b.all:"";return{name:x,key:S,description:`${f} ${g.description}`,callback:async()=>{await a.waitExplorerShow(),await c.call(i,{source:i,nodes:r,args:await g.actionArgs(),mode:"n"})}}})),m})));(s=a.waitExplorerShow())==null||s.catch(E.error)}};var bs=class{constructor(e,r){this.source=e;this.hlSrcId=r}addHighlightsNotify(e){this.source.explorer.highlight.addHighlightsNotify(this.hlSrcId,e)}clearHighlightsNotify(e,r){this.source.explorer.highlight.clearHighlightsNotify(this.hlSrcId,e,r)}};var ys=class{constructor(e){this.source=e;this.explorer=e.explorer}get view(){return this.source.view}add(e,r){this.explorer.locator.mark.add(e,this.view.startLineIndex+r)}remove(e,r){this.explorer.locator.mark.remove(e,this.view.startLineIndex+r)}offsetAfterLine(e,r){this.explorer.locator.mark.offsetLines(e,this.view.startLineIndex+r+1),this.view.endLineIndex+=e;let o=this.view.currentSourceIndex();o!==void 0&&this.explorer.sources.slice(o+1).forEach(i=>{i.view.startLineIndex+=e,i.view.endLineIndex+=e})}};var vs=class{constructor(e){this.source=e;this.explorer=this.source.explorer,this.mark=new ys(e)}get view(){return this.source.view}async gotoLineIndex(e,r){return(await this.gotoLineIndexNotifier(e,r)).run()}gotoLineIndexNotifier(e,r){return e<0&&(e=0),e>=this.source.height&&(e=this.source.height-1),this.explorer.locator.gotoLineIndexNotifier(this.view.startLineIndex+e,r)}async gotoRoot({col:e}={}){return(await this.gotoLineIndexNotifier(0,e)).run()}gotoRootNotifier({col:e}={}){return this.gotoLineIndexNotifier(0,e)}async gotoNode(e,r={}){return(await this.gotoNodeNotifier(e,r)).run()}async gotoNodeNotifier(e,r={}){return this.gotoNodeUidNotifier(e.uid,r)}async gotoNodeUid(e,r={}){return(await this.gotoNodeUidNotifier(e,r)).run()}async gotoNodeUidNotifier(e,{lineIndex:r,col:o=0}={}){let i=this.view.flattenedNodes.findIndex(n=>n.uid===e);return i!==-1?this.gotoLineIndexNotifier(i,o):r!==void 0?this.gotoLineIndexNotifier(r,o):v.noop()}};var cr=class{constructor(e,r){this.sourceType=e;this.explorer=r;this.width=0;this.showHidden=!1;this.selectedNodes=new Set;this.nvim=jc.workspace.nvim;this.bufManager=this.explorer.explorerManager.bufManager;this.events=new ht(E);this.action=new xs(this,this.explorer.action);this.locator=new vs(this);this.disposables=[];this.isDisposed=!1;this.config=this.explorer.config;this.icons=(e=>({get expanded(){return e.config.get("icon.expanded")||(e.config.get("icon.enableNerdfont")?"\uF44B":"-")},get collapsed(){return e.config.get("icon.collapsed")||(e.config.get("icon.enableNerdfont")?"\uF44A":"+")},get selected(){return e.config.get("icon.selected")},get hidden(){return e.config.get("icon.hidden")},get link(){return e.config.get("icon.link")},get readonly(){return e.config.get("icon.readonly")||(e.config.get("icon.enableNerdfont")?"\uF023":"RO")}}))(this);this.helper=(e=>({getUid(r){return ga(r.toString(),e.sourceType)}}))(this);this.context=this.explorer.context,this.highlight=new bs(this,`coc-explorer-${e}`)}get root(){return jc.workspace.cwd}set root(e){}static get enabled(){return!0}dispose(){this.isDisposed=!0,this.view.dispose(),this.disposables.forEach(e=>e.dispose())}get height(){return this.view.flattenedNodes.length}bootInit(e){Promise.resolve(this.init()).catch(E.error),this.view.bootInit(e)}async bootOpen(e){await this.open(e),this.view.bootOpen()}async openedNotifier(e,r){return v.noop()}async copyToClipboard(e){await this.nvim.call("setreg",["+",e]),await this.nvim.call("setreg",['"',e])}isSelectedAny(){return this.selectedNodes.size!==0}isSelectedNode(e){return this.selectedNodes.has(e)}async loadInitedChildren(e,r){let o=await this.loadChildren(e,r);return await Promise.all(o.map(async(i,n)=>{var a;i.level=((a=e.level)!=null?a:0)+1,i.parent=e,i.prevSiblingNode=o[n-1],i.nextSiblingNode=o[n+1],(r==null?void 0:r.recursiveExpanded)&&i.expandable&&this.view.isExpanded(i)&&(i.children=await this.loadInitedChildren(i,r))})),o}async load(e,r){await this.view.sync(async o=>(await this.loadNotifier(o,e,r)).run())}async loadNotifier(e,r,{render:o=!0,force:i=!1}={}){return this.isDisposed?v.noop():(await this.explorer.refreshWidth(),this.selectedNodes=new Set,this.view.isExpanded(r)?r.children=await this.loadInitedChildren(r,{recursiveExpanded:!0,force:i}):r.children=void 0,await this.events.fire("loaded",r),await this.view.load(r),o?e.renderNotifier({node:r,force:i}):v.noop())}};var zw=require("coc.nvim"),Hc=class{constructor(){this.registeredSources={}}registerSource(e,r){return this.registeredSources[e]=r,zw.Disposable.create(()=>{delete this.registeredSources[e]})}async enabled(e){return this.registeredSources[e]?await this.registeredSources[e].enabled:!1}createSource(e,r,o){if(!this.registeredSources[e])throw new Error(`explorer source(${e}) not found`);let i=new this.registeredSources[e](e,r);return i.bootInit(o),i}},Ct=new Hc;var Es={bufferRootTemplate:R.registerOption("buffer-root-template",{getDefault:()=>C.get("buffer.root.template")}),bufferChildTemplate:R.registerOption("buffer-child-template",{getDefault:()=>C.get("buffer.child.template")}),bufferChildLabelingTemplate:R.registerOption("buffer-child-labeling-template",{getDefault:()=>C.get("buffer.child.labelingTemplate")})};var Yw=require("coc.nvim");function Kw(t){let{nvim:e}=Yw.workspace,r=t.owner;t.addNodeAction("drop",async({node:o})=>{if(!o.hidden){let n=await e.call("getbufinfo",o.bufnr);if(n.length&&n[0].windows.length){let a=await r.explorer.tryQuitOnOpenNotifier(),s=n[0].windows[0];e.pauseNotification(),e.call("win_gotoid",s,!0),a.notify(),await e.resumeNotification();return}}let i=await r.explorer.tryQuitOnOpenNotifier();e.pauseNotification(),e.command(`buffer ${o.bufnr}`,!0),i.notify(),await e.resumeNotification()},"open buffer by drop command",{select:!0}),t.addNodeAction("delete",async({node:o})=>{if(ma()&&(await oe.curTabDelBufnr(o.bufnr),oe.existBufnr(o.bufnr))){let i=await Gh(o.bufnr);await Na(i);return}r.bufManager.modified(o.fullpath,{directory:!1})&&await Ye("Buffer is being modified, delete it?")!=="yes"||(await r.bufManager.removeBufNode(o,{skipModified:!0,bwipeout:!1,directory:!1}),await r.load(o,{force:!0}))},"delete buffer",{select:!0}),t.addNodeAction("deleteForever",async({node:o})=>{r.bufManager.modified(o.fullpath,{directory:!1})&&await Ye("Buffer is being modified, wipeout it?")!=="yes"||(await r.bufManager.removeBufNode(o,{skipModified:!0,bwipeout:!0,directory:!1}),await r.load(o,{force:!0}))},"bwipeout buffer",{select:!0})}var Xw=require("coc.nvim"),ur=class{constructor(){this.registeredColumns=new Map}async initColumn(e,r,o){var s,l;if(/\d+/.test(o))return parseInt(o,10);let i=(s=this.registeredColumns.get(e))==null?void 0:s.get(o);if(!i)throw Error(`column(${o}) not found`);let n={label:o},a=[];if(Object.assign(n,i.createColumn({source:r,column:n,subscriptions:a}),{subscriptions:a}),n.inited)return n;if(!(n.available&&!await n.available()))return await((l=n.init)==null?void 0:l.call(n)),n.inited=!0,n}registerColumn(e,r,o){return this.registeredColumns.has(e)||this.registeredColumns.set(e,new Map),this.registeredColumns.get(e).set(r,{createColumn:o}),Xw.Disposable.create(()=>{this.registeredColumns.get(e).delete(r)})}};var $c=class extends ur{},q=new $c;q.registerColumn("root","icon",({source:t})=>({draw(){return{drawNode(e,{node:r}){e.add(t.view.isExpanded(r)?t.icons.expanded:t.icons.collapsed,{hl:be.expandIcon})}}}}));q.registerColumn("root","title",()=>({draw(){return{drawNode(t){t.add("[BUFFER]",{hl:be.title})}}}}));q.registerColumn("root","hidden",({source:t})=>({draw(){return{drawNode(e){e.add(t.showHidden?t.icons.hidden:"",{hl:be.hidden})}}}}));var Qw=t=>{let e=r=>({icon:t.get(`git.icon.rootStatus.${r}`),name:r});return{[0]:{icon:"",name:"staged"},[5]:e("stashed"),[1]:e("ahead"),[2]:e("behind"),[3]:e("conflicted"),[4]:e("untracked"),[6]:e("modified"),[7]:e("added"),[8]:e("renamed"),[9]:e("deleted")}},Ss=t=>{let e=r=>({icon:t.get(`git.icon.status.${r}`),name:r});return{["*"]:e("mixed"),[" "]:e("unmodified"),["M"]:e("modified"),["A"]:e("added"),["D"]:e("deleted"),["R"]:e("renamed"),["C"]:e("copied"),["U"]:e("unmerged"),["?"]:e("untracked"),["!"]:e("ignored")}};var Zw=require("coc.nvim"),ex=_(Fi());var Fe=D.linkGroup.bind(D),tx=t=>{D.watchColorScheme(t,async()=>{let r=await ds(["String","Character","Number","Boolean","Float","Identifier","Function","Statement","Conditional","Repeat","Label","Operator","Keyword","Exception","PreProc","Include","Define","Macro","PreCondit","Type","StorageClass","Structure","Typedef","Special","SpecialChar","Tag","Delimiter","SpecialComment","Debug","Todo"]),o=fe(Object.values(r).map(s=>{var u;let l=s.guifg;if(!l)return;let c=(u=s.ctermfg)!=null?u:ex.default.rgb.ansi256([l.red,l.green,l.blue]).toString();return{guifg:l,ctermfg:c}})),{nvim:i}=Zw.workspace;i.pauseNotification();let n=Ql(Ia(18,204,90,1),o,s=>s.guifg);n&&i.command(`highlight default CocExplorerGitPathChange_Internal ctermfg=${n.ctermfg} guifg=#${Hi(n.guifg)}`,!0);let a=Ql(Ia(209,177,15,1),o,s=>s.guifg);a&&i.command(`highlight default CocExplorerGitContentChange_Internal ctermfg=${n.ctermfg} guifg=#${Hi(a.guifg)}`,!0),await i.resumeNotification()}).catch(E.error)},on=Fe("GitPathChange","CocExplorerGitPathChange_Internal"),Jw=Fe("GitContentChange","CocExplorerGitContentChange_Internal"),me={renamed:Fe("GitRenamed",on.group),copied:Fe("GitCopied",on.group),added:Fe("GitAdded",on.group),untracked:Fe("GitUntracked",on.group),unmerged:Fe("GitUnmerged",on.group),mixed:Fe("GitMixed",Jw.group),modified:Fe("GitModified",Jw.group),deleted:Fe("GitDeleted",Ee.ErrorColor),ignored:Fe("GitIgnored",Ee.CommentColor),staged:Fe("GitStaged",Ee.CommentColor),unstaged:Fe("GitUnstaged","Operator")},rx=t=>{switch(t){case"*":return me.mixed;case"M":return me.modified;case"A":return me.added;case"D":return me.deleted;case"R":return me.renamed;case"C":return me.copied;case"U":return me.unmerged;case"?":return me.untracked}};var fr=require("coc.nvim"),nn=_(require("path"));var Gc=require("coc.nvim"),ox=_(require("path"));var Ts=class{constructor(){this.sourcesBinding=new Map;this.prevErrorMixedCount=new Map;this.prevWarningMixedCount=new Map;this.reloadDebounceSubject=$a(e=>e.pipe($r(e.pipe(at(500))),rr(async r=>{let o=new Set(r.flat());await this.reload([...o])})))}get sources(){return[...this.sourcesBinding.keys()]}get refTotalCount(){return se([...this.sourcesBinding.values()].map(e=>e.refCount.total))}get diagnosticTypes(){let e=[],r=[...this.sourcesBinding.values()].map(o=>o.refCount);return r.some(o=>o.error>0)&&e.push("error"),r.some(o=>o.warning>0)&&e.push("warning"),e}bind(e,r){let o=zn(this.sourcesBinding,e,()=>({refCount:{error:0,warning:0,total:0}}));return o.refCount[r]+=1,o.refCount.total+=1,o.refCount.total===1&&(this.registeredForSourceDisposable=this.registerForSource(e)),this.refTotalCount===1&&(this.registeredDisposable=this.register()),Gc.Disposable.create(()=>{var i,n;o.refCount[r]-=1,o.refCount.total-=1,o.refCount.total===0&&((i=this.registeredForSourceDisposable)==null||i.dispose(),this.registeredForSourceDisposable=void 0),this.refTotalCount===0&&((n=this.registeredDisposable)==null||n.dispose(),this.registeredDisposable=void 0)})}register(){return lt.on("CocDiagnosticChange",()=>{this.reloadDebounceSubject.next(this.sources)})}registerForSource(e){let r=e.events.on("loaded",async i=>{("isRoot"in i?e.root:i.expandable?i.fullpath:i.fullpath&&ox.default.dirname(i.fullpath))&&this.reloadDebounceSubject.next([e])}),o=e.events.on("drawn",()=>{for(let[i,n]of e.view.flattenedNodes.entries()){if(!n.fullpath)continue;let a=K.getMixedError(n.fullpath),s=K.getMixedWarning(n.fullpath),l=!1,c=!1;if(a||s){let u=!(n.expandable&&e.view.isExpanded(n));a&&u&&(l=!0),s&&u&&(c=!0)}l?e.locator.mark.add("diagnosticError",i):e.locator.mark.remove("diagnosticError",i),c?e.locator.mark.add("diagnosticWarning",i):e.locator.mark.remove("diagnosticWarning",i)}});return Gc.Disposable.create(()=>{r.dispose(),o.dispose()})}async reload(e){let r=this.diagnosticTypes;await K.reload(r);let o=new Set;if(r.includes("error")){for(let[n]of this.prevErrorMixedCount)o.add(n);let i=new Map(K.getMixedErrors());for(let[n]of i)o.add(n);this.prevErrorMixedCount=i}if(r.includes("warning")){for(let[n]of this.prevWarningMixedCount)o.add(n);let i=new Map(K.getMixedWarnings());for(let[n]of i)o.add(n);this.prevWarningMixedCount=i}for(let i of e)await i.view.renderPaths(o)}};var Uc=class{constructor(){this.errorMixedCountCache=new Map;this.warningMixedCountCache=new Map;this.binder=new Ts}bindColumn(e,r){let o=new Set(r),i=[];for(let n of o)i.push(this.binder.bind(e,n));return fr.Disposable.create(()=>{(0,fr.disposeAll)(i)})}async reload(e){let r=new Set(e),o=new Map,i=new Map;for(let n of await fr.diagnosticManager.getDiagnosticList()){let a=n.location.uri,s=le(fr.Uri.parse(a).fsPath);if(n.severity==="Error"){let l=o.get(s);o.set(s,(l!=null?l:0)+1)}else{let l=i.get(s);i.set(s,(l!=null?l:0)+1)}}r.has("error")&&this.reloadMixedErrors(o),r.has("warning")&&this.reloadMixedWarnings(i)}reloadMixedErrors(e){let r=new Map;for(let[o,i]of e){let n=o.split(nn.default.sep);for(let a=1;a<=n.length;a++){let s=n.slice(0,a).join(nn.default.sep),l=r.get(s);r.set(s,(l!=null?l:0)+i)}}this.errorMixedCountCache=r}reloadMixedWarnings(e){let r=new Map;for(let[o,i]of e){let n=o.split(nn.default.sep);for(let a=1;a<=n.length;a++){let s=n.slice(0,a).join(nn.default.sep),l=r.get(s);r.set(s,(l!=null?l:0)+i)}}this.warningMixedCountCache=r}getMixedErrors(){return this.errorMixedCountCache}getMixedWarnings(){return this.warningMixedCountCache}getMixedError(e){return this.errorMixedCountCache.get(e)}getMixedWarning(e){return this.warningMixedCountCache.get(e)}},K=new Uc;var eo=require("coc.nvim"),Os=_(require("fs")),ob=require("os"),Ps=_(require("path"));var ix=D.linkGroup.bind(D),It={diagnosticError:ix("DiagnosticError",Ee.CocErrorSignColor),diagnosticWarning:ix("DiagnosticWarning",Ee.CocWarningSignColor)};var nx=require("child_process"),dr=require("coc.nvim"),ax=require("events"),sx=_(Ro()),lx=_(require("path")),cx=_(require("readline"));var qc=class extends ax.EventEmitter{constructor(){super(...arguments);this.processes=[]}start(r,o,i,n){let a=i.length;for(let s of i){let l=(0,nx.spawn)(r,o,{cwd:s});this.processes.push(l),l.on("error",d=>{this.emit("error",d.message)});let c=cx.default.createInterface(l.stdout),u=dr.Range.create(0,0,0,0),f=n.length>0;l.stderr.on("data",d=>{console.error(d.toString("utf8"))}),c.on("line",d=>{let p=lx.default.join(s,d);if(f&&n.some(h=>(0,sx.default)(p,h)))return;let m=dr.Location.create(dr.Uri.file(p).toString(),u);this.emit("data",{label:d,location:m})}),c.on("close",()=>{a=a-1,a===0&&this.emit("end")})}}dispose(){for(let r of this.processes)r.killed||r.kill()}},_O=dr.workspace.getConfiguration("list.source.files");async function MO(t){let e=[];if(await Di("fd"))return e.push("--color","never"),t.showIgnores&&e.push("--no-ignore"),t.showHidden&&e.push("--hidden"),t.recursive||e.push("--max-depth","1"),{name:"fd",args:e};if(Be)return e.push("/a-D","/B"),t.recursive&&e.push("/S"),{name:"dir",args:e};if(await Di("find"))return e.push("."),t.recursive||e.push("-maxdepth","1"),{name:"find",args:e};throw new Error("Unable to find command for files list.")}var ux=or({name:"explorerFiles",defaultAction:"reveal",async loadItems(t){if(!t.rootPath)return;let e=await MO(t);if(!e)return;let r=new qc,o=_O.get("excludePatterns",[]);return r.start(e.name,e.args,[t.rootPath],o),r},init(){this.addLocationActions(),this.addAction("reveal",async({arg:t,item:e})=>{let r=await this.convertLocation(e.location);t.revealCallback&&await t.revealCallback(r)})}});var an={fileRootTemplate:R.registerOption("file-root-template",{getDefault:()=>C.get("file.root.template")}),fileRootLabelingTemplate:R.registerOption("file-root-labeling-template",{getDefault:()=>C.get("file.root.labelingTemplate")}),fileChildTemplate:R.registerOption("file-child-template",{getDefault:()=>C.get("file.child.template")}),fileChildLabelingTemplate:R.registerOption("file-child-labeling-template",{getDefault:()=>C.get("file.child.labelingTemplate")})};var eu=_(Tx());var Xr=require("coc.nvim"),Ge=_(require("path"));var Nx=require("coc.nvim");var Cx=or({name:"explorerDrives",defaultAction:"do",async loadItems(t){return t.map(e=>({label:e.name,data:e}))},doHighlight(){let{nvim:t}=Nx.workspace;t.pauseNotification(),t.command("syntax match CocExplorerDriveName /\\v^[\\w:]+/",!0),t.command("highlight default link CocExplorerDriveName PreProc",!0),t.resumeNotification().catch(E.error)},init(){this.addAction("do",async({item:t})=>{await t.data.callback(t.data.name)})}});var Zc=require("coc.nvim");var Ix=or({defaultAction:"do",name:"ExplorerWorkspaceFolders",async loadItems(t){return Zc.workspace.folderPaths.map(e=>({label:e,data:{path:e,callback:()=>{t==null||t.action.doAction("cd",[],[e]).catch(E.error)}}}))},init(){this.addAction("do",({item:t})=>{t.data.callback()})},doHighlight(){let{nvim:t}=Zc.workspace;t.pauseNotification(),t.command("syntax match CocExplorerWorkspaceFolder /\\v^.*/",!0),t.command("highlight default link CocExplorerWorkspaceFolder PreProc",!0),t.resumeNotification().catch(E.error)}});function Ox(t){let{nvim:e}=Xr.workspace,r=t.owner;t.addNodeAction("gotoParent",async()=>{var n;if(r.root==="")return;let i=(n=r.view.currentNode())==null?void 0:n.uid;/^[A-Za-z]:[\\/]$/.test(r.root)?r.root="":(r.root=Ge.default.dirname(r.root),await r.cd(r.root)),await r.view.expand(r.view.rootNode),i&&await r.locator.gotoNodeUid(i)},"change directory to parent directory"),t.addNodeAction("rootStrategies",({args:i})=>{let n=i[0];n&&(r.rootStrategies=n.split(","))},"change root strategies",{args:[{name:"root strategies",description:`root strategies of ${is.join(" | ")}`}],menus:{"workspace,cwd,sourceBuffer,reveal":"default",keep:"keep current root"}}),t.addNodeAction("resolveRoot",async({args:i,node:n})=>{var l;let a=i[0],s=await((l=r.explorer.rooter)==null?void 0:l.resolveRoot(a,r.rootStrategies));s&&await t.doAction("cd",n,[s])},"resolve and change directory to root",{args:[{name:"reveal path",description:"path string"}],menus:{path:{description:"use custom path",args:"<reveal-path>",async actionArgs(){var i,n;return[await $e("input a reveal path:",(n=(i=r.view.currentNode())==null?void 0:i.fullpath)!=null?n:"","file")]}}}}),t.addNodeAction("reveal",async({node:i,args:n})=>{var c;let a=n[0],s,l="";if(/\d+/.test(a))s=parseInt(a,10),s===0&&(s=await Ke());else{let u=a!=null?a:"previousWindow",f={select:async()=>{await Ca(r.explorer.config,r.sourceType,{onSelect:async d=>{s=await Ta(d)}})},sourceWindow:async()=>{s=await Ta(await r.explorer.sourceWinnr())},previousBuffer:async()=>{s=await r.explorer.explorerManager.previousBufnr.get()},previousWindow:async()=>{s=await Ta(await r.explorer.explorerManager.prevWinnrByPrevWindowID())},path:async()=>{var d,p;l=n[1],l||(l=await $e("Input a reveal path:",(p=(d=r.view.currentNode())==null?void 0:d.fullpath)!=null?p:"","file"))}};await((c=f[u])==null?void 0:c.call(f))}if(s){let u=await e.call("getbufinfo",[s]);if(!u[0]||!u[0].name)return;l=u[0].name}!l||(Ea(r.root,l)||await t.doAction("resolveRoot",i,[l]),await r.view.sync(async u=>{var h;let d=((h=n[1])!=null?h:"").includes("compact")||void 0,[p,m]=await r.revealNodeByPathNotifier(u,l,{compact:d});p&&await v.runAll(m)}))},"reveal buffer in explorer",{args:[{name:"target",description:`bufnr number | ${ww.join(" | ")}`}],menus:{"0":"use current buffer","0:compact":"use current buffer and compact",select:"use select windows UI",previousBuffer:"use last used buffer",previousWindow:"use last used window",sourceWindow:"use the window where explorer opened",path:{description:"use custom path",args:"path:<path>",async actionArgs(){return["path"]}}}}),t.addNodeAction("cd",async({node:i,args:n})=>{let a=async l=>{await r.cd(l),r.root=l,await r.view.expand(r.view.rootNode)},s=n[0];s!==void 0?await a(s):i.directory&&await a(i.fullpath)},"change directory to current node",{args:[{name:"path"}],menus:{path:{description:"",args:"<path>",async actionArgs(){var i,n;return[await $e("input a cd path:",(n=(i=r.view.currentNode())==null?void 0:i.fullpath)!=null?n:"","file")]}}}}),t.addNodeAction("workspaceFolders",async()=>{await Gr(r.explorer,Ix,r,["--normal"])},"change directory to current node"),t.addNodeAction("drop",async({node:i})=>{if(!i.directory){let n=await r.explorer.tryQuitOnOpenNotifier();e.pauseNotification(),e.command(`drop ${i.fullpath}`,!0),n.notify(),await e.resumeNotification()}},"open file by drop command",{select:!0}),t.addNodesAction("copyFilepath",async({nodes:i})=>{await r.copyToClipboard(i?i.map(n=>n.fullpath).join(`
`):r.root),Xr.window.showMessage("Copy filepath to clipboard")},"copy full filepath to clipboard"),t.addNodesAction("copyRelativeFilepath",async({nodes:i})=>{await r.copyToClipboard(i?i.map(n=>Ge.default.relative(r.root,n.fullpath)).join(`
`):r.root),Xr.window.showMessage("Copy relative filepath to clipboard")},"copy relative filepath to clipboard"),t.addNodesAction("copyFilename",async({nodes:i})=>{await r.copyToClipboard(i?i.map(n=>n.name).join(`
`):Ge.default.basename(r.root)),Xr.window.showMessage("Copy filename to clipboard")},"copy filename to clipboard");let o={args:[{name:"type",description:`${bw.join(" | ")}, default: replace`}],menus:{toggle:"toggle copy/cut",append:"append to copy/cut",replace:"replace copy/cut "}};t.addNodesAction("copyFile",async({nodes:i,args:n})=>{var l;let a=(l=n[0])!=null?l:"replace",s=r.explorer.explorerManager.clipboardStorage;if(a==="replace"){let c=await s.getFiles(),u=r.getNodesByPaths(c.fullpaths);r.view.requestRenderNodes(u),await s.setFiles("copy",i.map(f=>f.fullpath))}else if(a==="toggle"){let c=await s.getFiles(),u=new Set(c.fullpaths);for(let f of i)u.has(f.fullpath)?u.delete(f.fullpath):u.add(f.fullpath);await s.setFiles("copy",[...u])}else if(a==="append"){let c=await s.getFiles(),u=new Set(c.fullpaths);for(let f of i)u.add(f.fullpath);await s.setFiles("copy",[...u])}r.view.requestRenderNodes(i)},"copy file for paste",o),t.addNodesAction("cutFile",async({nodes:i,args:n})=>{var l;let a=(l=n[0])!=null?l:"replace",s=r.explorer.explorerManager.clipboardStorage;if(a==="replace"){let c=await s.getFiles(),u=r.getNodesByPaths(c.fullpaths);r.view.requestRenderNodes(u),await s.setFiles("cut",i.map(f=>f.fullpath))}else if(a==="toggle"){let c=await s.getFiles(),u=new Set(c.fullpaths);for(let f of i)u.has(f.fullpath)?u.delete(f.fullpath):u.add(f.fullpath);await s.setFiles("cut",[...u])}else if(a==="append"){let c=await s.getFiles(),u=new Set(c.fullpaths);for(let f of i)u.add(f.fullpath);await s.setFiles("cut",[...u])}r.view.requestRenderNodes(i)},"cut file for paste",o),t.addNodeAction("clearCopyOrCut",async()=>{let i=r.explorer.explorerManager.clipboardStorage,n=await i.getFiles();await i.clear(),r.view.requestRenderNodes(r.getNodesByPaths(n.fullpaths))},"clear cut/copy clipboard of files"),t.addNodeAction("pasteFile",async({node:i})=>{let n=r.explorer.explorerManager.clipboardStorage,a=await n.getFiles();if(a.type==="none"||a.fullpaths.length<=0){Xr.window.showMessage("Copied or cut files is empty","error");return}let s=a.fullpaths,l=r.getPutTargetNode(i),c=l.fullpath,u;a.type==="copy"?u=await Br("paste",s.map(f=>({source:f,target:Ge.default.join(c,Ge.default.basename(f))})),$l):a.type==="cut"&&(u=await Br("paste",s.map(f=>({source:f,target:Ge.default.join(c,Ge.default.basename(f))})),Hl),await n.setFiles("cut",u.endFullpaths)),await r.load(r.view.rootNode),await r.view.sync(async f=>{await r.revealNodeByPathNotifier(f,s[0],{startNode:l})})},"paste files to here"),t.addNodesAction("delete",async({nodes:i})=>{if(i.some(a=>r.bufManager.modified(a.fullpath,{directory:a.directory}))&&await Ye("Buffer is being modified, discard it?")!=="yes")return;let n=i.map(a=>a.fullpath).join(`
`);if(await Ye(`Move these files or directories to trash?
${n}`)==="yes"){await ba(i.map(a=>a.fullpath));for(let a of i)await r.bufManager.remove(a.fullpath,{skipModified:!0,bwipeout:!0,directory:a.directory})}},"move file or directory to trash",{reload:!0}),t.addNodesAction("deleteForever",async({nodes:i})=>{if(i.some(a=>r.bufManager.modified(a.fullpath,{directory:a.directory}))&&await Ye("Buffer is being modified, discard it?")!=="yes")return;let n=i.map(a=>a.fullpath).join(`
`);if(await Ye(`Delete these files or directories permanently?
${n}`)==="yes")for(let a of i)await Ih(a.fullpath),await r.bufManager.remove(a.fullpath,{skipModified:!0,bwipeout:!0,directory:a.directory})},"delete file or directory permanently",{reload:!0}),t.addNodeAction("addFile",async({node:i,args:n})=>{let a,s="Input a new filename:";if(n[0]?a=n[0]:a=await $e(s,"","file"),a=a==null?void 0:a.trim(),!a)return;if(["/","\\"].includes(a[a.length-1])){await t.doAction("addDirectory",i,[a]);return}let l=r.getPutTargetNode(i),c=Ge.default.join(l.fullpath,a);await Br("add file",[{source:void 0,target:c}],async(u,f)=>{await Th(f)}),await r.view.sync(async u=>{var m;let f=(m=l.parent)!=null?m:l,d=await r.loadNotifier(u,f),[,p]=await r.revealNodeByPathNotifier(u,c.replace(/(\/|\\)$/,""),{startNode:f});await v.runAll([d,...p])})},"add a new file"),t.addNodeAction("addDirectory",async({node:i,args:n})=>{var c;let a=(c=n[0])!=null?c:await $e("Input a new directory name:","","file");if(a=a.trim().replace(/(\/|\\)*$/g,""),!a)return;let s=r.getPutTargetNode(i),l=Ge.default.join(s.fullpath,a);await Br("add directory",[{source:void 0,target:l}],async(u,f)=>{await Wo(f)}),await r.view.sync(async u=>{var m;let f=(m=s.parent)!=null?m:s,d=await r.loadNotifier(u,f),[,p]=await r.revealNodeByPathNotifier(u,l,{startNode:f});await v.runAll([d,...p])})},"add a new directory"),t.addNodeAction("rename",async({node:i})=>{if(r.bufManager.modified(i.fullpath,{directory:i.directory})&&await Ye("Buffer is being modified, discard it?")!=="yes")return;let n;n=await $e(`Rename: ${i.fullpath} ->`,i.fullpath,"file"),n=n==null?void 0:n.trim(),n&&(await Br("rename",[{source:i.fullpath,target:n}],Hl),await r.bufManager.replace(i.fullpath,n,{skipModified:!0,bwipeout:!0,directory:i.directory}))},"rename a file or directory",{reload:!0}),t.addNodesAction("systemExecute",async({nodes:i})=>{i?await Promise.all(i.map(n=>(0,eu.default)(n.fullpath))):await(0,eu.default)(r.root)},"use system application open file or directory"),Be&&t.addNodeAction("listDrive",async()=>{let i=await ya();await Gr(r.explorer,Cx,i.map(n=>({name:n,callback:async a=>{r.root=a,await r.view.expand(r.view.rootNode)}})),["--normal","--number-select"])},"list drives"),t.addNodeAction("search",async({node:i,args:n})=>{var u;let a=((u=n[0])!=null?u:"").split("|"),s=a.includes("recursive"),l=a.includes("strict"),c=a.includes("noIgnore");await r.searchByCocList(i.isRoot?i.fullpath:Ge.default.dirname(i.fullpath),{recursive:s,noIgnore:c,strict:l})},"search by coc-list, the ignore function requires the fd command",{args:[{name:"search options",description:vw.join(" | ")}],menus:{noIgnore:"no ignore",recursive:"recursively","recursive|noIgnore":"recursively and no ignore",strict:"exact match","recursive|strict":"recursively and strict"}}),t.addNodeAction("searchRecursive",async({node:i})=>{E.error('searchRecursive action has been deprecated, please use "search:recursive" instead of it'),await r.searchByCocList(Ge.default.dirname(i.fullpath),{recursive:!0,noIgnore:!1,strict:!1})},"search by coc-list recursively"),t.addNodeAction("toggleOnlyGitChange",async()=>{r.showOnlyGitChange=!r.showOnlyGitChange,await r.view.sync(async i=>{let n=await r.loadNotifier(i,r.view.rootNode,{force:!0});e.pauseNotification(),r.highlight.clearHighlightsNotify(),n==null||n.notify(),await e.resumeNotification()})},"toggle visibility of git change node",{reload:!0})}var tu=class extends ur{},O=new tu;O.registerColumn("root","icon",({source:t})=>({draw(){return{drawNode(e,{node:r}){e.add(t.view.isExpanded(r)?t.icons.expanded:t.icons.collapsed,{hl:P.expandIcon})}}}}));O.registerColumn("root","git",({source:t,subscriptions:e})=>{let r=Qw(t.config);return{init(){e.push(B.bindColumn(t))},async draw(){return{labelVisible({node:o}){var i;return!!((i=B.getRootStatus(o.fullpath))!=null&&i.formats.length)},async available(){return await B.cmd.available()},drawNode(o,{node:i,isLabeling:n}){let a=B.getRootStatus(i.fullpath);if(a!=null&&a.formats.length){let s=[];for(let c of a.formats)n?s.push(`${r[c].name}(${r[c].icon})`):s.push(r[c].icon);let l=a.allStaged?me.staged:me.unstaged;n?o.add(s.join(" & "),{hl:l}):o.add(`{${s.join("")}}`,{hl:l})}}}}}});O.registerColumn("root","title",()=>({draw(){return{drawNode(t){t.add("[FILE]",{hl:P.title})}}}}));O.registerColumn("root","hidden",({source:t})=>({draw(){return{drawNode(e){e.add(t.showHidden?t.icons.hidden:"",{hl:P.hidden})}}}}));var Px=_(require("path"));O.registerColumn("root","root",({source:t})=>({draw(){return{drawNode(e){e.add(Px.default.basename(t.root),{hl:P.rootName})}}}}));O.registerColumn("root","fullpath",()=>({draw(){return{drawNode(t,{node:e,isLabeling:r}){t.add(Qt(e.fullpath),{hl:r?P.directory:P.fullpath})}}}}));O.registerColumn("child","git",({source:t,subscriptions:e})=>{let r=new ft(t.config),o=Ss(t.config),i=(n,a,s)=>{var l;return a?me.staged:(l=r.getHighlight(n,s,["git"]))!=null?l:me.unstaged};return{init(){e.push(B.bindColumn(t))},async available(){return await B.cmd.available()},async draw(){return{async labelVisible({node:n}){let a=B.getMixedStatus(n.fullpath,n.directory);return a?a.x!==" "||a.y!==" ":!1},drawNode(n,{node:a,nodeIndex:s,isLabeling:l}){let c=(f,d)=>{let p=i(a.fullpath,d,a.directory);l?n.add(`${o[f].name}(${o[f].icon})`,{hl:p}):n.add(o[f].icon,{hl:p})},u=B.getMixedStatus(a.fullpath,a.directory);u?(c(u.x,!0),l&&n.add(" "),c(u.y,!1),u.x==="!"?(t.locator.mark.remove("git",s),t.locator.mark.remove("gitStaged",s),t.locator.mark.remove("gitUnstaged",s)):(t.locator.mark.add("git",s),u.x!==" "?t.locator.mark.add("gitStaged",s):t.locator.mark.remove("gitStaged",s),u.y!==" "?t.locator.mark.add("gitUnstaged",s):t.locator.mark.remove("gitUnstaged",s))):(t.locator.mark.remove("git",s),t.locator.mark.remove("gitStaged",s),t.locator.mark.remove("gitUnstaged",s))}}}}});O.registerColumn("child","selection",({source:t})=>({draw(){return{drawNode(e,{node:r}){t.isSelectedNode(r)&&e.add(t.icons.selected)}}}}));var dt=class{},Ax={};function pr(t,e){Ax[t]=e}var ru=new Map;function _x(t){if(!ru.has(t)){let e=Ax[t];if(!e)return;ru.set(t,e())}return ru.get(t)}var kx=_(Fi());var $O="./icons.nerdfont.schema.json",GO={folderClosed:{code:"\uE5FF",color:"#00afaf"},folderOpened:{code:"\uE5FE",color:"#00afaf"},folderSymlink:{code:"\uF482",color:"#00afaf"},folderNpm:{code:"\u4B8E",color:"#00afaf"},file:{code:"\uF15B",color:"#999999"},fileSymlink:{code:"\uF481",color:"#999999"},fileHidden:{code:"\uF016",color:"#999999"},excel:{code:"\uF71A",color:"#207245"},word:{code:"\uF72B",color:"#185abd"},ppt:{code:"\uF726",color:"#cb4a32"},stylus:{code:"\uE600",color:"#8dc149"},sass:{code:"\uE603",color:"#f55385"},html:{code:"\uE60E",color:"#e37933"},xml:{code:"\uE60E","code.origin":"\uFABF",color:"#e37933"},ejs:{code:"\uE618",color:"#cbcb41"},css:{code:"\uE614",color:"#519aba"},webpack:{code:"\uFC29",color:"#519aba"},markdown:{code:"\uE609",color:"#519aba"},json:{code:"\uE60B",color:"#cbcb41"},javascript:{code:"\uE60C",color:"#cbcb41"},javascriptreact:{code:"\uE7BA",color:"#519aba"},ruby:{code:"\uE791",color:"#cc3e44"},php:{code:"\uE608",color:"#a074c4"},python:{code:"\uE606",color:"#519aba"},coffee:{code:"\uE61B",color:"#cbcb41"},mustache:{code:"\uE60F",color:"#e37933"},conf:{code:"\uE615",color:"#6d8086"},image:{code:"\uE60D",color:"#a074c4"},ico:{code:"\uE60D",color:"#cbcb41"},twig:{code:"\uE61C",color:"#8dc149"},c:{code:"\uE61D",color:"#519aba"},h:{code:"\uF0FD",color:"#a074c4"},haskell:{code:"\uE61F",color:"#a074c4"},lua:{code:"\uE620",color:"#519aba"},java:{code:"\uE738",color:"#cc3e44"},kotlin:{code:"\u0138",color:"#5674d4"},terminal:{code:"\uE795",color:"#4d5a5e"},ml:{code:"\u03BB",color:"#e37933"},diff:{code:"\uE728",color:"#41535b"},sql:{code:"\uE706",color:"#f55385"},clojure:{code:"\uE768",color:"#8dc149"},edn:{code:"\uE76A",color:"#519aba"},scala:{code:"\uE737",color:"#cc3e44"},go:{code:"\uE627",color:"#519aba"},dart:{code:"\uE798",color:"#03589C"},firefox:{code:"\uE745",color:"#e37933"},vs:{code:"\uE70C",color:"#854CC7"},perl:{code:"\uE769",color:"#519aba"},rss:{code:"\uE619",color:"#fb9d3b"},csharp:{code:"\uF81A",color:"#519aba"},fsharp:{code:"\uE7A7",color:"#519aba"},rust:{code:"\uE7A8",color:"#519aba"},dlang:{code:"\uE7AF",color:"#cc3e44"},erlang:{code:"\uE7B1",color:"#A90533"},elixir:{code:"\uE62D",color:"#a074c4"},elm:{code:"\uE62C",color:"#519aba"},mix:{code:"\uE62D",color:"#cc3e44"},vim:{code:"\uE62B",color:"#019833"},ai:{code:"\uE7B4",color:"#cbcb41"},psd:{code:"\uE7B8",color:"#519aba"},psb:{code:"\uE7B8",color:"#519aba"},typescript:{code:"\uE628",color:"#519aba"},typescriptreact:{code:"\uE7BA",color:"#519aba"},julia:{code:"\uE624",color:"#a074c4"},puppet:{code:"\uF499",color:"#cbcb41"},vue:{code:"\uFD42",color:"#8dc149"},swift:{code:"\uE755",color:"#e37933"},git:{code:"\uE725",color:"#41535b"},bashrc:{code:"\uE615",color:"#4d5a5e"},favicon:{code:"\uE623",color:"#cbcb41"},docker:{code:"\uE7B0",color:"#519aba"},gruntfile:{code:"\uE611",color:"#e37933"},gulpfile:{code:"\uE610",color:"#cc3e44"},dropbox:{code:"\uE707",color:"#0061FE"},license:{code:"\uE60A",color:"#cbcb41"},procfile:{code:"\uE607",color:"#a074c4"},jquery:{code:"\uE750",color:"#1B75BB"},angular:{code:"\uE753",color:"#E23237"},backbone:{code:"\uE752",color:"#0071B5"},requirejs:{code:"\uE770",color:"#F44A41"},materialize:{code:"\uE7B6",color:"#EE6E73"},mootools:{code:"\uE78F",color:"#ECECEC"},vagrant:{code:"\uF2B8",color:"#1563FF"},svg:{code:"\uFC1F",color:"#FFB13B"},font:{code:"\uF031",color:"#999999"},text:{code:"\uF15C",color:"#999999"},archive:{code:"\uF53B",color:"#cc3e44"},lock:{code:"\uF023",color:"#999999"}},UO={styl:"stylus",sass:"sass",scss:"sass",htm:"html",html:"html",slim:"html",xml:"xml",xaml:"xml",ejs:"ejs",css:"css",less:"css",md:"markdown",mdx:"markdown",markdown:"markdown",rmd:"markdown",lock:"lock",json:"json",js:"javascript",cjs:"javascript",mjs:"javascript",es6:"javascript",jsx:"javascriptreact",rb:"ruby",ru:"ruby",php:"php",py:"python",pyc:"python",pyo:"python",pyd:"python",coffee:"coffee",mustache:"mustache",hbs:"mustache",config:"conf",conf:"conf",ini:"conf",yml:"conf",yaml:"conf",toml:"conf",jpg:"image",jpeg:"image",bmp:"image",png:"image",gif:"image",webp:"image",ico:"ico",twig:"twig",cpp:"c","c++":"c",cxx:"c",cc:"c",cp:"c",c:"c",h:"h",hh:"h",hpp:"h",hxx:"h",hs:"haskell",lhs:"haskell",lua:"lua",java:"java",jar:"java",kt:"kotlin",kts:"kotlin",sh:"terminal",fish:"terminal",bash:"terminal",zsh:"terminal",ksh:"terminal",csh:"terminal",awk:"terminal",ps1:"terminal",bat:"terminal",cmd:"terminal",ml:"ml",mli:"ml",diff:"diff",db:"sql",sql:"sql",dump:"sql",accdb:"sql",clj:"clojure",cljc:"clojure",cljs:"clojure",edn:"edn",scala:"scala",go:"go",dart:"dart",xul:"firefox",pl:"perl",pm:"perl",t:"perl",rss:"rss",sln:"vs",suo:"vs",csproj:"vs",cs:"csharp",fsscript:"fsharp",fsx:"fsharp",fs:"fsharp",fsi:"fsharp",rs:"rust",rlib:"rust",d:"dlang",erl:"erlang",hrl:"erlang",ex:"elixir",eex:"elixir",exs:"elixir",exx:"elixir",leex:"elixir",vim:"vim",ai:"ai",psd:"psd",psb:"psd",ts:"typescript",tsx:"javascriptreact",jl:"julia",pp:"puppet",vue:"vue",elm:"elm",swift:"swift",xcplayground:"swift",svg:"svg",otf:"font",ttf:"font",fnt:"font",txt:"text",text:"text",zip:"archive",tar:"archive",gz:"archive",gzip:"archive",rar:"archive","7z":"archive",iso:"archive",doc:"word",docx:"word",docm:"word",csv:"excel",xls:"excel",xlsx:"excel",xlsm:"excel",ppt:"ppt",pptx:"ppt",pptm:"ppt"},qO={gruntfile:"gruntfile",gulpfile:"gulpfile",gemfile:"ruby",guardfile:"ruby",capfile:"ruby",rakefile:"ruby",gradlew:"terminal",mix:"mix",dropbox:"dropbox",vimrc:"vim",".vimrc":"vim",".gvimrc":"vim",_vimrc:"vim",_gvimrc:"vim",license:"license",procfile:"procfile",Vagrantfile:"vagrant","docker-compose.yml":"docker",".gitconfig":"git",".gitignore":"git",webpack:"webpack",".bashrc":"bashrc",".zshrc":"bashrc",".bashprofile":"bashrc","favicon.ico":"favicon",dockerfile:"docker",".dockerignore":"docker"},VO={".*jquery.*.js$":"jquery",".*angular.*.js$":"angular",".*backbone.*.js$":"backbone",".*require.*.js$":"requirejs",".*materialize.*.js$":"materialize",".*materialize.*.css$":"materialize",".*mootools.*.js$":"mootools"},zO={".git":"git",node_modules:"javascript"},YO={},Mx={$schema:$O,icons:GO,extensions:UO,filenames:qO,patternMatches:VO,dirnames:zO,dirPatternMatches:YO};var X=Mx,ci=C.get("icon.customIcons",{});Object.assign(X.icons,ci.icons);Object.assign(X.extensions,ci.extensions);Object.assign(X.filenames,ci.filenames);Object.assign(X.dirnames,ci.dirnames);Object.assign(X.patternMatches,ci.patternMatches);Object.assign(X.dirPatternMatches,ci.dirPatternMatches);var sn={};Object.entries(X.icons).forEach(([t,e])=>{let r=Gi(e.color);if(!r)return;let i=`ctermfg=${kx.default.rgb.ansi256([r.red,r.green,r.blue])} guifg=${e.color}`;sn[t]=D.createGroup(`FileIconNerdfont_${t}`,i)});var ou=class extends dt{async loadIcons(e){var o;let r=[];for(let i of e){let n=i.isDirectory?this.getDirectoryIcon(i):this.getFileIcon(i);n&&(n.highlight=(o=sn[n.name])==null?void 0:o.group,r.push({icon:n,target:i}))}return r}nerdfontToIcon(e){if(X.icons[e])return N({name:e},X.icons[e])}getFileIcon(e){let{fullname:r,basename:o,extensions:i}=e,n=i[i.length-1];if(Je(X.filenames,o)){let s=X.filenames[o];return this.nerdfontToIcon(s)}if(Je(X.filenames,r)){let s=X.filenames[r];return this.nerdfontToIcon(s)}let a=Object.entries(X.patternMatches).find(([s])=>new RegExp(s).test(r));if(a){let s=a[1];return this.nerdfontToIcon(s)}if(Je(X.extensions,n)){let s=X.extensions[n];return this.nerdfontToIcon(s)}}getDirectoryIcon(e){let{basename:r,fullname:o}=e;if(Je(X.dirnames,r)){let n=X.dirnames[r];return this.nerdfontToIcon(n)}if(Je(X.dirnames,o)){let n=X.dirnames[o];return this.nerdfontToIcon(n)}let i=Object.entries(X.dirPatternMatches).find(([n])=>new RegExp(n).test(o));if(i){let n=i[1];return this.nerdfontToIcon(n)}}};pr("builtin",()=>new ou);var Rx=require("coc.nvim");var iu=class extends dt{escapeLuaString(e,r="'"){return e&&e.replace(/\\/g,"\\").replace(new RegExp(r,"g"),"\\'")}async loadIcons(e){let r=[];for(let o of e){if(o.isDirectory)continue;let i=o.extensions[o.extensions.length-1],n=await Rx.workspace.nvim.call("luaeval",["{require'nvim-web-devicons'.get_icon(_A[1], _A[2])}",[o.fullname,i]]),[a,s]=n;!a||r.push({target:o,icon:{code:a,highlight:s}})}return r}};pr("nvim-web-devicons",()=>new iu);var Lx=require("coc.nvim");var nu=class extends dt{async loadIcons(e){let r=[];return await Promise.all(e.map(async o=>{if(o.isDirectory)return;let i=await Lx.workspace.nvim.call("WebDevIconsGetFileTypeSymbol",[o.fullname,!1]);!i||r.push({target:o,icon:{code:i}})})),r}};pr("vim-devicons",()=>new nu);var Dx=require("coc.nvim");var au=class extends dt{async loadIcons(e){let r=[];return await Promise.all(e.map(async o=>{let i=await Dx.workspace.nvim.call("nerdfont#find",[o.fullname,o.isDirectory]);!i||r.push({target:o,icon:{code:i}})})),r}};pr("nerdfont.vim",()=>new au);function KO(t){return t.map(e=>G(N({fullname:e.fullname},va(e.fullname.toLowerCase())),{isDirectory:e.isDirectory,hidden:e.hidden,expanded:e.expanded}))}async function ln(t,e){let r=KO(e),o=_x(t);if(!o)return;let i=await o.loadIcons(r),[n,a]=Ao(i,u=>u.target.isDirectory),s=qn(n,u=>u.target.fullname),l=qn(a,u=>u.target.fullname),c={files:new Map,directories:new Map};for(let u of e)if(Je(s,u.fullname))c.directories.set(u.fullname,s[u.fullname].icon);else if(Je(l,u.fullname))c.files.set(u.fullname,l[u.fullname].icon);else if(u.isDirectory){let f=u.expanded?X.icons.folderOpened.code:X.icons.folderClosed.code;c.directories.set(u.fullname,{code:f})}else{let f=u.hidden?X.icons.fileHidden.code:X.icons.file.code;c.files.set(u.fullname,{code:f})}return c}async function Bx(t,e){if(t.get("icon.enableVimDevicons"))return E.error('The configuration `explorer.icon.enableVimDevicons` has been deprecated, please use `{"explorer.icon.enableNerdFont": true, "explorer.icon.source": "vim-devicons"}` instead of it'),ln("vim-devicons",e);if(!t.get("icon.enableNerdfont"))return;let i=t.get("icon.source");return ln(i,e)}O.registerColumn("child","icon",({source:t})=>({async draw(e){let r=e.map(i=>{var n,a;return{fullname:(a=(n=i.compactedLastNode)==null?void 0:n.name)!=null?a:i.name,hidden:i.hidden,isDirectory:i.directory,expanded:i.directory?t.view.isExpanded(i):void 0}}),o=await Bx(t.config,r);return{async drawNode(i,{node:n}){var a,s,l;if(n.directory){let c=t.view.isExpanded(n)?P.directoryExpanded:P.directoryCollapsed,u=o==null?void 0:o.directories.get((s=(a=n.compactedLastNode)==null?void 0:a.name)!=null?s:n.name);u?i.add(u.code,{hl:c}):i.add(t.view.isExpanded(n)?t.icons.expanded:t.icons.collapsed,{hl:c})}else{let c=o==null?void 0:o.files.get(n.name);c&&i.add(c.code,{hl:(l=c.highlight)!=null?l:sn.file})}}}}}));O.registerColumn("child","filename",({source:t,subscriptions:e})=>{let r=new ft(t.config),o=(n,a)=>{var s;return(s=r.getHighlight(n,a,["diagnosticError","diagnosticWarning","git"]))!=null?s:a?P.directory:P.filename},i=[];return r.enabledErrorStatus&&i.push("error"),r.enabledWarningStatus&&i.push("warning"),{init(){e.push(K.bindColumn(t,i),B.bindColumn(t))},draw(){return{async drawNode(n,{node:a}){n.add(a.name,{hl:o(a.fullpath,a.directory),unicode:!0})}}}}});O.registerColumn("child","linkIcon",({source:t})=>({draw(){return{drawNode(e,{node:r}){r.symbolicLink&&e.add(t.icons.link,{hl:P.linkTarget})}}}}));O.registerColumn("child","link",()=>({draw(){return{labelVisible:({node:t})=>t.symbolicLink,async drawNode(t,{node:e}){let r=e.symbolicLink?await Nh(e.fullpath).then(o=>o).catch(()=>""):"";r&&t.add(r,{hl:P.linkTarget,unicode:!0})}}}}));var Wx=_(require("path"));O.registerColumn("child","fullpath",()=>({draw(){return{drawNode(t,{node:e}){e.directory?t.add(Qt(e.fullpath)+Wx.default.sep,{hl:P.directory}):t.add(e.fullpath)}}}}));function XO(t){var o,i;let e="";if((o=t.parent)!=null&&o.isRoot)return e;t.nextSiblingNode===void 0?e="\u2514 ":e="\u2502 ";let r=t.parent;for(;r&&!((i=r.parent)!=null&&i.isRoot);)r.nextSiblingNode===void 0?e=`  ${e}`:e=`\u2502 ${e}`,r=r.parent;return e}O.registerColumn("child","indent",({source:t})=>({draw(){let e=t.config.get("icon.enableNerdfont"),r=(()=>{let o=t.getColumnConfig("indent.indentLine");return e&&o===void 0?!0:o})();return{drawNode(o,{node:i}){var n;r?o.add(XO(i),{hl:P.indentLine}):o.add(t.getColumnConfig("indent.chars").repeat(((n=i.level)!=null?n:0)-1))}}}}));O.registerColumn("child","clip",({source:t})=>({async draw(){let e=t.getColumnConfig("clip.copy"),r=t.getColumnConfig("clip.cut");t.config.get("icon.enableNerdfont")?(e=e!=null?e:"\uF68E",r=r!=null?r:"\uF68F"):(e=e!=null?e:"C",r=r!=null?r:"X");let i=await t.explorer.explorerManager.clipboardStorage.getFiles(),n=new Set(i.fullpaths);return{drawNode(a,{node:s}){if(i.type==="none")return;let l=n.has(s.fullpath)?i.type==="cut"?r:e:"";l&&a.add(l,{hl:P.clip})}}}}));var $x=_(Hx());O.registerColumn("child","size",()=>({draw(){return{labelVisible:({node:t})=>!t.directory,drawNode(t,{node:e}){e.lstat&&t.add((0,$x.default)(e.lstat.size),{hl:P.size})}}}}));O.registerColumn("child","readonly",({source:t})=>({draw(){return{labelOnly:!0,labelVisible:({node:e})=>e.readonly,drawNode(e,{node:r}){r.readonly&&e.add(r.readonly?t.icons.readonly:"",{hl:P.readonly})}}}}));O.registerColumn("child","modified",({source:t,subscriptions:e})=>({async init(){t.explorer.isFloating||e.push(t.bufManager.onModifiedDebounce(r=>t.view.renderPaths(r)))},draw(){return{labelOnly:!0,labelVisible:({node:r})=>t.bufManager.modified(r.fullpath,{directory:r.directory}),drawNode(r,{node:o,nodeIndex:i}){let n=t.bufManager.modified(o.fullpath,{directory:o.directory&&!t.view.isExpanded(o)});r.add(n?"+":"",{hl:P.readonly}),n?t.locator.mark.add("modified",i):t.locator.mark.remove("modified",i)}}}}));function he(t){if(t===null||t===!0||t===!1)return NaN;var e=Number(t);return isNaN(e)?e:e<0?Math.ceil(e):Math.floor(e)}function j(t,e){if(e.length<t)throw new TypeError(t+" argument"+(t>1?"s":"")+" required, but only "+e.length+" present")}function ne(t){j(1,arguments);var e=Object.prototype.toString.call(t);return t instanceof Date||typeof t=="object"&&e==="[object Date]"?new Date(t.getTime()):typeof t=="number"||e==="[object Number]"?new Date(t):((typeof t=="string"||e==="[object String]")&&typeof console<"u"&&(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://git.io/fjule"),console.warn(new Error().stack)),new Date(NaN))}function su(t,e){j(2,arguments);var r=ne(t).getTime(),o=he(e);return new Date(r+o)}function lu(t){var e=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return e.setUTCFullYear(t.getFullYear()),t.getTime()-e.getTime()}function cu(t){return j(1,arguments),t instanceof Date||typeof t=="object"&&Object.prototype.toString.call(t)==="[object Date]"}function uu(t){if(j(1,arguments),!cu(t)&&typeof t!="number")return!1;var e=ne(t);return!isNaN(Number(e))}var tP={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},rP=function(t,e,r){var o,i=tP[t];return typeof i=="string"?o=i:e===1?o=i.one:o=i.other.replace("{{count}}",e.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+o:o+" ago":o},Gx=rP;function cn(t){return function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=e.width?String(e.width):t.defaultWidth,o=t.formats[r]||t.formats[t.defaultWidth];return o}}var oP={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},iP={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},nP={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},aP={date:cn({formats:oP,defaultWidth:"full"}),time:cn({formats:iP,defaultWidth:"full"}),dateTime:cn({formats:nP,defaultWidth:"full"})},Ux=aP;var sP={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},lP=function(t,e,r,o){return sP[t]},qx=lP;function Qr(t){return function(e,r){var o=r||{},i=o.context?String(o.context):"standalone",n;if(i==="formatting"&&t.formattingValues){var a=t.defaultFormattingWidth||t.defaultWidth,s=o.width?String(o.width):a;n=t.formattingValues[s]||t.formattingValues[a]}else{var l=t.defaultWidth,c=o.width?String(o.width):t.defaultWidth;n=t.values[c]||t.values[l]}var u=t.argumentCallback?t.argumentCallback(e):e;return n[u]}}var cP={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},uP={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},fP={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},dP={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},pP={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},mP={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},hP=function(t,e){var r=Number(t),o=r%100;if(o>20||o<10)switch(o%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},gP={ordinalNumber:hP,era:Qr({values:cP,defaultWidth:"wide"}),quarter:Qr({values:uP,defaultWidth:"wide",argumentCallback:function(t){return t-1}}),month:Qr({values:fP,defaultWidth:"wide"}),day:Qr({values:dP,defaultWidth:"wide"}),dayPeriod:Qr({values:pP,defaultWidth:"wide",formattingValues:mP,defaultFormattingWidth:"wide"})},Vx=gP;function Jr(t){return function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=r.width,i=o&&t.matchPatterns[o]||t.matchPatterns[t.defaultMatchWidth],n=e.match(i);if(!n)return null;var a=n[0],s=o&&t.parsePatterns[o]||t.parsePatterns[t.defaultParseWidth],l=Array.isArray(s)?xP(s,function(f){return f.test(a)}):wP(s,function(f){return f.test(a)}),c;c=t.valueCallback?t.valueCallback(l):l,c=r.valueCallback?r.valueCallback(c):c;var u=e.slice(a.length);return{value:c,rest:u}}}function wP(t,e){for(var r in t)if(t.hasOwnProperty(r)&&e(t[r]))return r}function xP(t,e){for(var r=0;r<t.length;r++)if(e(t[r]))return r}function fu(t){return function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=e.match(t.matchPattern);if(!o)return null;var i=o[0],n=e.match(t.parsePattern);if(!n)return null;var a=t.valueCallback?t.valueCallback(n[0]):n[0];a=r.valueCallback?r.valueCallback(a):a;var s=e.slice(i.length);return{value:a,rest:s}}}var bP=/^(\d+)(th|st|nd|rd)?/i,yP=/\d+/i,vP={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},EP={any:[/^b/i,/^(a|c)/i]},SP={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},TP={any:[/1/i,/2/i,/3/i,/4/i]},NP={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},CP={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},IP={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},OP={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},PP={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},AP={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},_P={ordinalNumber:fu({matchPattern:bP,parsePattern:yP,valueCallback:function(t){return parseInt(t,10)}}),era:Jr({matchPatterns:vP,defaultMatchWidth:"wide",parsePatterns:EP,defaultParseWidth:"any"}),quarter:Jr({matchPatterns:SP,defaultMatchWidth:"wide",parsePatterns:TP,defaultParseWidth:"any",valueCallback:function(t){return t+1}}),month:Jr({matchPatterns:NP,defaultMatchWidth:"wide",parsePatterns:CP,defaultParseWidth:"any"}),day:Jr({matchPatterns:IP,defaultMatchWidth:"wide",parsePatterns:OP,defaultParseWidth:"any"}),dayPeriod:Jr({matchPatterns:PP,defaultMatchWidth:"any",parsePatterns:AP,defaultParseWidth:"any"})},zx=_P;var MP={code:"en-US",formatDistance:Gx,formatLong:Ux,formatRelative:qx,localize:Vx,match:zx,options:{weekStartsOn:0,firstWeekContainsDate:1}},Yx=MP;function du(t,e){j(2,arguments);var r=he(e);return su(t,-r)}var kP=864e5;function pu(t){j(1,arguments);var e=ne(t),r=e.getTime();e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0);var o=e.getTime(),i=r-o;return Math.floor(i/kP)+1}function hr(t){j(1,arguments);var e=1,r=ne(t),o=r.getUTCDay(),i=(o<e?7:0)+o-e;return r.setUTCDate(r.getUTCDate()-i),r.setUTCHours(0,0,0,0),r}function un(t){j(1,arguments);var e=ne(t),r=e.getUTCFullYear(),o=new Date(0);o.setUTCFullYear(r+1,0,4),o.setUTCHours(0,0,0,0);var i=hr(o),n=new Date(0);n.setUTCFullYear(r,0,4),n.setUTCHours(0,0,0,0);var a=hr(n);return e.getTime()>=i.getTime()?r+1:e.getTime()>=a.getTime()?r:r-1}function mu(t){j(1,arguments);var e=un(t),r=new Date(0);r.setUTCFullYear(e,0,4),r.setUTCHours(0,0,0,0);var o=hr(r);return o}var RP=6048e5;function hu(t){j(1,arguments);var e=ne(t),r=hr(e).getTime()-mu(e).getTime();return Math.round(r/RP)+1}function gr(t,e){j(1,arguments);var r=e||{},o=r.locale,i=o&&o.options&&o.options.weekStartsOn,n=i==null?0:he(i),a=r.weekStartsOn==null?n:he(r.weekStartsOn);if(!(a>=0&&a<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var s=ne(t),l=s.getUTCDay(),c=(l<a?7:0)+l-a;return s.setUTCDate(s.getUTCDate()-c),s.setUTCHours(0,0,0,0),s}function fn(t,e){j(1,arguments);var r=ne(t),o=r.getUTCFullYear(),i=e||{},n=i.locale,a=n&&n.options&&n.options.firstWeekContainsDate,s=a==null?1:he(a),l=i.firstWeekContainsDate==null?s:he(i.firstWeekContainsDate);if(!(l>=1&&l<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var c=new Date(0);c.setUTCFullYear(o+1,0,l),c.setUTCHours(0,0,0,0);var u=gr(c,e),f=new Date(0);f.setUTCFullYear(o,0,l),f.setUTCHours(0,0,0,0);var d=gr(f,e);return r.getTime()>=u.getTime()?o+1:r.getTime()>=d.getTime()?o:o-1}function gu(t,e){j(1,arguments);var r=e||{},o=r.locale,i=o&&o.options&&o.options.firstWeekContainsDate,n=i==null?1:he(i),a=r.firstWeekContainsDate==null?n:he(r.firstWeekContainsDate),s=fn(t,e),l=new Date(0);l.setUTCFullYear(s,0,a),l.setUTCHours(0,0,0,0);var c=gr(l,e);return c}var LP=6048e5;function wu(t,e){j(1,arguments);var r=ne(t),o=gr(r,e).getTime()-gu(r,e).getTime();return Math.round(o/LP)+1}function W(t,e){for(var r=t<0?"-":"",o=Math.abs(t).toString();o.length<e;)o="0"+o;return r+o}var DP={y:function(t,e){var r=t.getUTCFullYear(),o=r>0?r:1-r;return W(e==="yy"?o%100:o,e.length)},M:function(t,e){var r=t.getUTCMonth();return e==="M"?String(r+1):W(r+1,2)},d:function(t,e){return W(t.getUTCDate(),e.length)},a:function(t,e){var r=t.getUTCHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h:function(t,e){return W(t.getUTCHours()%12||12,e.length)},H:function(t,e){return W(t.getUTCHours(),e.length)},m:function(t,e){return W(t.getUTCMinutes(),e.length)},s:function(t,e){return W(t.getUTCSeconds(),e.length)},S:function(t,e){var r=e.length,o=t.getUTCMilliseconds(),i=Math.floor(o*Math.pow(10,r-3));return W(i,e.length)}},Ot=DP;var ui={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},BP={G:function(t,e,r){var o=t.getUTCFullYear()>0?1:0;switch(e){case"G":case"GG":case"GGG":return r.era(o,{width:"abbreviated"});case"GGGGG":return r.era(o,{width:"narrow"});case"GGGG":default:return r.era(o,{width:"wide"})}},y:function(t,e,r){if(e==="yo"){var o=t.getUTCFullYear(),i=o>0?o:1-o;return r.ordinalNumber(i,{unit:"year"})}return Ot.y(t,e)},Y:function(t,e,r,o){var i=fn(t,o),n=i>0?i:1-i;if(e==="YY"){var a=n%100;return W(a,2)}return e==="Yo"?r.ordinalNumber(n,{unit:"year"}):W(n,e.length)},R:function(t,e){var r=un(t);return W(r,e.length)},u:function(t,e){var r=t.getUTCFullYear();return W(r,e.length)},Q:function(t,e,r){var o=Math.ceil((t.getUTCMonth()+1)/3);switch(e){case"Q":return String(o);case"QQ":return W(o,2);case"Qo":return r.ordinalNumber(o,{unit:"quarter"});case"QQQ":return r.quarter(o,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(o,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(o,{width:"wide",context:"formatting"})}},q:function(t,e,r){var o=Math.ceil((t.getUTCMonth()+1)/3);switch(e){case"q":return String(o);case"qq":return W(o,2);case"qo":return r.ordinalNumber(o,{unit:"quarter"});case"qqq":return r.quarter(o,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(o,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(o,{width:"wide",context:"standalone"})}},M:function(t,e,r){var o=t.getUTCMonth();switch(e){case"M":case"MM":return Ot.M(t,e);case"Mo":return r.ordinalNumber(o+1,{unit:"month"});case"MMM":return r.month(o,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(o,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(o,{width:"wide",context:"formatting"})}},L:function(t,e,r){var o=t.getUTCMonth();switch(e){case"L":return String(o+1);case"LL":return W(o+1,2);case"Lo":return r.ordinalNumber(o+1,{unit:"month"});case"LLL":return r.month(o,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(o,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(o,{width:"wide",context:"standalone"})}},w:function(t,e,r,o){var i=wu(t,o);return e==="wo"?r.ordinalNumber(i,{unit:"week"}):W(i,e.length)},I:function(t,e,r){var o=hu(t);return e==="Io"?r.ordinalNumber(o,{unit:"week"}):W(o,e.length)},d:function(t,e,r){return e==="do"?r.ordinalNumber(t.getUTCDate(),{unit:"date"}):Ot.d(t,e)},D:function(t,e,r){var o=pu(t);return e==="Do"?r.ordinalNumber(o,{unit:"dayOfYear"}):W(o,e.length)},E:function(t,e,r){var o=t.getUTCDay();switch(e){case"E":case"EE":case"EEE":return r.day(o,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(o,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(o,{width:"short",context:"formatting"});case"EEEE":default:return r.day(o,{width:"wide",context:"formatting"})}},e:function(t,e,r,o){var i=t.getUTCDay(),n=(i-o.weekStartsOn+8)%7||7;switch(e){case"e":return String(n);case"ee":return W(n,2);case"eo":return r.ordinalNumber(n,{unit:"day"});case"eee":return r.day(i,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(i,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(i,{width:"short",context:"formatting"});case"eeee":default:return r.day(i,{width:"wide",context:"formatting"})}},c:function(t,e,r,o){var i=t.getUTCDay(),n=(i-o.weekStartsOn+8)%7||7;switch(e){case"c":return String(n);case"cc":return W(n,e.length);case"co":return r.ordinalNumber(n,{unit:"day"});case"ccc":return r.day(i,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(i,{width:"narrow",context:"standalone"});case"cccccc":return r.day(i,{width:"short",context:"standalone"});case"cccc":default:return r.day(i,{width:"wide",context:"standalone"})}},i:function(t,e,r){var o=t.getUTCDay(),i=o===0?7:o;switch(e){case"i":return String(i);case"ii":return W(i,e.length);case"io":return r.ordinalNumber(i,{unit:"day"});case"iii":return r.day(o,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(o,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(o,{width:"short",context:"formatting"});case"iiii":default:return r.day(o,{width:"wide",context:"formatting"})}},a:function(t,e,r){var o=t.getUTCHours(),i=o/12>=1?"pm":"am";switch(e){case"a":case"aa":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(i,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(i,{width:"wide",context:"formatting"})}},b:function(t,e,r){var o=t.getUTCHours(),i;switch(o===12?i=ui.noon:o===0?i=ui.midnight:i=o/12>=1?"pm":"am",e){case"b":case"bb":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(i,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(i,{width:"wide",context:"formatting"})}},B:function(t,e,r){var o=t.getUTCHours(),i;switch(o>=17?i=ui.evening:o>=12?i=ui.afternoon:o>=4?i=ui.morning:i=ui.night,e){case"B":case"BB":case"BBB":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(i,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(i,{width:"wide",context:"formatting"})}},h:function(t,e,r){if(e==="ho"){var o=t.getUTCHours()%12;return o===0&&(o=12),r.ordinalNumber(o,{unit:"hour"})}return Ot.h(t,e)},H:function(t,e,r){return e==="Ho"?r.ordinalNumber(t.getUTCHours(),{unit:"hour"}):Ot.H(t,e)},K:function(t,e,r){var o=t.getUTCHours()%12;return e==="Ko"?r.ordinalNumber(o,{unit:"hour"}):W(o,e.length)},k:function(t,e,r){var o=t.getUTCHours();return o===0&&(o=24),e==="ko"?r.ordinalNumber(o,{unit:"hour"}):W(o,e.length)},m:function(t,e,r){return e==="mo"?r.ordinalNumber(t.getUTCMinutes(),{unit:"minute"}):Ot.m(t,e)},s:function(t,e,r){return e==="so"?r.ordinalNumber(t.getUTCSeconds(),{unit:"second"}):Ot.s(t,e)},S:function(t,e){return Ot.S(t,e)},X:function(t,e,r,o){var i=o._originalDate||t,n=i.getTimezoneOffset();if(n===0)return"Z";switch(e){case"X":return Xx(n);case"XXXX":case"XX":return Zr(n);case"XXXXX":case"XXX":default:return Zr(n,":")}},x:function(t,e,r,o){var i=o._originalDate||t,n=i.getTimezoneOffset();switch(e){case"x":return Xx(n);case"xxxx":case"xx":return Zr(n);case"xxxxx":case"xxx":default:return Zr(n,":")}},O:function(t,e,r,o){var i=o._originalDate||t,n=i.getTimezoneOffset();switch(e){case"O":case"OO":case"OOO":return"GMT"+Kx(n,":");case"OOOO":default:return"GMT"+Zr(n,":")}},z:function(t,e,r,o){var i=o._originalDate||t,n=i.getTimezoneOffset();switch(e){case"z":case"zz":case"zzz":return"GMT"+Kx(n,":");case"zzzz":default:return"GMT"+Zr(n,":")}},t:function(t,e,r,o){var i=o._originalDate||t,n=Math.floor(i.getTime()/1e3);return W(n,e.length)},T:function(t,e,r,o){var i=o._originalDate||t,n=i.getTime();return W(n,e.length)}};function Kx(t,e){var r=t>0?"-":"+",o=Math.abs(t),i=Math.floor(o/60),n=o%60;if(n===0)return r+String(i);var a=e||"";return r+String(i)+a+W(n,2)}function Xx(t,e){if(t%60===0){var r=t>0?"-":"+";return r+W(Math.abs(t)/60,2)}return Zr(t,e)}function Zr(t,e){var r=e||"",o=t>0?"-":"+",i=Math.abs(t),n=W(Math.floor(i/60),2),a=W(i%60,2);return o+n+r+a}var Qx=BP;function Jx(t,e){switch(t){case"P":return e.date({width:"short"});case"PP":return e.date({width:"medium"});case"PPP":return e.date({width:"long"});case"PPPP":default:return e.date({width:"full"})}}function Zx(t,e){switch(t){case"p":return e.time({width:"short"});case"pp":return e.time({width:"medium"});case"ppp":return e.time({width:"long"});case"pppp":default:return e.time({width:"full"})}}function WP(t,e){var r=t.match(/(P+)(p+)?/)||[],o=r[1],i=r[2];if(!i)return Jx(t,e);var n;switch(o){case"P":n=e.dateTime({width:"short"});break;case"PP":n=e.dateTime({width:"medium"});break;case"PPP":n=e.dateTime({width:"long"});break;case"PPPP":default:n=e.dateTime({width:"full"});break}return n.replace("{{date}}",Jx(o,e)).replace("{{time}}",Zx(i,e))}var FP={p:Zx,P:WP},eb=FP;var jP=["D","DD"],HP=["YY","YYYY"];function tb(t){return jP.indexOf(t)!==-1}function rb(t){return HP.indexOf(t)!==-1}function xu(t,e,r){if(t==="YYYY")throw new RangeError("Use `yyyy` instead of `YYYY` (in `".concat(e,"`) for formatting years to the input `").concat(r,"`; see: https://git.io/fxCyr"));if(t==="YY")throw new RangeError("Use `yy` instead of `YY` (in `".concat(e,"`) for formatting years to the input `").concat(r,"`; see: https://git.io/fxCyr"));if(t==="D")throw new RangeError("Use `d` instead of `D` (in `".concat(e,"`) for formatting days of the month to the input `").concat(r,"`; see: https://git.io/fxCyr"));if(t==="DD")throw new RangeError("Use `dd` instead of `DD` (in `".concat(e,"`) for formatting days of the month to the input `").concat(r,"`; see: https://git.io/fxCyr"))}var $P=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,GP=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,UP=/^'([^]*?)'?$/,qP=/''/g,VP=/[a-zA-Z]/;function wr(t,e,r){j(2,arguments);var o=String(e),i=r||{},n=i.locale||Yx,a=n.options&&n.options.firstWeekContainsDate,s=a==null?1:he(a),l=i.firstWeekContainsDate==null?s:he(i.firstWeekContainsDate);if(!(l>=1&&l<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var c=n.options&&n.options.weekStartsOn,u=c==null?0:he(c),f=i.weekStartsOn==null?u:he(i.weekStartsOn);if(!(f>=0&&f<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");if(!n.localize)throw new RangeError("locale must contain localize property");if(!n.formatLong)throw new RangeError("locale must contain formatLong property");var d=ne(t);if(!uu(d))throw new RangeError("Invalid time value");var p=lu(d),m=du(d,p),h={firstWeekContainsDate:l,weekStartsOn:f,locale:n,_originalDate:d},g=o.match(GP).map(function(x){var b=x[0];if(b==="p"||b==="P"){var S=eb[b];return S(x,n.formatLong,h)}return x}).join("").match($P).map(function(x){if(x==="''")return"'";var b=x[0];if(b==="'")return zP(x);var S=Qx[b];if(S)return!i.useAdditionalWeekYearTokens&&rb(x)&&xu(x,e,t),!i.useAdditionalDayOfYearTokens&&tb(x)&&xu(x,e,t),S(m,x,n.localize,h);if(b.match(VP))throw new RangeError("Format string contains an unescaped latin alphabet character `"+b+"`");return x}).join("");return g}function zP(t){return t.match(UP)[1].replace(qP,"'")}O.registerColumn("child","timeModified",({source:t})=>({draw(){return{drawNode(e,{node:r}){r.lstat&&e.add(wr(r.lstat.mtime,t.config.get("datetime.format")),{hl:P.timeModified})}}}}));O.registerColumn("child","timeCreated",({source:t})=>({draw(){return{drawNode(e,{node:r}){r.lstat&&e.add(wr(r.lstat.ctime,t.config.get("datetime.format")),{hl:P.timeCreated})}}}}));O.registerColumn("child","timeAccessed",({source:t})=>({draw(){return{drawNode(e,{node:r}){r.lstat?e.add(wr(r.lstat.atime,t.config.get("datetime.format")),{hl:P.timeAccessed}):e.add("                 ")}}}}));var xr=t=>({displayMax:t.get("diagnostic.displayMax"),enableSubscriptNumber:t.get("diagnostic.enableSubscriptNumber")}),br=(t,e)=>t>e.displayMax?"\u2717":e.enableSubscriptNumber?nf(t):t.toString();O.registerColumn("child","diagnosticError",({source:t,subscriptions:e})=>{let r=xr(t.config);return{init(){e.push(K.bindColumn(t,["error"]))},draw(){return{labelVisible:({node:o})=>!!K.getMixedError(o.fullpath),drawNode(o,{node:i,isLabeling:n}){let a=K.getMixedError(i.fullpath);if(n){o.add((a!=null?a:0).toString(),{hl:P.diagnosticError});return}!a||i.directory&&t.view.isExpanded(i)||o.add(br(a,r),{hl:P.diagnosticError})}}}}});O.registerColumn("child","diagnosticWarning",({source:t,subscriptions:e})=>{let r=xr(t.config);return{init(){e.push(K.bindColumn(t,["warning"]))},draw(){return{labelVisible:({node:o})=>!!K.getMixedWarning(o.fullpath),drawNode(o,{node:i,isLabeling:n}){let a=K.getMixedWarning(i.fullpath);if(n){o.add((a!=null?a:0).toString(),{hl:P.diagnosticWarning});return}!a||i.expandable&&t.view.isExpanded(i)||o.add(br(a,r),{hl:P.diagnosticWarning})}}}}});var ie=D.linkGroup.bind(D),bu=ie("FileDirectory","Directory"),P={title:ie("FileRoot","Constant"),hidden:ie("FileHidden",Ee.CommentColor),rootName:ie("FileRootName","Identifier"),expandIcon:ie("FileExpandIcon","Directory"),fullpath:ie("FileFullpath",Ee.CommentColor),filename:ie("FileFilename","None"),directory:bu,directoryExpanded:ie("FileDirectoryExpanded",bu.group),directoryCollapsed:ie("FileDirectoryCollapsed",bu.group),linkTarget:ie("FileLinkTarget",Ee.CommentColor),indentLine:ie("IndentLine",Ee.CommentColor),clip:ie("FileClip","Statement"),size:ie("FileSize","Constant"),readonly:ie("FileReadonly","Operator"),modified:ie("FileModified","Operator"),timeAccessed:ie("TimeAccessed","Identifier"),timeModified:ie("TimeModified","Identifier"),timeCreated:ie("TimeCreated","Identifier"),diagnosticError:ie("FileDiagnosticError",It.diagnosticError.group),diagnosticWarning:ie("FileDiagnosticWarning",It.diagnosticWarning.group),filenameDiagnosticError:ie("FileFilenameDiagnosticError","CocErrorSign"),filenameDiagnosticWarning:ie("FileFilenameDiagnosticWarning","CocWarningSign")},yu=class extends cr{constructor(){super(...arguments);this.scheme="file";this.showHidden=this.config.get("file.showHiddenFiles");this.showOnlyGitChange=!1;this.view=new lr(this,O,{type:"root",isRoot:!0,uid:this.helper.getUid(Ps.default.sep),name:"root",fullpath:(0,ob.homedir)(),expandable:!0,directory:!0,readonly:!0,executable:!1,readable:!0,writable:!0,hidden:!1,symbolicLink:!0,lstat:void 0});this.rootStrategies=[]}get root(){return this.view.rootNode.fullpath}set root(r){this.view.rootNode.uid=this.helper.getUid(r),this.view.rootNode.fullpath=r,this.view.rootNode.children=void 0}getHiddenRules(){return this.config.get("file.hiddenRules")}isHidden(r){let o=this.getHiddenRules(),{basename:i,extensions:n}=va(r),a=n[n.length-1];return o.filenames.includes(i)||o.extensions.includes(a)||o.patternMatches.some(s=>new RegExp(s).test(r))}getNodesByPaths(r){let o=new Set(r);return this.view.flattenedNodes.filter(i=>o.has(i.fullpath))}isGitChange(r,o){return!!B.getMixedStatus(`${r.fullpath}/${o}`,!1)}getColumnConfig(r,o){return this.config.get(`file.column.${r}`,o)}async init(){Fl(this.config)&&this.disposables.push(Vr(async r=>{r!==this.explorer.bufnr&&(!this.explorer.visible()||this.explorer.isFloating||await this.view.sync(async o=>{var s;let i=(s=this.bufManager.getBufferNode(r))==null?void 0:s.fullpath;if(!i)return;let[n,a]=await this.revealNodeByPathNotifier(o,i);n&&await v.runAll(a)}))},200)),Ox(this.action)}async open(){await this.view.parseTemplate("root",await this.explorer.args.value(an.fileRootTemplate),await this.explorer.args.value(an.fileRootLabelingTemplate)),await this.view.parseTemplate("child",await this.explorer.args.value(an.fileChildTemplate),await this.explorer.args.value(an.fileChildLabelingTemplate)),this.root=this.explorer.root,this.rootStrategies=this.explorer.argValues.rootStrategies}async cd(r){let{nvim:o}=this,i=await o.call("fnameescape",r),n,a=this.config.get("file.tabCD");a!==void 0?(E.error("explorer.file.tabCD has been deprecated, please use explorer.file.cdCommand instead of it"),a?n="tcd":n="cd"):n=this.config.get("file.cdCommand"),n==="tcd"?(eo.workspace.isNvim||await o.call("exists",[":tcd"]))&&(await o.command(`tcd ${i}`),eo.window.showMessage(`Tab's CWD is: ${r}`)):n==="cd"&&(await o.command(`cd ${i}`),eo.window.showMessage(`CWD is: ${r}`))}async openedNotifier(r,o){let i=this.explorer.args,n=await this.explorer.revealPath();if(!n)return o?this.locator.gotoRootNotifier({col:1}):v.noop();let a=i.has(Pe.reveal);if(Fl(this.config)||ha(this.config,this.explorer.argValues.revealWhenOpen)||a){let[s,l]=await this.revealNodeByPathNotifier(r,n);if(s!==void 0)return v.combine(l);if(o)return v.combine([...l,await this.locator.gotoRootNotifier({col:1})])}else if(o)return this.locator.gotoRootNotifier({col:1});return v.noop()}getPutTargetNode(r){return r.isRoot?this.view.rootNode:r.expandable&&this.view.isExpanded(r)?r:r.parent?r.parent:this.view.rootNode}async searchByCocList(r,{recursive:o,noIgnore:i,strict:n}){var l;let a=n?["--strict"]:[],s=await Gr(this.explorer,ux,{showHidden:this.showHidden,showIgnores:i,rootPath:r,recursive:o,revealCallback:async c=>{await s.waitExplorerShow(),await this.view.sync(async u=>{let[,f]=await this.revealNodeByPathNotifier(u,eo.Uri.parse(c.uri).fsPath);await v.runAll(f)})}},a);(l=s.waitExplorerShow())==null||l.catch(E.error)}filterForReveal(r,o){var a,s;let i=this.config.get("file.reveal.filter"),n=r.slice(o.length);for(let l of(a=i.literals)!=null?a:[])if(n.includes(l))return!0;for(let l of(s=i.patterns)!=null?s:[])if(new RegExp(l).test(n))return!0;return!1}async revealNodeByPathNotifier(r,o,{startNode:i=this.view.rootNode,goto:n=!0,render:a=!0,compact:s}={}){if(o=le(o),this.filterForReveal(o,i.fullpath))return[void 0,[]];let l=[],c=async(f,{startNode:d,goto:p,render:m})=>{if(f===d.fullpath)return d;if(d.directory&&f.startsWith(d.fullpath+Ps.default.sep)){let h,g=m&&!this.view.isExpanded(d);d.children||(d.children=await this.loadInitedChildren(d));for(let x of d.children)if(h=await c(f,{startNode:x,goto:!1,render:g?!1:m}),h){await this.view.expand(d,{compact:s,uncompact:!1,render:!1});break}if(h){if(g){let x=await r.renderNotifier({node:d});x&&l.push(x)}p&&(l.push(await this.locator.gotoNodeNotifier(h)),l.push(v.create(()=>this.nvim.command("redraw!",!0))))}return h}};return[await c(o,{startNode:i,goto:n,render:a}),l]}sortFiles(r){return r.sort((o,i)=>o.directory&&!i.directory?-1:i.directory&&!o.directory?1:o.name.localeCompare(i.name))}async loadChildren(r){let o;Be&&r.fullpath===""?o=await ya():o=await Fo(r.fullpath);let i=await Promise.all(o.map(async n=>{try{if(this.showOnlyGitChange&&!this.isGitChange(r,n))return;let a=this.isHidden(n);if(!this.showHidden&&a)return;let s=le(Ps.default.join(r.fullpath,n)),l=await Dr(s).catch(()=>{}),c=await Lr(s).catch(()=>{}),u=await Bi(s,Os.default.constants.X_OK),f=await Bi(s,Os.default.constants.W_OK),d=await Bi(s,Os.default.constants.R_OK),p=Be&&/^[A-Za-z]:[\\/]$/.test(s)?!0:l?l.isDirectory():!1;return{type:"child",uid:this.helper.getUid(s),expandable:p,name:n,fullpath:s,directory:p,readonly:!f&&d,executable:u,readable:d,writable:f,hidden:a,symbolicLink:c?c.isSymbolicLink():!1,lstat:c||void 0}}catch(a){E.error(a)}}));return this.sortFiles(i.filter(n=>!!n))}};Ct.registerSource("file",yu);var ft=class{constructor(e){let r="filename.colored.enable",o=e.get(r,!1)===!0;this.enabledGitStatus=o||e.get(`${r}.git`,!1),this.enabledErrorStatus=o||e.get(`${r}.diagnosticError`,!1),this.enabledWarningStatus=o||e.get(`${r}.diagnosticWarning`,!1)}getGitHighlight(e){return e.x==="!"?me.ignored:rx(e.y)}getHighlight(e,r,o){for(let i of o)if(i==="diagnosticWarning"){if(this.enabledWarningStatus&&K.getMixedWarning(e))return P.diagnosticWarning}else if(i==="diagnosticError"){if(this.enabledErrorStatus&&K.getMixedError(e))return P.diagnosticError}else if(i==="git"&&this.enabledGitStatus){let n=B.getMixedStatus(e,r);if(n)return this.getGitHighlight(n)}}};q.registerColumn("child","git",({source:t,subscriptions:e})=>{let r=new ft(t.config),o=Ss(t.config),i=(n,a)=>{var s;return a?me.staged:(s=r.getHighlight(n,!1,["git"]))!=null?s:me.unstaged};return{init(){e.push(B.bindColumn(t))},async available(){return await B.cmd.available()},async draw(){return{async labelVisible({node:n}){let a=B.getMixedStatus(n.fullpath,!1);return a?a.x!==" "||a.y!==" ":!1},drawNode(n,{node:a,nodeIndex:s,isLabeling:l}){let c=(f,d)=>{let p=i(a.fullpath,d);l?n.add(`${o[f].name}(${o[f].icon})`,{hl:p}):n.add(o[f].icon,{hl:p})},u=B.getMixedStatus(a.fullpath,!1);u?(c(u.x,!0),l&&n.add(" "),c(u.y,!1),u.x==="!"?(t.locator.mark.remove("git",s),t.locator.mark.remove("gitStaged",s),t.locator.mark.remove("gitUnstaged",s)):(t.locator.mark.add("git",s),u.x!==" "?t.locator.mark.add("gitStaged",s):t.locator.mark.remove("gitStaged",s),u.y!==" "?t.locator.mark.add("gitUnstaged",s):t.locator.mark.remove("gitUnstaged",s))):(t.locator.mark.remove("git",s),t.locator.mark.remove("gitStaged",s),t.locator.mark.remove("gitUnstaged",s))}}}}});q.registerColumn("child","selection",({source:t})=>({draw(){return{drawNode(e,{node:r}){t.isSelectedNode(r)&&e.add(t.icons.selected)}}}}));q.registerColumn("child","name",({source:t})=>{let e=new ft(t.config),r=(o,i)=>{var n;return(n=e.getHighlight(o,!1,["diagnosticError","diagnosticWarning","git"]))!=null?n:i?be.nameVisible:void 0};return{draw(){return{drawNode(o,{node:i}){o.add(i.name,{hl:r(i.fullpath,i.visible)})}}}}});q.registerColumn("child","bufname",()=>({draw(){return{drawNode(t,{node:e}){t.add(e.bufname,{hl:be.bufname})}}}}));q.registerColumn("child","modified",({source:t})=>({draw(){return{labelVisible({node:e}){return e.modified||!e.modifiable},drawNode(e,{node:r,nodeIndex:o}){let i=r.modified?"+":r.modifiable?"":"-";i&&e.add(i,{hl:be.modified}),r.modified?t.locator.mark.add("modified",o):t.locator.mark.remove("modified",o)}}}}));q.registerColumn("child","bufnr",()=>{let t=0;return{draw(e,{drawAll:r,abort:o}){let i=Po(e.map(n=>n.bufnrStr.length));return i?(t!==i&&(t=i,r()),{drawNode(n,{node:a}){n.add(a.bufnrStr.padStart(t),{hl:be.bufnr})}}):o()}}});q.registerColumn("child","diagnosticError",({source:t,subscriptions:e})=>{let r=xr(t.config);return{init(){e.push(K.bindColumn(t,["error"]))},draw(){return{labelVisible:({node:o})=>!!K.getMixedError(o.fullpath),drawNode(o,{node:i,isLabeling:n}){let a=K.getMixedError(i.fullpath);if(n){o.add((a!=null?a:0).toString(),{hl:It.diagnosticError});return}!a||o.add(br(a,r),{hl:It.diagnosticError})}}}}});q.registerColumn("child","diagnosticWarning",({source:t,subscriptions:e})=>{let r=xr(t.config);return{init(){e.push(K.bindColumn(t,["warning"]))},draw(){return{labelVisible:({node:o})=>!!K.getMixedWarning(o.fullpath),drawNode(o,{node:i,isLabeling:n}){let a=K.getMixedWarning(i.fullpath);if(n){o.add((a!=null?a:0).toString(),{hl:It.diagnosticWarning});return}!a||o.add(br(a,r),{hl:It.diagnosticWarning})}}}}});q.registerColumn("child","readonly",({source:t})=>({draw(){return{labelOnly:!0,labelVisible:({node:e})=>e.readonly,drawNode(e,{node:r}){r.readonly&&e.add(r.readonly?t.icons.readonly:"",{hl:be.readonly})}}}}));q.registerColumn("child","fullpath",()=>({draw(){return{drawNode(t,{node:e}){t.add(Qt(e.fullpath),{hl:be.fullpath})}}}}));var Pt=D.linkGroup.bind(D),be={title:Pt("BufferRoot","Constant"),hidden:Pt("BufferHidden",Ee.CommentColor),expandIcon:Pt("BufferExpandIcon","Directory"),nameVisible:Pt("BufferNameVisible","String"),bufname:Pt("BufferBufname",Ee.CommentColor),modified:Pt("BufferModified","Operator"),bufnr:Pt("BufferBufnr","Special"),readonly:Pt("BufferReadonly","Operator"),fullpath:Pt("BufferFullpath",Ee.CommentColor)},vu=class extends cr{constructor(){super(...arguments);this.showHidden=this.config.get("file.showHiddenBuffers");this.view=new lr(this,q,{type:"root",isRoot:!0,expandable:!0,uid:this.helper.getUid("0"),bufnr:0,bufnrStr:"0",bufname:"",fullpath:"",name:"",unlisted:!0,current:!1,previous:!1,visible:!1,hidden:!1,modifiable:!1,readonly:!0,terminal:!1,modified:!1,readErrors:!1})}async init(){this.disposables.push(this.bufManager.onReloadDebounce(async()=>{!this.explorer.visible()||await this.load(this.view.rootNode)}),this.bufManager.onModifiedDebounce(async()=>{!this.explorer.visible()||await this.load(this.view.rootNode)})),this.tabId=await oe.currentTabId(),Kw(this.action)}async open(){await this.view.parseTemplate("root",await this.explorer.args.value(Es.bufferRootTemplate)),await this.view.parseTemplate("child",await this.explorer.args.value(Es.bufferChildTemplate),await this.explorer.args.value(Es.bufferChildLabelingTemplate))}async loadChildren(r,{force:o=!1}={}){o&&await this.bufManager.reload();let i=ma(),n=this.bufManager.bufferNodes;if(this.showHidden)return[...n];if(i){let a=this.tabId?oe.get(this.tabId):await oe.currentTabContainer(),s=[];return a!=null&&a.bufnrs&&(s=[...a.bufnrs]),n.filter(l=>s.includes(l.bufnr)&&!l.unlisted)}else return n.filter(a=>!a.unlisted)}};Ct.registerSource("buffer",vu);var yr=require("coc.nvim"),Tu=_(require("path"));var As={bookmarkRootTemplate:R.registerOption("bookmark-root-template",{getDefault:()=>C.get("bookmark.root.template")}),bookmarkChildTemplate:R.registerOption("bookmark-child-template",{getDefault:()=>C.get("bookmark.child.template")}),bookmarkChildLabelingTemplate:R.registerOption("bookmark-child-labeling-template",{getDefault:()=>C.get("bookmark.child.labelingTemplate")})};var Eu=class extends ur{},ce=new Eu;ce.registerColumn("root","icon",({source:t})=>({draw(){return{drawNode(e,{node:r}){e.add(t.view.isExpanded(r)?t.icons.expanded:t.icons.collapsed,{hl:Se.expandIcon})}}}}));ce.registerColumn("root","title",()=>({draw(){return{drawNode(t){t.add("[BOOKMARK]",{hl:Se.title})}}}}));ce.registerColumn("root","hidden",({source:t})=>({draw(){return{drawNode(e){e.add(t.showHidden?t.icons.hidden:"",{hl:Se.hidden})}}}}));ce.registerColumn("child","selection",({source:t})=>({draw(){return{drawNode(e,{node:r}){t.isSelectedNode(r)&&e.add(t.icons.selected)}}}}));ce.registerColumn("child","position",()=>({draw(){return{drawNode(t,{node:e}){t.add(`line: ${e.lnum}`,{hl:Se.position})}}}}));ce.registerColumn("child","filename",()=>({draw(){return{drawNode(t,{node:e}){t.add(e.name,{hl:Se.filename})}}}}));ce.registerColumn("child","fullpath",()=>({draw(){return{drawNode(t,{node:e}){t.add(Qt(e.fullpath),{hl:Se.fullpath})}}}}));ce.registerColumn("child","line",()=>({draw(){return{drawNode(t,{node:e}){t.add(e.line,{hl:Se.line})}}}}));ce.registerColumn("child","annotation",()=>({draw(){return{drawNode(t,{node:e}){e.annotation&&t.add(e.annotation,{hl:Se.annotation})}}}}));var Su=_(require("path"));var dn=class{constructor(e){this.filepath=e}async load(){let e=Su.default.dirname(this.filepath),r=await Dr(e).catch(()=>null);if(!r||!r.isDirectory())return{};try{let o=await Ch(this.filepath,{encoding:"utf8"});return JSON.parse(o.trim())}catch{return{}}}async fetch(e){let r=await this.load();if(!e)return r;let o=e.split(".");for(let i of o){if(typeof r[i]>"u")return;r=r[i]}return r}async exists(e){let r=await this.load(),o=e.split(".");for(let i of o){if(typeof r[i]>"u")return!1;r=r[i]}return!0}async push(e,r){let o=await this.load()||{},i=o,n=e.split("."),a=n.length;if(i===null){let s=Su.default.dirname(this.filepath);await Wo(s),i=o}for(let s=0;s<a;s++){let l=n[s];if(s===a-1){i[l]=r,await wa(this.filepath,JSON.stringify(o,null,2));break}typeof i[l]>"u"&&(i[l]={}),i=i[l]}}async delete(e){let r=await this.load(),o=r,i=e.split("."),n=i.length;for(let a=0;a<n&&!(typeof r[i[a]]>"u");a++){if(a===n-1){delete r[i[a]],await wa(this.filepath,JSON.stringify(o,null,2));break}r=r[i[a]]}}async clear(){let e=await Dr(this.filepath).catch(()=>null);!e||!e.isFile()||await wa(this.filepath,"{}")}};function ib(t){return decodeURIComponent(t)}var to=D.linkGroup.bind(D),Se={title:to("BookmarkRoot","Constant"),hidden:to("BookmarkHidden","Commment"),expandIcon:to("BookmarkExpandIcon","Directory"),filename:to("BookmarkFilename","String"),fullpath:to("BookmarkFullpath","Special"),position:to("BookmarkPosition","Comment"),line:D.createGroup("BookmarkLine","ctermbg=27 ctermfg=0 guibg=#1593e5 guifg=#ffffff"),annotation:to("BookmarkAnnotation","Comment")},Nu=class extends cr{constructor(){super(...arguments);this.view=new lr(this,ce,{type:"root",isRoot:!0,expandable:!0,uid:this.helper.getUid("0"),name:"",fullpath:"",lnum:-1,line:"",annotation:void 0})}static get enabled(){return yr.extensions.getExtensionState("coc-bookmark")==="activated"}async init(){this.disposables.push(lt.on("CocBookmarkChange",Ga(500,async()=>{await this.load(this.view.rootNode)})))}async open(){await this.view.parseTemplate("root",await this.explorer.args.value(As.bookmarkRootTemplate)),await this.view.parseTemplate("child",await this.explorer.args.value(As.bookmarkChildTemplate),await this.explorer.args.value(As.bookmarkChildLabelingTemplate)),this.view.rootNode.fullpath=this.explorer.root}async loadChildren(r){var l;let o=yr.workspace.env.extensionRoot,i=Tu.default.join(o,"coc-bookmark-data/bookmark.json"),a=await new dn(i).load(),s=[];for(let[c,u]of Object.entries(a)){let f=le(ib(c));if(!(!this.showHidden&&!f.startsWith(r.fullpath)||!await xa(f)))for(let d of Object.keys(u).map(p=>Number(p)).sort((p,m)=>p-m)){let p=u[d];s.push({type:"child",uid:this.helper.getUid(`${f}:${d}`),fullpath:f,name:Tu.default.basename(f),lnum:d,location:yr.Location.create(f,yr.Range.create(d,-1,d,-1)),line:p.line,annotation:(l=p.annotation)==null?void 0:l.toString()})}}return s}};Ct.registerSource("bookmark",Nu);var _s=class{constructor(e){this.explorer=e;this.isHelpUI=!1;this.currentLineIndex=0;this[si]=new gs(this)}async sync(e){return await e(this[si])}get flattenedNodes(){return this.explorer.sources.reduce((e,r)=>e.concat(r.view.flattenedNodes),[])}async refreshLineIndex(){let e=await this.explorer.win;if(e){let r=await e.cursor;this.currentLineIndex=r[0]-1}}async currentSource(){return this.explorer.sources[await this.currentSourceIndex()]}async currentSourceIndex(){let e=this.currentLineIndex;return this.explorer.sources.findIndex(r=>e>=r.view.startLineIndex&&e<r.view.endLineIndex)}async currentNode(){let e=await this.currentSource();if(e){let r=this.currentLineIndex-e.view.startLineIndex;return e.view.flattenedNodes[r]}}async emitRequestRenderNodes(){await this.sync(async e=>{let r=await Promise.all(e.rendererSources().map(o=>o.emitRequestRenderNodesNotifier()));await v.runAll(r)})}};si;var tt=class{constructor(e,r,o,i,n){this.explorerID=e;this.explorerManager=r;this.bufnr=o;this.borderBufnr=i;this.config=n;this.nvim=Ue.workspace.nvim;this.contentWidth=0;this.action=new es(this);this.highlight=new ls(this);this.view=new _s(this);this.locator=new fs(this);this.events=new ht(E);this.firstOpened=!1;this.disposables=[];this.isHide=!1;this.context=r.context,this.buffer=this.nvim.createBuffer(this.bufnr),this.inited=new Qo("inited",this.buffer),this.sourceWinid=new Qo("sourceWinid",this.buffer),this.sourceBufnr=new Qo("sourceBufnr",this.buffer),this.floatingPreview=new as(this),i&&this.disposables.push(We("BufWinLeave",async a=>{a===o&&await zl([i]).run()})),Cw(this.action)}static genExplorerPosition(e,r){var s,l,c;let o=0,i=0,n=0,a=0;if(e.position.name!=="floating")o=(s=r==null?void 0:r.width)!=null?s:e.width;else{o=(l=r==null?void 0:r.width)!=null?l:e.floatingWidth,i=(c=r==null?void 0:r.height)!=null?c:e.floatingHeight;let[u,f]=[Ue.workspace.env.columns,Ue.workspace.env.lines-Ue.workspace.env.cmdheight];o<=0&&(o=u+o),i<=0&&(i=f+i);let d=e.floatingPosition;d==="left-center"?(n=0,a=(f-i)/2):d==="center"?(n=(u-o)/2,a=(f-i)/2):d==="right-center"?(n=u-o,a=(f-i)/2):d==="center-top"?(n=(u-o)/2,a=0):[n,a]=d}return{width:o,height:i,top:a,left:n}}static async create(e,r,o){e.maxExplorerID+=1;let{width:i,height:n,top:a,left:s}=this.genExplorerPosition(r),[l,c]=await Ue.workspace.nvim.call("coc_explorer#open_explorer",[e.maxExplorerID,r.position,{width:i,height:n,left:s,top:a,focus:r.focus,border_enable:o.get("floating.border.enable"),border_chars:o.get("floating.border.chars"),title:o.get("floating.border.title")}]),u=new tt(e.maxExplorerID,e,l,c,o);return await u.inited.set(!0),u}dispose(){this.floatingPreview.dispose(),this.disposables.forEach(e=>e.dispose())}get root(){if(!this.root_)throw Error("Explorer root not initialized yet");return this.root_}get args(){if(!this.args_)throw Error("Explorer args not initialized yet");return this.args_}get argValues(){if(!this.argValues_)throw Error("Explorer argValues not initialized yet");return this.argValues_}get isFloating(){if(this.isFloating_===void 0)throw Error("Explorer isFloating not initialized yet");return this.isFloating_}get sources(){if(!this.sources_)throw Error("Explorer sources not initialized yet");return this.sources_}get height(){return se(this.sources.map(e=>e.height))}get win(){return this.winid.then(Kl)}get winnr(){return ji(this.bufnr)}get winid(){return this.winnr.then(Yl)}get borderWin(){return this.borderWinid.then(Kl)}get borderWinnr(){return ji(this.borderBufnr)}get borderWinid(){return this.borderWinnr.then(Yl)}async sourceWinnr(){let e=await this.sourceWinid.get();if(!e)return;let r=await this.nvim.call("win_id2win",[e]);if(!(r<=0||(await this.explorerManager.winnrs()).includes(r)))return r}async sourceBufnrBySourceWinid(){let e=await this.sourceWinid.get();if(!e)return;let r=await this.nvim.call("winbufnr",[e]);if(!(r<=0))return r}async sourceBuffer(){let e=await this.sourceBufnr.get();if(!!e)return this.nvim.createBuffer(e)}visible(){let e=this.explorerManager.bufManager.getBufferNode(this.bufnr);return e==null?void 0:e.visible}async refreshWidth(){let e=await this.win;if(!e)return;let r=async(o,i)=>{if(i<=0){let n;if(o==="win-width"?(n=await e.width,(await e.getOption("relativenumber")||await e.getOption("number"))&&(n-=await e.getOption("numberwidth"))):o==="vim-width"&&(n=await Ue.workspace.nvim.eval("&columns")),n)return this.contentWidth=n+i,!0}else return this.contentWidth=i,!0;return!1};this.isFloating&&await r("win-width",this.argValues.floatingContentWidth)||await r(this.argValues.contentWidthType,this.argValues.contentWidth)}resizeNotifier(e){return v.create(()=>{var s,l,c,u;let r=tt.genExplorerPosition(this.argValues,{width:(l=e==null?void 0:e[0])!=null?l:(s=this.storedSize)==null?void 0:s.width,height:(u=e==null?void 0:e[1])!=null?u:(c=this.storedSize)==null?void 0:c.height}),{top:o,left:i,width:n,height:a}=r;this.storedSize={width:n,height:a},this.nvim.call("coc_explorer#resize",[this.bufnr,this.argValues.position,{width:n,height:a,left:i,top:o,border_bufnr:this.borderBufnr,border_enable:this.config.get("floating.border.enable"),border_chars:this.config.get("floating.border.chars"),title:this.config.get("floating.border.title")}],!0)})}async resize(e){await this.resizeNotifier(e).run()}async adjustSize(e){var s,l;let[r=0,o=0]=e!=null?e:[0,0],i=tt.genExplorerPosition(this.argValues,{width:(s=this.storedSize)==null?void 0:s.width,height:(l=this.storedSize)==null?void 0:l.height}),{width:n,height:a}=i;await this.resize([n+r,a+o])}async focus(){let e=await this.win;return e?(await this.nvim.command(`${await e.number}wincmd w`),await this.resize(),!0):!1}async resume(e){let{width:r,height:o,top:i,left:n}=tt.genExplorerPosition(e,this.storedSize);await this.nvim.call("coc_explorer#resume",[this.bufnr,e.position,{width:r,height:o,left:n,top:i,focus:e.focus,border_bufnr:this.borderBufnr,border_enable:this.config.get("floating.border.enable"),border_chars:this.config.get("floating.border.chars"),title:this.config.get("floating.border.title")}])}async open(e,r,o){let i;this.firstOpened?i=!1:(i=!0,this.firstOpened=!0),i&&await this.events.fire("first-open-pre"),await this.events.fire("open-pre"),await Ya("CocExplorerOpenPre"),this.rooter=r.open(this),this.view.isHelpUI&&await this.quitHelp(),await this.highlight.bootSyntax();let n=await this.initArgs(e,this.rooter);for(let a of this.sources)await a.bootOpen(o);await this.view.sync(async a=>{let s=[];n&&s.push(this.clearLinesNotifier()),s.push(await this.loadAllNotifier(a),...await Promise.all(a.rendererSources().map(l=>l.source.openedNotifier(l,o)))),await v.runAll(s),await Ya("CocExplorerOpenPost"),await this.events.fire("open-post"),i&&await this.events.fire("first-open-post")})}async tryQuitOnOpenNotifier(){return this.argValues.quitOnOpen||this.isFloating?this.quitNotifier():v.noop()}async tryQuitOnOpen(){return v.run(this.tryQuitOnOpenNotifier())}async hide(){this.isHide=!0,await this.quit(!0)}async show(){this.isHide&&(this.isHide=!1,await this.resume(this.argValues))}async quitNotifier(e=!1){e||await Ya("CocExplorerQuitPre");let r=await this.sourceWinnr(),o=await Ke();return v.create(()=>{r&&this.bufnr===o&&this.nvim.command(`${r}wincmd w`,!0),zl([this.bufnr]).notify(),e||hc("CocExplorerQuitPost").notify()})}async quit(e=!1){return v.run(await this.quitNotifier(e))}async initRoot(e,r){let o=e.rootUri;if(o){this.root_=le(o);return}let i;ha(this.config,this.argValues.revealWhenOpen)&&(i=await this.revealPath());let n=await r.resolveRoot(i,this.argValues.rootStrategies);if(n){this.root_=le(n);return}this.root_=le(Ue.workspace.cwd)}async initArgs(e,r){var s;this.args_=e,this.argValues_=await e.values(Pe),await this.initRoot(this.argValues_,r);let o=await e.value(Pe.sources);if(!o)return!1;let i=await(0,nb.default)(o,l=>Ct.enabled(l.name)),n=JSON.stringify(i);if(this.prevArgSourcesEnabledJson&&this.prevArgSourcesEnabledJson===n)return!1;this.prevArgSourcesEnabledJson=n,(0,Ue.disposeAll)((s=this.sources_)!=null?s:[]),this.sources_=i.map(l=>Ct.createSource(l.name,this,l.expand));let a=await this.args_.value(Pe.position);return this.isFloating_=a.name==="floating",!0}async revealPath(){var r,o;let e=await this.args.value(Pe.reveal);if(e)return e;{let i=await this.sourceBuffer();if(i)return(o=(r=this.explorerManager.bufManager.getBufferNode(i.id))==null?void 0:r.fullpath)!=null?o:void 0}}async getSelectedOrCursorLineIndexes(e){await this.view.refreshLineIndex();let r=new Set;if(e==="v"){let o=await Ue.window.getSelectedRange("v");if(o){let i=o.start.line,n=o.end.character!==0?o.end.line:o.end.line-1;for(let a=i;a<=n;a++)r.add(a);return r}}return r.add(this.view.currentLineIndex),r}findSourceByLineIndex(e){let r=this.sources.findIndex(o=>e<o.view.endLineIndex);if(r===-1){let o=this.sources.length-1;return{source:this.sources[o],sourceIndex:o}}else return{source:this.sources[r],sourceIndex:r}}lineIndexesGroupBySource(e){let r=new Map;for(let o of e){let{source:i,sourceIndex:n}=this.findSourceByLineIndex(o),a=r.get(n);a||(a={source:i,lineIndexes:[o]},r.set(n,a)),a.lineIndexes.push(o)}return[...r.values()]}setLinesNotifier(e,r,o){return v.create(()=>{this.nvim.call("coc_explorer#util#buf_set_lines_skip_cursor",[this.bufnr,r,o,!1,e],!0)})}clearLinesNotifier(){return this.setLinesNotifier([],0,-1)}async loadAllNotifier(e,{render:r=!0}={}){this.locator.mark.removeAll();let o=await Promise.all(e.rendererSources().map(i=>i.source.loadNotifier(i,i.view.rootNode,{render:!1})));return r&&o.push(await e.renderAllNotifier()),v.combine(o)}async render(){return this.view.sync(e=>v.run(e.renderAllNotifier()))}async showHelp(e){return Hw(this,e)}async quitHelp(){return Lc(this)}};var Cu=require("coc.nvim"),vr=_(require("path"));var Ms=class{constructor(e){this.workspaceRoot=e}open(e){return new Iu(this.workspaceRoot,e)}},Iu=class{constructor(e,r){this.workspaceRoot=e;this.explorer=r;this.customRoots={};let o=this,i=null,n=async()=>(i===null&&(i=await o.resolveBufFullpath()),i);this.roots={keep:()=>{},workspace:()=>e,cwd:()=>Cu.workspace.cwd,sourceBuffer:()=>n(),reveal:a=>a?vr.default.dirname(a):void 0}}async resolveRootByPatterns(e,r,o){let n=le(e).split(vr.default.sep);if(o){for(;n.length>0;){let a=n.join(vr.default.sep);if(await Gl(a,r))return a;n.pop()}return}else{let a=[n.shift()];for(let s of n){a.push(s);let l=a.join(vr.default.sep);if(await Gl(l,r))return l}return}}async resolveRootBy(e,r){var n;let o=r,i="custom:";if(is.includes(o))return this.roots[o](e);if(o.startsWith(i)){let a=o.slice(i.length),l=this.explorer.config.get("root.customRules")[a],c=Cu.workspace.cwd,u=await this.roots.sourceBuffer();if(u&&(c=u.endsWith(vr.default.sep)?u:vr.default.dirname(u)),l)return await this.resolveRootByPatterns(c,l.patterns,(n=l.bottomUp)!=null?n:!1)}E.error(`${r} is not supported`)}async resolveRoot(e,r){if(!r.includes("keep"))for(let o of r){let i=await this.resolveRootBy(e,o);if(!!i&&(!e||Ea(i,e)))return i}}async resolveBufFullpath(){var i;let e=await this.explorer.sourceBuffer();if(!e||await e.getVar("&buftype")==="nofile")return;let o=(i=this.explorer.explorerManager.bufManager.getBufferNode(e.id))==null?void 0:i.fullpath;if(!!o)return le(vr.default.dirname(o))}};var ks=class{constructor(e){this.explorerManager=e}};var Rs=class extends ks{context(){return this.explorerManager.context}async setFiles(e,r){let o={type:e,fullpaths:r};o.fullpaths.length===0?await this.clear():await this.context().globalState.update("clipboard",o)}async getFiles(){let e=this.context().globalState.get("clipboard");return e||{type:"none",fullpaths:[]}}async clear(){await this.context().globalState.update("clipboard",void 0)}};function ab(t){return new Rs(t)}var Ls=class{constructor(e,r){this.context=e;this.bufManager=r;this.filetype="coc-explorer";this.previousBufnr=new Ji("previousBufnr");this.previousWindowID=new Ji("previousWindowID");this.maxExplorerID=0;this.nvim=ro.workspace.nvim;this.events=new ht(E);this.waitInited=zi(Ug(this.events,"inited"));this.clipboardStorage=ab(this);Ke().then(this.updatePrevCtxVars.bind(this)).catch(E.error),this.context.subscriptions.push(Vr(async o=>{await this.updatePrevCtxVars(o)},0)),this.context.subscriptions.push(ro.Disposable.create(()=>(0,ro.disposeAll)(this.explorers())))}async updatePrevCtxVars(e){if(!this.bufnrs().includes(e)){let r=await this.nvim.call("bufname");if(r.startsWith("list://")||r.startsWith("[coc-explorer]"))return;if(await this.nvim.getVar("&filetype")!==this.filetype){await this.previousBufnr.set(e);let i=await this.nvim.call("win_getid");await this.previousWindowID.set(i===-1?void 0:i)}}}async prevWinnrByPrevBufnr(){let e=await this.previousBufnr.get();if(!e)return;let r=await this.nvim.call("bufwinnr",[e]);if(!(r<=0||(await this.winnrs()).includes(r)))return r}async prevWinnrByPrevWindowID(){let e=await this.previousWindowID.get();if(!e)return;let r=await this.nvim.call("win_id2win",[e]);if(!(r<=0||(await this.winnrs()).includes(r)))return r}bufnrs(){return this.explorers().map(e=>e.bufnr)}async winids(){return fe(await Promise.all(this.explorers().map(e=>e.winid)))}async winnrs(){let e=await oe.currentTabContainer(),r=e==null?void 0:e.all();return r?(await Promise.all(r.map(i=>i.winnr))).filter(i=>i!==void 0):[]}explorers(){let e=[];for(let r of oe.values())e.push(...r.all());return e}async currentExplorer(){return this.explorerByBufnr(await Ke())}async explorerByWinid(e){for(let r of this.explorers())if(await r.winid===e)return r}explorerByBufnr(e){return this.explorers().find(r=>r.bufnr===e)}async inExplorer(){return await this.currentExplorer()!==void 0}async checkResume(e,r){var o;return r.position.name!=="floating"?!0:await((o=await e.sourceBuffer())==null?void 0:o.loaded)?await e.buffer.valid?await this.nvim.call("bufexists",[e.borderBufnr])?!0:(await this.nvim.command(`bwipeout! ${e.bufnr}`),!1):!1:(await this.nvim.command(`bwipeout! ${e.bufnr}`),!1)}async open(e){await this.waitInited;let r=!0,o=pa(),i=wh(o),n=await R.parse(e,o),a=await n.values(Pe),s=a.position;if(s.name==="floating"&&!Fh())throw new Error("not support floating position in vim");let l=a.quit,c=s.name==="tab"?await oe.currentTabMaxId()+1:await oe.currentTabId(),u=oe.get(c),f=u.getExplorer(s);if(f&&l){await f.quit();return}let d=await this.nvim.call("win_getid"),p=await Ke(),m=new Ms(ro.workspace.root);if(!f||!await this.nvim.call("bufexists",[f.bufnr]))f=await tt.create(this,a,i),u.setExplorer(s,f);else if(!await f.inited.get())await this.nvim.command(`bwipeout! ${f.bufnr}`),f=await tt.create(this,a,i),u.setExplorer(s,f);else{if(!await f.win)await this.checkResume(f,a)?await f.resume(a):(f=await tt.create(this,a,i),u.setExplorer(s,f));else{if(await n.value(Pe.toggle)){await f.quit();return}if(await n.value(Pe.focus)){await f.focus();return}}r=!1}await f.sourceWinid.set(d),await f.sourceBufnr.set(p),await f.open(n,m,r)}};var sb=require("coc.nvim");var Ds=class extends sb.BasicList{constructor(r){super(r);this.name="explPresets";this.defaultAction="do";this.description="explorer presets";this.addAction("do",async o=>{this.nvim.command(`CocCommand explorer --preset ${o.data.name}`).catch(E.error)})}async loadItems(r){return[...(await Qa(pa())).keys()].map(i=>({label:i,data:{name:i}}))}doHighlight(){let{nvim:r}=this;r.pauseNotification(),r.command("syntax match CocExplorerPreset /.*/",!0),r.command("highlight default link CocExplorerPreset PreProc",!0),r.resumeNotification().catch(E.error)}};var Ws=require("coc.nvim"),Ou=_(require("path"));var lb=require("coc.nvim");function cb(t,e){if(t[0]==="leaf")return{type:t[0],winid:t[1],parent:e};{let r={type:t[0],children:[]};return r.children=t[1].map((o,i)=>cb(o,{group:r,indexInParent:i})),r}}var Bs=class{constructor(e){this.root=e}static async create(){let e=await lb.workspace.nvim.call("winlayout",[]);return new this(cb(e))}static getFirstLeafWinid(e){return e.type==="leaf"?e.winid:this.getFirstLeafWinid(e.children[0])}findWinid(e,r=this.root){if(r.type==="leaf"){if(r.winid===e)return r}else for(let o of r.children){let i=this.findWinid(e,o);if(i)return i}}findClosest(e,r){let o=new Set([e]),i=[e];for(;i.length;){let n=i.shift();if(n.type==="leaf"){if(r.includes(n.winid))return n}else for(let a of n.children)if(!o.has(a)){i.push(a),o.add(a);continue}n.parent&&!o.has(n.parent.group)&&(i.push(n.parent.group),o.add(n.parent.group))}}};function pn(t,e){return Ws.commands.registerCommand(t,E.asyncCatch(e),void 0,!0)}async function ub(t,e){if(t==="closest"){let r=await Bs.create(),o=await Ws.workspace.nvim.eval("win_getid(winnr())");if(o<=-1)return;let i=r.findWinid(o);if(!i)return;let n=await e.winids();if(!n.length)return;let a=r.findClosest(i,n);if(a)return e.explorerByWinid(a.winid);{let s=await oe.currentTabContainer(),l=s==null?void 0:s.floating;if(await(l==null?void 0:l.winnr)!==void 0)return l}}else return t===0?e.currentExplorer():e.explorerByBufnr(t)}async function fb(t,e){if(t==="current")return e.view.currentLineIndex;if(typeof t=="number")return t;if(Array.isArray(t)){let[r,o,i]=t;if(r==="relative"){let n=i?e.sources.find(a=>a.sourceType===i):await e.view.currentSource();if(n)return n.view.startLineIndex+o}}}async function YP(t,e){var n;let r=await fb(t,e);if(!r)return[void 0,void 0];let o=e.sources.find(a=>r>=a.view.startLineIndex&&r<a.view.endLineIndex);if(!o)return[void 0,void 0];let i=r-o.view.startLineIndex;return[o,(n=o.view.flattenedNodes[i])!=null?n:void 0]}function db(t,e){async function r(o,i,n=["current"],a="n",s=1){let l=await ub(o,e);if(!l)return;await l.view.refreshLineIndex();let c=fe(await Promise.all(n.map(async u=>await fb(u,l))));await l.action.doActionExp(qr(i),{mode:a,count:s,lineIndexes:c}).catch(E.error)}t.subscriptions.push(pn("explorer.doAction",r),pn("explorer.doCodeAction",async(o,i,n)=>{let a=await r(0,{name:i,args:await n()});return await zo.add(o),a}),pn("explorer.getNodeInfo",async(o,i="current")=>{let n=await ub(o,e);if(!n)return;await n.view.refreshLineIndex();let[,a]=await YP(i,n);if(!!a)return G(N({},a),{compactedNodes:void 0,parent:void 0,children:void 0,prevSiblingNode:void 0,nextSiblingNode:void 0})}),pn("explorer.getIcon",async(o,i=!1,n)=>{let a=Ou.default.basename(o),s=i?"directories":"files",c=await ln("builtin",[{fullname:a,isDirectory:i,expanded:n,hidden:!1}]);return c==null?void 0:c[s].get(a)}),pn("explorer.getIcons",async o=>{let i={},n=o.map(l=>{let c=Ou.default.basename(l.filepath);return i[c]=l.filepath,{fullname:c,isDirectory:l.isDirectory,expanded:l.isExpanded,hidden:!1}}),a=await ln("builtin",n);if(!a)return;let s={files:{},directories:{}};for(let[l,c]of a.files)s.files[i[l]]=c;for(let[l,c]of a.directories)s.directories[i[l]]=c;return s}))}var KP=t=>{let{subscriptions:e}=t,{nvim:r}=Er.workspace,o=C.get("debug");E.level=o?"debug":"info",D.createGroup("SelectUI","ctermbg=27 ctermfg=0 guibg=#1593e5 guifg=#ffffff");let i=D.linkGroup("NormalFloat","NormalFloat");D.linkGroup("NormalFloatBorder",i.group),Er.listManager.registerList(new Ds(r));let n=new Xa(t),a=new Ls(t,n);db(t,a),ct.preload().catch(E.error),e.push(Er.commands.registerCommand("explorer",E.asyncCatch((...s)=>{a.open(s).catch(E.error)})),Er.languages.registerCodeActionProvider(["coc-explorer"],new za(a),"coc-explorer")),(async()=>{await ef(t),await Xi.register(t),await jh(t.extensionPath),await r.command("runtime plugin/coc_explorer.vim"),tx(e),Uw(e),await Ww(t,a),await a.events.fire("inited"),await oe.initedEmitter.fire(),n.reload().catch(E.error),await oe.register()})().catch(E.error)};0&&(module.exports={activate});
/**
 * @license
 * Lodash (Custom Build) <https://lodash.com/>
 * Build: `lodash modularize exports="es" -o ./`
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */
